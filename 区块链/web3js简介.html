<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>web3js | hailiting Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog_dev/logo.png">
    <meta name="description" content="hailiting Blog">
    
    <link rel="preload" href="/blog_dev/assets/css/0.styles.e9faf17d.css" as="style"><link rel="preload" href="/blog_dev/assets/js/app.709da227.js" as="script"><link rel="preload" href="/blog_dev/assets/js/2.556b46b5.js" as="script"><link rel="preload" href="/blog_dev/assets/js/231.109f1608.js" as="script"><link rel="prefetch" href="/blog_dev/assets/js/10.d061a1d9.js"><link rel="prefetch" href="/blog_dev/assets/js/100.0c7b74b5.js"><link rel="prefetch" href="/blog_dev/assets/js/101.63725a21.js"><link rel="prefetch" href="/blog_dev/assets/js/102.a0aa8352.js"><link rel="prefetch" href="/blog_dev/assets/js/103.3f4859f8.js"><link rel="prefetch" href="/blog_dev/assets/js/104.c375d9a0.js"><link rel="prefetch" href="/blog_dev/assets/js/105.3ab4f216.js"><link rel="prefetch" href="/blog_dev/assets/js/106.39c53827.js"><link rel="prefetch" href="/blog_dev/assets/js/107.f2a28572.js"><link rel="prefetch" href="/blog_dev/assets/js/108.dba8d9ec.js"><link rel="prefetch" href="/blog_dev/assets/js/109.be1a59c4.js"><link rel="prefetch" href="/blog_dev/assets/js/11.1fac2bc6.js"><link rel="prefetch" href="/blog_dev/assets/js/110.4e9a9fb3.js"><link rel="prefetch" href="/blog_dev/assets/js/111.e70ebf37.js"><link rel="prefetch" href="/blog_dev/assets/js/112.c2acf0c5.js"><link rel="prefetch" href="/blog_dev/assets/js/113.2c4c2f15.js"><link rel="prefetch" href="/blog_dev/assets/js/114.395922dd.js"><link rel="prefetch" href="/blog_dev/assets/js/115.4bca9bf3.js"><link rel="prefetch" href="/blog_dev/assets/js/116.49621d87.js"><link rel="prefetch" href="/blog_dev/assets/js/117.16ada7ad.js"><link rel="prefetch" href="/blog_dev/assets/js/118.2565919e.js"><link rel="prefetch" href="/blog_dev/assets/js/119.c12bdd10.js"><link rel="prefetch" href="/blog_dev/assets/js/12.4576cc3f.js"><link rel="prefetch" href="/blog_dev/assets/js/120.7939ff97.js"><link rel="prefetch" href="/blog_dev/assets/js/121.c26e4264.js"><link rel="prefetch" href="/blog_dev/assets/js/122.50fc8ef5.js"><link rel="prefetch" href="/blog_dev/assets/js/123.ffe9a78f.js"><link rel="prefetch" href="/blog_dev/assets/js/124.5aee6dd1.js"><link rel="prefetch" href="/blog_dev/assets/js/125.11cf3383.js"><link rel="prefetch" href="/blog_dev/assets/js/126.b056850f.js"><link rel="prefetch" href="/blog_dev/assets/js/127.80bc5fff.js"><link rel="prefetch" href="/blog_dev/assets/js/128.afdd2e1e.js"><link rel="prefetch" href="/blog_dev/assets/js/129.bd933eb7.js"><link rel="prefetch" href="/blog_dev/assets/js/13.bc140e8c.js"><link rel="prefetch" href="/blog_dev/assets/js/130.a87b24d0.js"><link rel="prefetch" href="/blog_dev/assets/js/131.9127e428.js"><link rel="prefetch" href="/blog_dev/assets/js/132.5baa85a6.js"><link rel="prefetch" href="/blog_dev/assets/js/133.e6519713.js"><link rel="prefetch" href="/blog_dev/assets/js/134.dbdebdb7.js"><link rel="prefetch" href="/blog_dev/assets/js/135.50b8f3cc.js"><link rel="prefetch" href="/blog_dev/assets/js/136.c9731137.js"><link rel="prefetch" href="/blog_dev/assets/js/137.f57d3761.js"><link rel="prefetch" href="/blog_dev/assets/js/138.6a94bea2.js"><link rel="prefetch" href="/blog_dev/assets/js/139.cdff373d.js"><link rel="prefetch" href="/blog_dev/assets/js/14.d889f0ed.js"><link rel="prefetch" href="/blog_dev/assets/js/140.dd2e3ba1.js"><link rel="prefetch" href="/blog_dev/assets/js/141.7a915726.js"><link rel="prefetch" href="/blog_dev/assets/js/142.58a0db92.js"><link rel="prefetch" href="/blog_dev/assets/js/143.182403fc.js"><link rel="prefetch" href="/blog_dev/assets/js/144.dcd6bf77.js"><link rel="prefetch" href="/blog_dev/assets/js/145.d06933fa.js"><link rel="prefetch" href="/blog_dev/assets/js/146.fd698fa3.js"><link rel="prefetch" href="/blog_dev/assets/js/147.2eaef6d1.js"><link rel="prefetch" href="/blog_dev/assets/js/148.3e1c96ae.js"><link rel="prefetch" href="/blog_dev/assets/js/149.bb7c3714.js"><link rel="prefetch" href="/blog_dev/assets/js/15.4ca3d2e1.js"><link rel="prefetch" href="/blog_dev/assets/js/150.937db40c.js"><link rel="prefetch" href="/blog_dev/assets/js/151.e911967c.js"><link rel="prefetch" href="/blog_dev/assets/js/152.ba1a29a5.js"><link rel="prefetch" href="/blog_dev/assets/js/153.47a6243a.js"><link rel="prefetch" href="/blog_dev/assets/js/154.511b473a.js"><link rel="prefetch" href="/blog_dev/assets/js/155.b8cce54b.js"><link rel="prefetch" href="/blog_dev/assets/js/156.8898b2f9.js"><link rel="prefetch" href="/blog_dev/assets/js/157.5f06ed86.js"><link rel="prefetch" href="/blog_dev/assets/js/158.137235af.js"><link rel="prefetch" href="/blog_dev/assets/js/159.0e9ce62a.js"><link rel="prefetch" href="/blog_dev/assets/js/16.456961f6.js"><link rel="prefetch" href="/blog_dev/assets/js/160.38d855a7.js"><link rel="prefetch" href="/blog_dev/assets/js/161.3590c707.js"><link rel="prefetch" href="/blog_dev/assets/js/162.86630534.js"><link rel="prefetch" href="/blog_dev/assets/js/163.6e13f473.js"><link rel="prefetch" href="/blog_dev/assets/js/164.d1fb6be0.js"><link rel="prefetch" href="/blog_dev/assets/js/165.f60ddeb1.js"><link rel="prefetch" href="/blog_dev/assets/js/166.32edcf10.js"><link rel="prefetch" href="/blog_dev/assets/js/167.c186a3aa.js"><link rel="prefetch" href="/blog_dev/assets/js/168.b4d579ba.js"><link rel="prefetch" href="/blog_dev/assets/js/169.67440797.js"><link rel="prefetch" href="/blog_dev/assets/js/17.529aaf8b.js"><link rel="prefetch" href="/blog_dev/assets/js/170.9764038a.js"><link rel="prefetch" href="/blog_dev/assets/js/171.6f3a2180.js"><link rel="prefetch" href="/blog_dev/assets/js/172.519538bf.js"><link rel="prefetch" href="/blog_dev/assets/js/173.9f7d6b1c.js"><link rel="prefetch" href="/blog_dev/assets/js/174.135c3ff2.js"><link rel="prefetch" href="/blog_dev/assets/js/175.fad4b7cd.js"><link rel="prefetch" href="/blog_dev/assets/js/176.a7e8b342.js"><link rel="prefetch" href="/blog_dev/assets/js/177.bc7d98e9.js"><link rel="prefetch" href="/blog_dev/assets/js/178.013841ad.js"><link rel="prefetch" href="/blog_dev/assets/js/179.ea55a800.js"><link rel="prefetch" href="/blog_dev/assets/js/18.c501dfa3.js"><link rel="prefetch" href="/blog_dev/assets/js/180.3fc7fc18.js"><link rel="prefetch" href="/blog_dev/assets/js/181.00d79ee8.js"><link rel="prefetch" href="/blog_dev/assets/js/182.75ce3c02.js"><link rel="prefetch" href="/blog_dev/assets/js/183.a111b430.js"><link rel="prefetch" href="/blog_dev/assets/js/184.934f6bbd.js"><link rel="prefetch" href="/blog_dev/assets/js/185.fd9febdb.js"><link rel="prefetch" href="/blog_dev/assets/js/186.0a342597.js"><link rel="prefetch" href="/blog_dev/assets/js/187.9e4b1686.js"><link rel="prefetch" href="/blog_dev/assets/js/188.2989272b.js"><link rel="prefetch" href="/blog_dev/assets/js/189.f45e0987.js"><link rel="prefetch" href="/blog_dev/assets/js/19.d413d821.js"><link rel="prefetch" href="/blog_dev/assets/js/190.83d10781.js"><link rel="prefetch" href="/blog_dev/assets/js/191.2b4e0c89.js"><link rel="prefetch" href="/blog_dev/assets/js/192.48865ed5.js"><link rel="prefetch" href="/blog_dev/assets/js/193.c01826d8.js"><link rel="prefetch" href="/blog_dev/assets/js/194.74e50b36.js"><link rel="prefetch" href="/blog_dev/assets/js/195.aa29f582.js"><link rel="prefetch" href="/blog_dev/assets/js/196.aca00a42.js"><link rel="prefetch" href="/blog_dev/assets/js/197.40b2c10e.js"><link rel="prefetch" href="/blog_dev/assets/js/198.33842e64.js"><link rel="prefetch" href="/blog_dev/assets/js/199.29e6325b.js"><link rel="prefetch" href="/blog_dev/assets/js/20.c89e4367.js"><link rel="prefetch" href="/blog_dev/assets/js/200.a7bce9d6.js"><link rel="prefetch" href="/blog_dev/assets/js/201.5025c6d3.js"><link rel="prefetch" href="/blog_dev/assets/js/202.c99897b4.js"><link rel="prefetch" href="/blog_dev/assets/js/203.347f1189.js"><link rel="prefetch" href="/blog_dev/assets/js/204.8de572ee.js"><link rel="prefetch" href="/blog_dev/assets/js/205.45483b34.js"><link rel="prefetch" href="/blog_dev/assets/js/206.c31290f0.js"><link rel="prefetch" href="/blog_dev/assets/js/207.e3f41a9a.js"><link rel="prefetch" href="/blog_dev/assets/js/208.d0dfd243.js"><link rel="prefetch" href="/blog_dev/assets/js/209.995ec2cb.js"><link rel="prefetch" href="/blog_dev/assets/js/21.25b239e1.js"><link rel="prefetch" href="/blog_dev/assets/js/210.e7965c3a.js"><link rel="prefetch" href="/blog_dev/assets/js/211.6b257aba.js"><link rel="prefetch" href="/blog_dev/assets/js/212.4a1cc3ec.js"><link rel="prefetch" href="/blog_dev/assets/js/213.31f8bf45.js"><link rel="prefetch" href="/blog_dev/assets/js/214.313c7b41.js"><link rel="prefetch" href="/blog_dev/assets/js/215.ee241838.js"><link rel="prefetch" href="/blog_dev/assets/js/216.3543cf04.js"><link rel="prefetch" href="/blog_dev/assets/js/217.0d6ea85b.js"><link rel="prefetch" href="/blog_dev/assets/js/218.80640071.js"><link rel="prefetch" href="/blog_dev/assets/js/219.151cb78a.js"><link rel="prefetch" href="/blog_dev/assets/js/22.d89f4d90.js"><link rel="prefetch" href="/blog_dev/assets/js/220.0eae0afd.js"><link rel="prefetch" href="/blog_dev/assets/js/221.8f8817b7.js"><link rel="prefetch" href="/blog_dev/assets/js/222.ae4bc9b6.js"><link rel="prefetch" href="/blog_dev/assets/js/223.a7aed6fa.js"><link rel="prefetch" href="/blog_dev/assets/js/224.025821c5.js"><link rel="prefetch" href="/blog_dev/assets/js/225.97d213b8.js"><link rel="prefetch" href="/blog_dev/assets/js/226.4578e374.js"><link rel="prefetch" href="/blog_dev/assets/js/227.dfd2b951.js"><link rel="prefetch" href="/blog_dev/assets/js/228.f25dfcc5.js"><link rel="prefetch" href="/blog_dev/assets/js/229.49de06f2.js"><link rel="prefetch" href="/blog_dev/assets/js/23.37517448.js"><link rel="prefetch" href="/blog_dev/assets/js/230.74de1167.js"><link rel="prefetch" href="/blog_dev/assets/js/232.b199ca54.js"><link rel="prefetch" href="/blog_dev/assets/js/233.e5505590.js"><link rel="prefetch" href="/blog_dev/assets/js/234.540cc14b.js"><link rel="prefetch" href="/blog_dev/assets/js/235.2c3a6404.js"><link rel="prefetch" href="/blog_dev/assets/js/236.7b387bc5.js"><link rel="prefetch" href="/blog_dev/assets/js/237.739ab0f9.js"><link rel="prefetch" href="/blog_dev/assets/js/238.fac109c9.js"><link rel="prefetch" href="/blog_dev/assets/js/239.1e997e2c.js"><link rel="prefetch" href="/blog_dev/assets/js/24.8c152fef.js"><link rel="prefetch" href="/blog_dev/assets/js/240.0b145d5f.js"><link rel="prefetch" href="/blog_dev/assets/js/241.09c4ce68.js"><link rel="prefetch" href="/blog_dev/assets/js/242.1e13a030.js"><link rel="prefetch" href="/blog_dev/assets/js/243.306372f7.js"><link rel="prefetch" href="/blog_dev/assets/js/244.63184878.js"><link rel="prefetch" href="/blog_dev/assets/js/245.8bcac252.js"><link rel="prefetch" href="/blog_dev/assets/js/246.99622cb5.js"><link rel="prefetch" href="/blog_dev/assets/js/247.34bd3960.js"><link rel="prefetch" href="/blog_dev/assets/js/248.2861f31a.js"><link rel="prefetch" href="/blog_dev/assets/js/249.6f62b76b.js"><link rel="prefetch" href="/blog_dev/assets/js/25.3bd7dbd6.js"><link rel="prefetch" href="/blog_dev/assets/js/250.441d1201.js"><link rel="prefetch" href="/blog_dev/assets/js/251.d1e30efd.js"><link rel="prefetch" href="/blog_dev/assets/js/252.1b993b77.js"><link rel="prefetch" href="/blog_dev/assets/js/253.7dd3cb2d.js"><link rel="prefetch" href="/blog_dev/assets/js/254.08d6a027.js"><link rel="prefetch" href="/blog_dev/assets/js/255.a95d32c3.js"><link rel="prefetch" href="/blog_dev/assets/js/256.4c0097ae.js"><link rel="prefetch" href="/blog_dev/assets/js/257.ccef358b.js"><link rel="prefetch" href="/blog_dev/assets/js/258.fcccb1d9.js"><link rel="prefetch" href="/blog_dev/assets/js/259.8c4e2a5b.js"><link rel="prefetch" href="/blog_dev/assets/js/26.357db678.js"><link rel="prefetch" href="/blog_dev/assets/js/260.45184866.js"><link rel="prefetch" href="/blog_dev/assets/js/261.57d645d4.js"><link rel="prefetch" href="/blog_dev/assets/js/262.cec8a62e.js"><link rel="prefetch" href="/blog_dev/assets/js/263.e8923920.js"><link rel="prefetch" href="/blog_dev/assets/js/264.37b490f7.js"><link rel="prefetch" href="/blog_dev/assets/js/265.ee7b00f6.js"><link rel="prefetch" href="/blog_dev/assets/js/266.0c31de3b.js"><link rel="prefetch" href="/blog_dev/assets/js/267.62925b15.js"><link rel="prefetch" href="/blog_dev/assets/js/268.6069bb2b.js"><link rel="prefetch" href="/blog_dev/assets/js/269.3c64c573.js"><link rel="prefetch" href="/blog_dev/assets/js/27.64c767de.js"><link rel="prefetch" href="/blog_dev/assets/js/270.ff44d5ab.js"><link rel="prefetch" href="/blog_dev/assets/js/271.de3eed75.js"><link rel="prefetch" href="/blog_dev/assets/js/272.9d9b6f12.js"><link rel="prefetch" href="/blog_dev/assets/js/273.b66c0be1.js"><link rel="prefetch" href="/blog_dev/assets/js/274.4d1bfedc.js"><link rel="prefetch" href="/blog_dev/assets/js/275.b7eceff6.js"><link rel="prefetch" href="/blog_dev/assets/js/276.eccd169a.js"><link rel="prefetch" href="/blog_dev/assets/js/277.a3a88438.js"><link rel="prefetch" href="/blog_dev/assets/js/278.22309baf.js"><link rel="prefetch" href="/blog_dev/assets/js/279.4373be14.js"><link rel="prefetch" href="/blog_dev/assets/js/28.0eaddbe2.js"><link rel="prefetch" href="/blog_dev/assets/js/280.bd9fb67f.js"><link rel="prefetch" href="/blog_dev/assets/js/281.2d9a98be.js"><link rel="prefetch" href="/blog_dev/assets/js/282.b90e372b.js"><link rel="prefetch" href="/blog_dev/assets/js/283.ec34c046.js"><link rel="prefetch" href="/blog_dev/assets/js/284.512f07f4.js"><link rel="prefetch" href="/blog_dev/assets/js/285.84d0ed1e.js"><link rel="prefetch" href="/blog_dev/assets/js/286.433c7816.js"><link rel="prefetch" href="/blog_dev/assets/js/287.0d3753f9.js"><link rel="prefetch" href="/blog_dev/assets/js/288.1c8d7744.js"><link rel="prefetch" href="/blog_dev/assets/js/289.476af6b9.js"><link rel="prefetch" href="/blog_dev/assets/js/29.5dd473c0.js"><link rel="prefetch" href="/blog_dev/assets/js/290.cbc40d8f.js"><link rel="prefetch" href="/blog_dev/assets/js/291.8346da5f.js"><link rel="prefetch" href="/blog_dev/assets/js/292.7384b627.js"><link rel="prefetch" href="/blog_dev/assets/js/293.63d74868.js"><link rel="prefetch" href="/blog_dev/assets/js/294.1410f408.js"><link rel="prefetch" href="/blog_dev/assets/js/295.952ce9ba.js"><link rel="prefetch" href="/blog_dev/assets/js/296.991a0da7.js"><link rel="prefetch" href="/blog_dev/assets/js/297.ec2fb727.js"><link rel="prefetch" href="/blog_dev/assets/js/298.c43e6ee0.js"><link rel="prefetch" href="/blog_dev/assets/js/299.02e81e03.js"><link rel="prefetch" href="/blog_dev/assets/js/3.bb975429.js"><link rel="prefetch" href="/blog_dev/assets/js/30.351b19a1.js"><link rel="prefetch" href="/blog_dev/assets/js/300.e4df5ed6.js"><link rel="prefetch" href="/blog_dev/assets/js/301.224fc9b4.js"><link rel="prefetch" href="/blog_dev/assets/js/302.ed9189c5.js"><link rel="prefetch" href="/blog_dev/assets/js/303.f0b78d10.js"><link rel="prefetch" href="/blog_dev/assets/js/304.6ec9ed66.js"><link rel="prefetch" href="/blog_dev/assets/js/305.c579e253.js"><link rel="prefetch" href="/blog_dev/assets/js/306.ac462491.js"><link rel="prefetch" href="/blog_dev/assets/js/307.abcd03c4.js"><link rel="prefetch" href="/blog_dev/assets/js/308.401c1772.js"><link rel="prefetch" href="/blog_dev/assets/js/309.84e52cc8.js"><link rel="prefetch" href="/blog_dev/assets/js/31.92bd6220.js"><link rel="prefetch" href="/blog_dev/assets/js/310.838924a1.js"><link rel="prefetch" href="/blog_dev/assets/js/311.c2d70590.js"><link rel="prefetch" href="/blog_dev/assets/js/312.892f867d.js"><link rel="prefetch" href="/blog_dev/assets/js/313.3f307c3e.js"><link rel="prefetch" href="/blog_dev/assets/js/314.a3ea90d5.js"><link rel="prefetch" href="/blog_dev/assets/js/315.6b095340.js"><link rel="prefetch" href="/blog_dev/assets/js/316.4f5b4c9b.js"><link rel="prefetch" href="/blog_dev/assets/js/317.66641d59.js"><link rel="prefetch" href="/blog_dev/assets/js/318.652dafd2.js"><link rel="prefetch" href="/blog_dev/assets/js/319.8dd6b519.js"><link rel="prefetch" href="/blog_dev/assets/js/32.fde56041.js"><link rel="prefetch" href="/blog_dev/assets/js/320.1fca28a4.js"><link rel="prefetch" href="/blog_dev/assets/js/321.6a52b165.js"><link rel="prefetch" href="/blog_dev/assets/js/322.4e9919d1.js"><link rel="prefetch" href="/blog_dev/assets/js/323.8a96f35f.js"><link rel="prefetch" href="/blog_dev/assets/js/324.590862d1.js"><link rel="prefetch" href="/blog_dev/assets/js/33.43b6d3a3.js"><link rel="prefetch" href="/blog_dev/assets/js/34.7ba26882.js"><link rel="prefetch" href="/blog_dev/assets/js/35.dd4ed088.js"><link rel="prefetch" href="/blog_dev/assets/js/36.114c5ba1.js"><link rel="prefetch" href="/blog_dev/assets/js/37.1952dd28.js"><link rel="prefetch" href="/blog_dev/assets/js/38.da914b09.js"><link rel="prefetch" href="/blog_dev/assets/js/39.7e26b7b2.js"><link rel="prefetch" href="/blog_dev/assets/js/4.47949fe2.js"><link rel="prefetch" href="/blog_dev/assets/js/40.b53ac1b8.js"><link rel="prefetch" href="/blog_dev/assets/js/41.ae8b1f98.js"><link rel="prefetch" href="/blog_dev/assets/js/42.479e9251.js"><link rel="prefetch" href="/blog_dev/assets/js/43.91d2fa5d.js"><link rel="prefetch" href="/blog_dev/assets/js/44.45a27817.js"><link rel="prefetch" href="/blog_dev/assets/js/45.9ba1f8c4.js"><link rel="prefetch" href="/blog_dev/assets/js/46.2eae6d1e.js"><link rel="prefetch" href="/blog_dev/assets/js/47.95b6f8e1.js"><link rel="prefetch" href="/blog_dev/assets/js/48.f0161ea5.js"><link rel="prefetch" href="/blog_dev/assets/js/49.5d642580.js"><link rel="prefetch" href="/blog_dev/assets/js/5.0ac632f7.js"><link rel="prefetch" href="/blog_dev/assets/js/50.8bd7a35f.js"><link rel="prefetch" href="/blog_dev/assets/js/51.56ae0cc4.js"><link rel="prefetch" href="/blog_dev/assets/js/52.ca920ca8.js"><link rel="prefetch" href="/blog_dev/assets/js/53.173c70ac.js"><link rel="prefetch" href="/blog_dev/assets/js/54.523b339d.js"><link rel="prefetch" href="/blog_dev/assets/js/55.ac75c90f.js"><link rel="prefetch" href="/blog_dev/assets/js/56.2e111d42.js"><link rel="prefetch" href="/blog_dev/assets/js/57.f51b48a0.js"><link rel="prefetch" href="/blog_dev/assets/js/58.1d77fc82.js"><link rel="prefetch" href="/blog_dev/assets/js/59.996c6ec0.js"><link rel="prefetch" href="/blog_dev/assets/js/6.7d92400c.js"><link rel="prefetch" href="/blog_dev/assets/js/60.9b1925f8.js"><link rel="prefetch" href="/blog_dev/assets/js/61.2622607d.js"><link rel="prefetch" href="/blog_dev/assets/js/62.9960ec8b.js"><link rel="prefetch" href="/blog_dev/assets/js/63.cc80d5d8.js"><link rel="prefetch" href="/blog_dev/assets/js/64.cd9d858a.js"><link rel="prefetch" href="/blog_dev/assets/js/65.2e5ca607.js"><link rel="prefetch" href="/blog_dev/assets/js/66.8be3c4c0.js"><link rel="prefetch" href="/blog_dev/assets/js/67.1eefd7d5.js"><link rel="prefetch" href="/blog_dev/assets/js/68.adf762ce.js"><link rel="prefetch" href="/blog_dev/assets/js/69.27c95c35.js"><link rel="prefetch" href="/blog_dev/assets/js/7.01b296e3.js"><link rel="prefetch" href="/blog_dev/assets/js/70.5097ac5d.js"><link rel="prefetch" href="/blog_dev/assets/js/71.e261fe0c.js"><link rel="prefetch" href="/blog_dev/assets/js/72.d5582ca6.js"><link rel="prefetch" href="/blog_dev/assets/js/73.8c99b9a5.js"><link rel="prefetch" href="/blog_dev/assets/js/74.360f75b2.js"><link rel="prefetch" href="/blog_dev/assets/js/75.31152e1a.js"><link rel="prefetch" href="/blog_dev/assets/js/76.1e48dadb.js"><link rel="prefetch" href="/blog_dev/assets/js/77.0d614aa8.js"><link rel="prefetch" href="/blog_dev/assets/js/78.d6dc4f4b.js"><link rel="prefetch" href="/blog_dev/assets/js/79.50283d30.js"><link rel="prefetch" href="/blog_dev/assets/js/8.7983d5a6.js"><link rel="prefetch" href="/blog_dev/assets/js/80.a52496b7.js"><link rel="prefetch" href="/blog_dev/assets/js/81.ea8065b9.js"><link rel="prefetch" href="/blog_dev/assets/js/82.8bc4a3cc.js"><link rel="prefetch" href="/blog_dev/assets/js/83.7fe873c1.js"><link rel="prefetch" href="/blog_dev/assets/js/84.d65a2741.js"><link rel="prefetch" href="/blog_dev/assets/js/85.27a9c21c.js"><link rel="prefetch" href="/blog_dev/assets/js/86.6d7e13c8.js"><link rel="prefetch" href="/blog_dev/assets/js/87.858dd9e0.js"><link rel="prefetch" href="/blog_dev/assets/js/88.c0d83d71.js"><link rel="prefetch" href="/blog_dev/assets/js/89.c6b08127.js"><link rel="prefetch" href="/blog_dev/assets/js/9.f2a5f044.js"><link rel="prefetch" href="/blog_dev/assets/js/90.4338e0cf.js"><link rel="prefetch" href="/blog_dev/assets/js/91.399fb4ca.js"><link rel="prefetch" href="/blog_dev/assets/js/92.ff317d0d.js"><link rel="prefetch" href="/blog_dev/assets/js/93.208e1694.js"><link rel="prefetch" href="/blog_dev/assets/js/94.13d481a5.js"><link rel="prefetch" href="/blog_dev/assets/js/95.984e2214.js"><link rel="prefetch" href="/blog_dev/assets/js/96.c1a273fa.js"><link rel="prefetch" href="/blog_dev/assets/js/97.bcbd1649.js"><link rel="prefetch" href="/blog_dev/assets/js/98.3fa49da9.js"><link rel="prefetch" href="/blog_dev/assets/js/99.fc09a5b7.js">
    <link rel="stylesheet" href="/blog_dev/assets/css/0.styles.e9faf17d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog_dev/" class="home-link router-link-active"><!----> <span class="site-name">hailiting Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Angular</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Demo笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog_dev/HTTP协议和反向代理.html" class="sidebar-link">浏览器行为与HTTP协议</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NodeJS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PHP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ReactNative</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Wechat</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mongodb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mysql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>npm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>区块链</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog_dev/区块链/DeFi.html" class="sidebar-link">DeFi 现实世界金融秩序的去中心化重构</a></li><li><a href="/blog_dev/区块链/EVM简介.html" class="sidebar-link">EVM 简介</a></li><li><a href="/blog_dev/区块链/Ethereum.html" class="sidebar-link">以太坊 Ethereum</a></li><li><a href="/blog_dev/区块链/Geth源码解析.html" class="sidebar-link">Geth 源码解析</a></li><li><a href="/blog_dev/区块链/Kotlin学习.html" class="sidebar-link">Kotlin 学习</a></li><li><a href="/blog_dev/区块链/MPT.html" class="sidebar-link">MPT Merkel-Patricia Tree</a></li><li><a href="/blog_dev/区块链/MetaMask报错集.html" class="sidebar-link">MetaMask 报错集</a></li><li><a href="/blog_dev/区块链/MetaMask网络地址.html" class="sidebar-link">MetaMask 网络地址</a></li><li><a href="/blog_dev/%E5%8C%BA%E5%9D%97%E9%93%BE/" aria-current="page" class="sidebar-link">区块链</a></li><li><a href="/blog_dev/区块链/Sha256加密字符串.html" class="sidebar-link">Sha256 加密字符串</a></li><li><a href="/blog_dev/区块链/Solidity简介.html" class="sidebar-link">Solidity 简介</a></li><li><a href="/blog_dev/区块链/SubQuery_HelloWorld.html" class="sidebar-link">SubQuery HelloWorld</a></li><li><a href="/blog_dev/区块链/Substrate入门.html" class="sidebar-link">Substrate 入门</a></li><li><a href="/blog_dev/区块链/solidity深入理解.html" class="sidebar-link">Solidity 深入理解</a></li><li><a href="/blog_dev/区块链/web3js简介.html" class="active sidebar-link">web3js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#前期准备" class="sidebar-link">前期准备</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#安装-solc" class="sidebar-link">安装 solc</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#web3-模块加载" class="sidebar-link">web3 模块加载</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#异步回调-callback" class="sidebar-link">异步回调（callback）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#用-promise-回调" class="sidebar-link">用 Promise 回调</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#应用二进制接口-abi" class="sidebar-link">应用二进制接口（ABI）</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#批处理请求" class="sidebar-link">批处理请求</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#大数处理" class="sidebar-link">大数处理</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#常用-api" class="sidebar-link">常用 API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#基本信息查询" class="sidebar-link">基本信息查询</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#网络状态查询" class="sidebar-link">网络状态查询</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#provider" class="sidebar-link">Provider</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#web3-通用工具方法" class="sidebar-link">web3 通用工具方法</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#账户相关" class="sidebar-link">账户相关</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#区块相关的" class="sidebar-link">区块相关的</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#交易相关" class="sidebar-link">交易相关</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#交易执行相关" class="sidebar-link">交易执行相关</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#发送交易" class="sidebar-link">发送交易</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#消息调用" class="sidebar-link">消息调用</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#日志过滤-事件监听" class="sidebar-link">日志过滤（事件监听）</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#合约相关的" class="sidebar-link">合约相关的</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#创建合约" class="sidebar-link">创建合约</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#调用合约函数" class="sidebar-link">调用合约函数</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#监听合约事件" class="sidebar-link">监听合约事件</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/web3js简介.html#添加账户" class="sidebar-link">添加账户</a></li></ul></li><li><a href="/blog_dev/区块链/一个水龙头合约.html" class="sidebar-link">一个水龙头合约</a></li><li><a href="/blog_dev/区块链/代币合约ERC20.html" class="sidebar-link">ERC20 代币合约</a></li><li><a href="/blog_dev/区块链/代币合约ERC20学习.html" class="sidebar-link">/区块链/代币合约ERC20学习.html</a></li><li><a href="/blog_dev/区块链/代币合约简单.html" class="sidebar-link">简单代币合约</a></li><li><a href="/blog_dev/区块链/以太坊交易.html" class="sidebar-link">以太坊交易</a></li><li><a href="/blog_dev/区块链/以太坊客户端.html" class="sidebar-link">以太坊客户端</a></li><li><a href="/blog_dev/区块链/以太坊白皮书.html" class="sidebar-link">以太坊白皮书</a></li><li><a href="/blog_dev/区块链/以太坊账户.html" class="sidebar-link">以太坊账户 EthereumAccounts</a></li><li><a href="/blog_dev/区块链/以太坊难度调整.html" class="sidebar-link">以太坊难度调整</a></li><li><a href="/blog_dev/区块链/区块链理论基础.html" class="sidebar-link">区块链理论基础</a></li><li><a href="/blog_dev/区块链/基于Polkadot的跨链.html" class="sidebar-link">基于 Polkadot 的跨链</a></li><li><a href="/blog_dev/区块链/基于token的投票.html" class="sidebar-link">基于 token 的投票 - 用 truffle 构建简单投票 DApp</a></li><li><a href="/blog_dev/区块链/如何获取DOT测试币.html" class="sidebar-link">如何获取 DOT 测试币</a></li><li><a href="/blog_dev/区块链/用Geth搭建以太坊私链.html" class="sidebar-link">用 Geth 搭建以太坊私链</a></li><li><a href="/blog_dev/区块链/用web3js写以太坊脚本.html" class="sidebar-link">用 web3js 写以太坊脚本</a></li><li><a href="/blog_dev/区块链/简单投票DApp.html" class="sidebar-link">简单投票 DApp</a></li><li><a href="/blog_dev/区块链/简单投票DApp_测试.html" class="sidebar-link">简单投票 DApp 测试</a></li><li><a href="/blog_dev/区块链/简单的投票合约.html" class="sidebar-link">简单的投票合约</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微信公众号</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>每日一道前端面试题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法与数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机服务基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>课程笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog_dev/课程表.html" class="sidebar-link">/课程表.html</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试之道</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="web3js"><a href="#web3js" class="header-anchor">#</a> web3js</h1> <p>shell 清除屏幕 <code>Control + L</code></p> <h2 id="前期准备"><a href="#前期准备" class="header-anchor">#</a> 前期准备</h2> <h3 id="安装-solc"><a href="#安装-solc" class="header-anchor">#</a> 安装 solc</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">npm</span> i solc -g
$ solcjs -V
<span class="token number">0.8</span>.4+commit.c7e474f2.Emscripten.clang
</code></pre></div><h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <ul><li>Web3 JavaScript app API</li> <li>web3js 是一个 JavaScript API 库，要使 DApp 在以太坊上运行，可以使用 web3js 库提供的 web3 对象</li> <li>web3js 通过 <strong>RPC 调用与本地节点通信</strong>，它可以用于任何暴露了 RPC 层的以太坊节点</li> <li>web3 包含 eth 对象-web3.eth(专门与以太坊区块链交互)和 shh 对象-web3.shh(用于与 Whisper 交互)
<ul><li>Whisper -&gt; 以太坊生态系统的一部分，实时通信，是分布式消息</li> <li>Swarm 分布式存储</li></ul></li></ul> <h2 id="web3-模块加载"><a href="#web3-模块加载" class="header-anchor">#</a> web3 模块加载</h2> <ul><li>将 web3 模块安装在项目中</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 最新的 1.3.5</span>
$ <span class="token function">npm</span> <span class="token function">install</span> web3@0.20.1
</code></pre></div><ul><li>然后创建一个 web3 实例，设置一个<code>provider</code></li> <li>为了保证 MetaMask 设置好<code>provider</code>不被覆盖掉，在引入 web3 之前，我们一般要做当前环境的检查（以 v0.20.1 为例）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> web3 <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  web3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Web3</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span>currentProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  web3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Web3</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Web3<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>HttpProvider</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8545&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="异步回调-callback"><a href="#异步回调-callback" class="header-anchor">#</a> 异步回调（callback）</h2> <ul><li>web3js API 设计的最初始的目的，主要是为了和本地 RPC 节点共同使用，所以默认情况下发送的是同步 HTTP 请求</li> <li>如果要发送异步请求，可以在函数的最后一个参数位置上吗，传入一个回调函数。回调函数是可选的（optional）</li> <li>一般采用回调风格的“错误优先”，例如：</li> <li>同步会阻塞</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBlock</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
  difficulty<span class="token operator">:</span> <span class="token string">'132160'</span><span class="token punctuation">,</span> <span class="token comment">// 难度</span>
  extraData<span class="token operator">:</span> <span class="token string">'0xd983010a02846765746888676f312e31362e338664617277696e'</span><span class="token punctuation">,</span> <span class="token comment">// 附加信息</span>
  gasLimit<span class="token operator">:</span> <span class="token number">4925370</span><span class="token punctuation">,</span> <span class="token comment">// 总共的gas上限</span>
  gasUsed<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 出块的时候消耗 的 gas</span>
  hash<span class="token operator">:</span> <span class="token string">'0x854f5109bbdad66deaef69e409575225e981049c0b61c22b7bf8c94823a4b513'</span><span class="token punctuation">,</span>
  logsBloom<span class="token operator">:</span> <span class="token string">'0x000...'</span><span class="token punctuation">,</span> <span class="token comment">// 事件过滤</span>
  miner<span class="token operator">:</span> <span class="token string">'0x9cab180D378005f9ecEa4869e77Cdde2BDb06FF5'</span><span class="token punctuation">,</span>
  mixHash<span class="token operator">:</span> <span class="token string">'0x868ec7d705e858a2ec795318a645570093361ac1d81d230844f3750f956e8140'</span><span class="token punctuation">,</span> <span class="token comment">// 挖矿时计算相关的 parentHash</span>
  nonce<span class="token operator">:</span> <span class="token string">'0x38e647f6f084e477'</span><span class="token punctuation">,</span> <span class="token comment">// 挖矿的 时候的随机数</span>
  number<span class="token operator">:</span> <span class="token number">48</span><span class="token punctuation">,</span>
  parentHash<span class="token operator">:</span> <span class="token string">'0x29cccb304525e35a7bd7062a8f836e3367dac5459a0456961efd5eb13186ae72'</span><span class="token punctuation">,</span>
  receiptsRoot<span class="token operator">:</span> <span class="token string">'0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421'</span><span class="token punctuation">,</span> <span class="token comment">//</span>
  sha3Uncles<span class="token operator">:</span> <span class="token string">'0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347'</span><span class="token punctuation">,</span>
  size<span class="token operator">:</span> <span class="token number">537</span><span class="token punctuation">,</span>
  stateRoot<span class="token operator">:</span> <span class="token string">'0xf7bb7f07785453c10e82dda0614cfc2069fefbceb6328696fec0d944b14dd935'</span><span class="token punctuation">,</span>
  timestamp<span class="token operator">:</span> <span class="token number">1619523928</span><span class="token punctuation">,</span>
  totalDifficulty<span class="token operator">:</span> <span class="token string">'6329090'</span><span class="token punctuation">,</span>
  transactions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//  没有交易，所以是空的</span>
  transactionsRoot<span class="token operator">:</span> <span class="token string">'0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421'</span><span class="token punctuation">,</span>
  uncles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="用-promise-回调"><a href="#用-promise-回调" class="header-anchor">#</a> 用 Promise 回调</h3> <ul><li>为了帮助 web3 集成到不同标准的所有类型，1.0.0 版本提供了很多方式处理异步函数。大多数 web3 对象允许将一个回调函数作为最后一个函数参数传入，同时会返回一个 promise 用于链式函数调用</li> <li>以太坊作为一个区块链系统，一次请求具有不同的结束阶段，为了满足这个要求，1.0.0 版本将这类函数调用的返回值包装成一个“承诺事件”（promiEvent），这是一个 promise 和 EventEmitter 的结合体</li> <li>PromiEvent 的用法就像 promise,另外还加入了<code>.on</code>,<code>.once</code>和<code>.off</code>方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">sendTransation</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">from</span><span class="token operator">:</span><span class="token string">&quot;0x123...&quot;</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token string">&quot;0x2323...&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 监听返回交易 hash</span>
<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">&quot;transactionHash&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">hash</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// receipt 收据，在交易打包进块的啥时候</span>
<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">&quot;receipt&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">receipt</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 有确认了</span>
<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;confirmation&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">confNumber<span class="token punctuation">,</span> receipt</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">receipt</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 在打包收据 进块的时候，就会触发</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="应用二进制接口-abi"><a href="#应用二进制接口-abi" class="header-anchor">#</a> 应用二进制接口（ABI）</h2> <ul><li>web3.js 通过以太坊智能合约的 json 接口（Application Binary Interface，json 的描述，ABI）创建一个 JavaScript 对象，用来在 js 代码中描述</li> <li>函数（functions)
<ul><li>type: 函数类型，默认“function”，也可能是“constructor”</li> <li>constant, payable, stateMutability: 函数的状态可变性</li> <li>inputs, outputs: 函数输入，输出参数描述列表</li></ul></li> <li>事件（events）
<ul><li>type: 类型，总是&quot;event&quot;</li> <li>inputs: 输入对象列表，包括 name, type, indexed</li></ul></li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">vi</span> Coin.sol
// SPDX-License-Identifier: SimPL-2.0
pragma solidity <span class="token operator">&gt;</span><span class="token operator">=</span><span class="token number">0.7</span>.0 <span class="token operator">&lt;</span><span class="token number">0.9</span>.0<span class="token punctuation">;</span>
contract Coin <span class="token punctuation">{</span>
  address public minter<span class="token punctuation">;</span>
  mapping <span class="token punctuation">(</span>address <span class="token operator">=</span><span class="token operator">&gt;</span> uint<span class="token punctuation">)</span> public balances<span class="token punctuation">;</span>
  event Sent<span class="token punctuation">(</span>address from,  address to, uint amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function-name function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>minter  <span class="token operator">=</span> msg.sender<span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> mint<span class="token punctuation">(</span>address receiver, uint amount<span class="token punctuation">)</span> public <span class="token punctuation">{</span>
    require<span class="token punctuation">(</span>msg.sender <span class="token operator">==</span> minter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    balances<span class="token punctuation">[</span>receiver<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> send<span class="token punctuation">(</span>address receiver, uint amount<span class="token punctuation">)</span> public <span class="token punctuation">{</span>
    require<span class="token punctuation">(</span>amount <span class="token operator">&lt;</span><span class="token operator">=</span> balances<span class="token punctuation">[</span>msg.sender<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    balances<span class="token punctuation">[</span>msg.sender<span class="token punctuation">]</span> -<span class="token operator">=</span> amount<span class="token punctuation">;</span>
    balances<span class="token punctuation">[</span>receiver<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span>
    emit Sent<span class="token punctuation">(</span>msg.sender, receiver, amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

$ mkdit contract
$ <span class="token function">mv</span> Coin.sol contract/
$ solcjs --abi Coin.sol
$ <span class="token function">ls</span>
Coin.sol Coin_sol_Contract.abi
$ <span class="token function">cat</span> Coin_sol_Contract.abi
<span class="token comment"># 事件  函数</span>
<span class="token comment"># abi 接口</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mapping</span> <span class="token punctuation">(</span><span class="token parameter">address</span> <span class="token operator">=&gt;</span> uint<span class="token punctuation">)</span> <span class="token keyword">public</span> balances<span class="token punctuation">;</span>
<span class="token comment">// 相当于</span>
<span class="token keyword">function</span> <span class="token function">balances</span><span class="token punctuation">(</span><span class="token parameter">address _addr</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">balances</span><span class="token punctuation">(</span>_addr<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;constructor&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;anonymous&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 匿名</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 可以所有的事件参数   日志在topic下，有单独的日志</span>
        <span class="token property">&quot;indexed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;from&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;indexed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;to&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;indexed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Sent&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;event&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balances&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 一个映射</span>
    <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;view&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;receiver&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mint&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 状态可变型</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;minter&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;view&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;inputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;receiver&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;internalType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;send&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stateMutability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p><code>solcjs --bin Coin.sol</code>最后提交到以太坊的代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Web3 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;web3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> web3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Web3</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Web3<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>HttpProvider</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8545&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span><span class="token function">isConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1.0+</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span>currentProvider<span class="token punctuation">.</span>connected<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="批处理请求"><a href="#批处理请求" class="header-anchor">#</a> 批处理请求</h2> <ul><li>批处理请求允许我们将请求排序，然后一起处理</li> <li>注意：批量请求不会更快，实际上，在某些情况下，一次性地发出许多请求会更快，因为请求是异步处理的</li> <li>批处理请求主要用于确保请求的顺序，并串行处理</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> batch <span class="token operator">=</span> web3<span class="token punctuation">.</span><span class="token function">createBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
batch<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
  web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>getBalance<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>
    <span class="token string">&quot;0x0000000000000000000000000000000000000000&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;latest&quot;</span><span class="token punctuation">,</span>
    callback
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
batch<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
  web3<span class="token punctuation">.</span>eth
    <span class="token punctuation">.</span><span class="token function">contract</span><span class="token punctuation">(</span>abi<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>balance<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> callback2<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
batch<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="大数处理"><a href="#大数处理" class="header-anchor">#</a> 大数处理</h2> <ul><li>JavaScript 中默认的数字精度较小，所以 web3.js 会自动添加一个依赖库 BigNumber, 专门用于大数处理</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> BigNumber <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;bignumber.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> balance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigNumber</span><span class="token punctuation">(</span><span class="token string">&quot;131242344353464564564574574567456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// BigNumber 类型的对象</span>
BigNumber <span class="token punctuation">{</span>
  s<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 表示 + -  -1 表示负数</span>
  e<span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token comment">// 位数</span>
  c<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">13124</span><span class="token punctuation">,</span> <span class="token number">23443534645645</span><span class="token punctuation">,</span> <span class="token number">64574574567456</span> <span class="token punctuation">]</span> <span class="token comment">// 从低位切起  14位</span>
<span class="token punctuation">}</span>
<span class="token comment">// or</span>
<span class="token comment">// var balance = web3.eth.getBalance(someAddress);</span>
balance<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
balance<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 10进制</span>
balance<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 16进制</span>
<span class="token comment">// &quot;131242344353464564564574574567477&quot;</span>
</code></pre></div><ul><li><code>BigNumber.toString(10)</code>对小数只保留 20 位浮点精度。所以推荐的做法是，我们内部总是用 wei 来表示余额（大整数），只有在需要显示给用户看的时候才转换为 ether 或其他单位</li></ul> <h2 id="常用-api"><a href="#常用-api" class="header-anchor">#</a> 常用 API</h2> <h3 id="基本信息查询"><a href="#基本信息查询" class="header-anchor">#</a> 基本信息查询</h3> <ul><li>查看 web3 版本</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>version<span class="token punctuation">.</span>api<span class="token punctuation">;</span>

web3<span class="token punctuation">.</span>version<span class="token punctuation">;</span>
</code></pre></div><ul><li>查看 web3 链接到的节点版本（clientVersion）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 0.+版本</span>
<span class="token comment">// 同步</span>
<span class="token operator">&gt;</span> web3<span class="token punctuation">.</span>version<span class="token punctuation">.</span>node<span class="token punctuation">;</span> <span class="token comment">// 'Geth/v1.10.2-stable/darwin-amd64/go1.16.3'</span>
<span class="token comment">// 异步</span>
<span class="token operator">&gt;</span> web3<span class="token punctuation">.</span>version<span class="token punctuation">.</span><span class="token function">getNode</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//  1+ 版本</span>
<span class="token operator">&gt;</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getNodeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise <span class="token punctuation">{</span><span class="token operator">&lt;</span>pending<span class="token operator">&gt;</span><span class="token punctuation">}</span>
<span class="token operator">&gt;</span> <span class="token string">'Geth/v1.10.2-stable/darwin-amd64/go1.16.3'</span>
</code></pre></div><ul><li>获取<code>network id</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步</span>
web3<span class="token punctuation">.</span>version<span class="token punctuation">.</span>network<span class="token punctuation">;</span>
<span class="token comment">// 异步</span>
web3<span class="token punctuation">.</span>version<span class="token punctuation">.</span><span class="token function">getNetwork</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1.+ 版本</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>net<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>获取节点的以太坊协议版本</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步</span>
web3<span class="token punctuation">.</span>version<span class="token punctuation">.</span>ethereum<span class="token punctuation">;</span>
<span class="token comment">// 异步</span>
web3<span class="token punctuation">.</span>version<span class="token punctuation">.</span><span class="token function">getEthereum</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1.+ 版本</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getProtocolVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="网络状态查询"><a href="#网络状态查询" class="header-anchor">#</a> 网络状态查询</h3> <ul><li>是否有节点链接/监听，返回 true/false</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步</span>
web3<span class="token punctuation">.</span><span class="token function">isConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>net<span class="token punctuation">.</span>listening<span class="token punctuation">;</span>
<span class="token comment">// 异步</span>
web3<span class="token punctuation">.</span>net<span class="token punctuation">.</span><span class="token function">getListening</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1.+ 版本</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>net<span class="token punctuation">.</span><span class="token function">isListening</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查看当前链接的 peer 节点</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步</span>
web3<span class="token punctuation">.</span>net<span class="token punctuation">.</span>peerCount<span class="token punctuation">;</span>
<span class="token comment">// 异步</span>
web3<span class="token punctuation">.</span>net<span class="token punctuation">.</span><span class="token function">getPeerCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>net<span class="token punctuation">.</span><span class="token function">getPeerCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="provider"><a href="#provider" class="header-anchor">#</a> Provider</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 查看当前设置的`web3 provider`</span>
web3<span class="token punctuation">.</span>currentProvider<span class="token punctuation">;</span>
<span class="token comment">// 查看浏览器环境设置的`web3 provider`</span>
web3<span class="token punctuation">.</span>givenProvider<span class="token punctuation">;</span>
<span class="token comment">// 设置provider</span>
<span class="token comment">// 已经创建好了web3对象，但不一定是需要的服务对象</span>
web3<span class="token punctuation">.</span><span class="token function">setProvider</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">web3<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>HttpProvider</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8545&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 浏览器环境检查现在连接到的provider</span>
window<span class="token punctuation">.</span>web3<span class="token punctuation">;</span> <span class="token comment">// 在浏览器非空页面，MateMask会注入web3到浏览器window对象里</span>
</code></pre></div><h4 id="geth-启动服务的选项"><a href="#geth-启动服务的选项" class="header-anchor">#</a> geth 启动服务的选项</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">API</span> <span class="token constant">AND</span> <span class="token constant">CONSOLE</span> <span class="token constant">OPTIONS</span><span class="token operator">:</span>
<span class="token operator">--</span>ipcdisable    <span class="token comment">// Disable the IPC-RPC server 是否启用</span>
<span class="token operator">--</span>ipcpath value    <span class="token comment">// Filename for IPC socket/pipe within the datadir (explicit paths escape it)</span>
<span class="token operator">--</span>http    <span class="token comment">// Enable the HTTP-RPC server</span>
<span class="token operator">--</span>http<span class="token punctuation">.</span>addr value    <span class="token comment">// HTTP-RPC server listening interface(defalut: &quot;localhost&quot;)</span>
<span class="token operator">--</span>http<span class="token punctuation">.</span>port value    <span class="token comment">// HTTP-RPC server listening port(default: 8545)</span>
<span class="token operator">--</span>http<span class="token punctuation">.</span>api value    <span class="token comment">// API's offered over the HTTP-RPC interface</span>
<span class="token operator">--</span>http<span class="token punctuation">.</span>rpcprefix value    <span class="token comment">// HTTP path path prefix  on which JSON-RPC is served. Use  &quot;/&quot; to serve on all paths</span>
<span class="token operator">--</span>http<span class="token punctuation">.</span>corsdomain value    <span class="token comment">// 允许跨域请求的域名列表（逗号分隔，浏览器强制）</span>
<span class="token comment">// Comma separated list of domains from which  to accept cross origin requests (browser enforced)</span>

<span class="token operator">--</span>http<span class="token punctuation">.</span>vhosts value    <span class="token comment">// Comma separated list of virtual hostnames from which to accept requests(server enforced). Accepts &quot;*&quot;  wildcard.(default: &quot;localhost&quot;)</span>
<span class="token operator">--</span>ws    <span class="token comment">// Enable the WS-RPC  server  官方推荐，安全</span>
<span class="token operator">--</span>ws<span class="token punctuation">.</span>addr value    <span class="token comment">// WS-RPC server listening  interface(default:  &quot;localhost&quot;)</span>
<span class="token operator">--</span>ws<span class="token punctuation">.</span>port value    <span class="token comment">// WS-RPC server listening port(default: 8546)</span>
<span class="token operator">--</span>ws<span class="token punctuation">.</span>api value    <span class="token comment">// API's offered over the WS-RPC interface</span>
<span class="token operator">--</span>ws<span class="token punctuation">.</span>rpcprefix value    <span class="token comment">// HTTP path prefix on which JSON-RPC  is served. Use &quot;/&quot; to serve on  all  paths.</span>
<span class="token operator">--</span>ws<span class="token punctuation">.</span>origins value    <span class="token comment">// Orgins from which to accept websockets requestss</span>
<span class="token operator">--</span>graphql    <span class="token comment">// Enable GraphQL on the HTTP-RPC server. Note that GraphQL can only be started if an HTTP server is started as well.</span>
<span class="token operator">--</span>graphql<span class="token punctuation">.</span>corsdomain value    <span class="token comment">// Comma separated list of domains from which  to accept cross origin requests (browser enforced)</span>
<span class="token operator">--</span>graphql<span class="token punctuation">.</span>vhosts value    <span class="token comment">// Comma separated list of virtual hostnames from which to accept requests(server enforced). Accepts &quot;*&quot;  wildcard.(default: &quot;localhost&quot;)</span>
<span class="token operator">--</span>rpc<span class="token punctuation">.</span>gascap value    <span class="token comment">// Sets a cap on gas that can be used in eth_call/estimateGas(0=infinite) (default:  25000000)</span>
<span class="token operator">--</span>rpc<span class="token punctuation">.</span>txfeecap value    <span class="token comment">// Sets a cap on transaction  fee (in ether)that can be sent via the  RPC APIs(0=no cap)(default:  1)</span>
<span class="token operator">--</span>rpc<span class="token punctuation">.</span>allow<span class="token operator">-</span>unprotected<span class="token operator">-</span>txs    <span class="token comment">// Allow for unprotected (non EIP155 signed) transactions to be submitted via RPC</span>
<span class="token operator">--</span>jspath loadScript    <span class="token comment">// JavaScript root path for loadScript(defaukt: &quot;.&quot;)</span>
<span class="token operator">--</span>exec value    <span class="token comment">// Execute JavaScript statement</span>
<span class="token operator">--</span>preload value    <span class="token comment">// Comma separated list of JavaScript files to preload into the console</span>
</code></pre></div><h3 id="web3-通用工具方法"><a href="#web3-通用工具方法" class="header-anchor">#</a> web3 通用工具方法</h3> <ul><li>以太单位转换</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>fromWei<span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>toWei<span class="token punctuation">;</span>
<span class="token comment">// 0.+</span>
web3<span class="token punctuation">.</span><span class="token function">fromWei</span><span class="token punctuation">(</span><span class="token number">2200823232323232323212121</span><span class="token punctuation">,</span> <span class="token string">&quot;ether&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span><span class="token function">toWei</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;ether&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1.+</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">fromWei</span><span class="token punctuation">(</span><span class="token string">&quot;2200823232323232323212121&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ether&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">toWei</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ether&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>数据类型转换</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 0.+</span>
web3<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>toDecimal<span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>toBigNumber<span class="token punctuation">;</span>
<span class="token comment">/// 1.+</span>
<span class="token comment">// 返回给定十六进制值的数字表示形式</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">hexToNumber</span><span class="token punctuation">(</span><span class="token string">&quot;0x2a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 42</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">toDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;0x2a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 42</span>

<span class="token keyword">var</span> <span class="token constant">BN</span> <span class="token operator">=</span> web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token constant">BN</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">BN</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;1234&quot;</span>
<span class="token keyword">new</span> <span class="token class-name">BN</span><span class="token punctuation">(</span><span class="token string">&quot;1234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BN</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;1235&quot;</span>
<span class="token keyword">new</span> <span class="token class-name">BN</span><span class="token punctuation">(</span><span class="token string">&quot;0xea&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;234&quot; // 这个有问题</span>
</code></pre></div><ul><li>字符编码转换</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>toHex<span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>toAscii<span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>toUtf8<span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>fromUtf8<span class="token punctuation">;</span>

<span class="token comment">/// 1. +</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">toHex</span><span class="token punctuation">(</span><span class="token string">&quot;234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;0xea&quot;</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">toHex</span><span class="token punctuation">(</span><span class="token string">&quot;0x49204c6f766520796f75&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'I Love you'</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">hexToAscii</span><span class="token punctuation">(</span><span class="token string">&quot;0x49204c6f766520796f75&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'I Love you'</span>
<span class="token comment">//</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">hexToUtf8</span><span class="token punctuation">(</span><span class="token string">&quot;0x49204c6f766520796f75&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">hexToString</span><span class="token punctuation">(</span><span class="token string">&quot;0x49204c6f766520796f75&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token string">&quot;0x49204c6f766520796f75&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

web3<span class="token punctuation">.</span><span class="token function">fromUtf8</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ALIAS, deprecated</span>
</code></pre></div><ul><li>地址相关</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>isAddress<span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>toChecksumAddress<span class="token punctuation">;</span>
<span class="token comment">// 1.+</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">isAddress</span><span class="token punctuation">(</span><span class="token string">&quot;0xc1912fee45d61c87cc5ea59dae31190fffff232d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// 将以太坊地址的大小写转换为校验和地址</span>
web3<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">toChecksumAddress</span><span class="token punctuation">(</span><span class="token string">&quot;0XC1912FEE45D61C87CC5EA59DAE31190FFFFF232D&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 0xc1912fEE45d61C87Cc5EA59DaE31190FFFFf232d // same as above</span>
</code></pre></div><h3 id="账户相关"><a href="#账户相关" class="header-anchor">#</a> 账户相关</h3> <ul><li>coinbase 查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 异步</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getCoinbase</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1.+</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getCoinbase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>账户查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">;</span>
<span class="token comment">// 异步  geth环境里也可用(es6语法不行)</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="区块相关的"><a href="#区块相关的" class="header-anchor">#</a> 区块相关的</h3> <ul><li>区块高度查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>blockNumber<span class="token punctuation">;</span>
<span class="token comment">// 异步</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBlockNumber</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. +</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBlockNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>

web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>gasPrice<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. +</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getGasPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>块中交易数量查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBlockTransactionCount</span><span class="token punctuation">(</span>hashStringOrBlockNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 异步</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBlockTransactionCount</span><span class="token punctuation">(</span>hashStringOrBlockNumber<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1. +</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBlockTransactionCount</span><span class="token punctuation">(</span>hashStringOrBlockNumber<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="交易相关"><a href="#交易相关" class="header-anchor">#</a> 交易相关</h3> <ul><li>余额查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span>addressHexString<span class="token punctuation">[</span><span class="token punctuation">,</span> defaultBlock<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>交易查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getTransaction</span><span class="token punctuation">(</span>transactionHash<span class="token punctuation">[</span><span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="交易执行相关"><a href="#交易执行相关" class="header-anchor">#</a> 交易执行相关</h3> <ul><li>交易收据查询（已进块）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getTransactionReceipt</span><span class="token punctuation">(</span>hashString<span class="token punctuation">[</span><span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>估计 gas 消耗</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">estimateGas</span><span class="token punctuation">(</span>callObject<span class="token punctuation">[</span><span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="发送交易"><a href="#发送交易" class="header-anchor">#</a> 发送交易</h3> <ul><li><code>web3.eth.sendTransaction(transactionObject[,callback])</code></li> <li>交易对象
<ul><li>from: 发送地址</li> <li>to: 接收地址，如果是创建合约交易，可不填</li> <li>value: 交易金额，以 wei 为单位，可选</li> <li>gas: 交易消耗 gas 上限，可选</li> <li>gasPrice: 交易 gas 单价，可选</li> <li>data: 交易携带的字符串数据，可选 // 合约交易携带的参数</li> <li>nonce: 整数 nonce 值，可选</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.在geth里解锁account[0]</span>
<span class="token operator">&gt;</span> personal<span class="token punctuation">.</span><span class="token function">unlockAccount</span><span class="token punctuation">(</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.web3</span>
<span class="token operator">&gt;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">await</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 想要交易receipt  必须要挖矿  miner.start()</span>
a<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">res</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token operator">:</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    to<span class="token operator">:</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token number">200000</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token string">&quot;0x&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">&quot;transactionHash&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">hash</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span>hash<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span>res<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span>e<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="消息调用"><a href="#消息调用" class="header-anchor">#</a> 消息调用</h3> <ul><li><code>web3.eth.call(callObject[, defaultBlock][,callback])</code></li> <li>参数
<ul><li>调用对象: 与交易对象相同，只是 from 也是可选的</li> <li>默认区块: 默认“latest”，可以传入指定区块高度</li> <li>回调函数，如果没有则为同步调用</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> result <span class="token operator">=</span> web3<span class="token punctuation">.</span><span class="token function">eth</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 向谁发出来的调用</span>
  to<span class="token operator">:</span> <span class="token string">&quot;0xc4abd0339eb8d57087278718986382264244252f&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 32位的字节 前8  函数的选择器</span>
  data<span class="token operator">:</span>
    <span class="token string">&quot;0xc6888fa1000000000000000000000000000000000000000000000000000 0000000000003&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="日志过滤-事件监听"><a href="#日志过滤-事件监听" class="header-anchor">#</a> 日志过滤（事件监听）</h3> <ul><li><code>web3.eth.filter(filterOptions[, callback])</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 0. +</span>
<span class="token comment">// pending 交易状态在pending 过滤</span>
<span class="token comment">// filterString 可以是“latest” or &quot;pending&quot; 指定过滤器选项</span>
<span class="token comment">// var filter = web3.eth.filter(filterString);</span>
<span class="token comment">// 或者可以填入一个日志过滤</span>
<span class="token keyword">var</span> filter <span class="token operator">=</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&quot;latest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 监听日志变化</span>
filter<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
filter<span class="token punctuation">.</span><span class="token function">stopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 还可以用传入回调函数的方法，立即开始监听日志</span>
web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. +</span>
</code></pre></div><h2 id="合约相关的"><a href="#合约相关的" class="header-anchor">#</a> 合约相关的</h2> <h3 id="创建合约"><a href="#创建合约" class="header-anchor">#</a> 创建合约</h3> <ul><li>web3.eth.contract</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/// 方法一  合约已部署</span>
<span class="token comment">// 通过地址初始化合约实例</span>
<span class="token comment">// var contractInstance = MyContract.at(address);</span>

<span class="token comment">/// 方法一  合约未部署</span>
<span class="token comment">// 部署一个新的合约</span>
<span class="token comment">// var contractInstance = MyContract.new(</span>
<span class="token comment">//   [constructorParam1]</span>
<span class="token comment">//   [,constructorParam2],</span>
<span class="token comment">//   {</span>
<span class="token comment">//     data: &quot;0x....&quot;,</span>
<span class="token comment">//     from: myAccount,</span>
<span class="token comment">//     gas: 1000000,</span>
<span class="token comment">//   },</span>
<span class="token comment">// );</span>
<span class="token comment">// abiArray 源代码数据结构</span>
<span class="token keyword">var</span> abiArray <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> inputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stateMutability<span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;constructor&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    anonymous<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    inputs<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        indexed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        internalType<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;from&quot;</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> indexed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> internalType<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;to&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        indexed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        internalType<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Sent&quot;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;event&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    inputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> internalType<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;balances&quot;</span><span class="token punctuation">,</span>
    outputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> internalType<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    stateMutability<span class="token operator">:</span> <span class="token string">&quot;view&quot;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    inputs<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> internalType<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;receiver&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> internalType<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;mint&quot;</span><span class="token punctuation">,</span>
    outputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    stateMutability<span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    inputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;minter&quot;</span><span class="token punctuation">,</span>
    outputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> internalType<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    stateMutability<span class="token operator">:</span> <span class="token string">&quot;view&quot;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    inputs<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> internalType<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;receiver&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;address&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> internalType<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;uint256&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;send&quot;</span><span class="token punctuation">,</span>
    outputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    stateMutability<span class="token operator">:</span> <span class="token string">&quot;nonpayable&quot;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> byteCode <span class="token operator">=</span> <span class="token string">&quot;0x&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">;</span> <span class="token comment">// solcjs --bin Coin.sol</span>
<span class="token keyword">var</span> MyContract <span class="token operator">=</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">contract</span><span class="token punctuation">(</span>abiArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> deployTxObject <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">from</span><span class="token operator">:</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> byteCode<span class="token punctuation">,</span>
  gas<span class="token operator">:</span> <span class="token number">1000000</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> contractInstance <span class="token operator">=</span> coinContract<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>deployTxObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> contractInstance <span class="token operator">=</span> contractInstance<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>deployTxObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 有延时</span>
<span class="token comment">// setTimeout(() =&gt; {</span>
<span class="token comment">//   console.log(contractInstance.address);</span>
<span class="token comment">//   // 0xca2f8c802b5a9a85e08dda50d1269e1939d97108</span>
<span class="token comment">// }, 20000);</span>
contractInstance<span class="token punctuation">.</span>address<span class="token punctuation">;</span> <span class="token comment">// 如果是undefined说明出块失败    如果是0x...说明部署成功</span>
</code></pre></div><p>v1.+</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>Contract</span><span class="token punctuation">(</span>jsonInterface<span class="token punctuation">[</span><span class="token punctuation">,</span> address<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>jsonInterface
<ul><li>Object: 要实例化的合约的 json 接口</li></ul></li> <li>address
<ul><li>myContract.options.address = &quot;0x123&quot; 来指定该地址</li></ul></li> <li>options
<ul><li>Object 可选，合约的配置对象，其中某些字段用作调用和交易的回调</li> <li>from: string 交易发生方地址</li> <li>gasPrice: string 用于交易的 gas 价格，单位 wei</li> <li>gas： number 交易可用最大 gas 量，即<code>gas limit</code></li> <li>data: string 合约字节码，部署合约时需要</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myContract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>Contract</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'0xde0B295669a9FD93d5F28D9Ec85E40f4cb697BAe'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token operator">:</span> <span class="token string">'0x1234567890123456789012345678901234567891'</span><span class="token punctuation">,</span> <span class="token comment">// default from address</span>
    gasPrice<span class="token operator">:</span> <span class="token string">'20000000000'</span> <span class="token comment">// default gas price in wei, 20 gwei in this case</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="调用合约函数"><a href="#调用合约函数" class="header-anchor">#</a> 调用合约函数</h3> <ul><li>可以通过已创建的合约实例，直接调用合约函数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// myMethod 合约里的函数名称</span>
<span class="token comment">// 直接调用，自动按函数类型决定用sendTransaction还是call</span>
contractInstance<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span>param1<span class="token punctuation">[</span><span class="token punctuation">,</span>param2<span class="token punctuation">,</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span>transactionObject<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span>defaultBlock<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span>callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 显示以消息调用形式call该函数  指定以消息调用的形式去调用 不需要发送交易时</span>
contractInstance<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>param1<span class="token punctuation">[</span><span class="token punctuation">,</span>param2<span class="token punctuation">,</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span>transactionObject<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span>defaultBlock<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span>callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 显式以发送交易形式调用该函数  状态的修改   转币</span>
contractInstance<span class="token punctuation">.</span>myMethod<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span>param1 <span class="token punctuation">[</span><span class="token punctuation">,</span> param2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> transactionObject<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



contractInstance<span class="token punctuation">.</span><span class="token function">minter</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">from</span><span class="token operator">:</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  to<span class="token operator">:</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> value<span class="token operator">:</span><span class="token number">40000</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// err</span>
contractInstance<span class="token punctuation">.</span><span class="token function">mint</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">3000000</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">from</span><span class="token operator">:</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
contractInstance<span class="token punctuation">.</span><span class="token function">balances</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>

contractInstance<span class="token punctuation">.</span><span class="token function">balances</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

contractInstance<span class="token punctuation">.</span><span class="token function">balances</span><span class="token punctuation">(</span><span class="token string">&quot;0x9cab180d378005f9ecea4869e77cdde2bdb06ff5&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="监听合约事件"><a href="#监听合约事件" class="header-anchor">#</a> 监听合约事件</h3> <ul><li>合约 event 类似于 filter,可以设置过滤选项来监听</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> event <span class="token operator">=</span> myContractInstance<span class="token punctuation">.</span><span class="token function">MyEvent</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> valueA<span class="token operator">:</span> <span class="token number">23</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token punctuation">,</span> additionalFill<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
contractInstance<span class="token punctuation">.</span><span class="token function">Sent</span><span class="token punctuation">(</span><span class="token string">&quot;pending&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err <span class="token operator">||</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
contractInstance<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">23000</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token keyword">from</span><span class="token operator">:</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="添加账户"><a href="#添加账户" class="header-anchor">#</a> 添加账户</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// geth 得设置 --rpcapi=&quot;db,eth,net,web3,personal,web3</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> newAccount <span class="token operator">=</span> <span class="token keyword">await</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>personal<span class="token punctuation">.</span><span class="token function">newAccount</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newAccount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> accounts <span class="token operator">=</span> <span class="token keyword">await</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>accounts<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog_dev/区块链/solidity深入理解.html" class="prev">
        Solidity 深入理解
      </a></span> <span class="next"><a href="/blog_dev/区块链/一个水龙头合约.html">
        一个水龙头合约
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog_dev/assets/js/app.709da227.js" defer></script><script src="/blog_dev/assets/js/2.556b46b5.js" defer></script><script src="/blog_dev/assets/js/231.109f1608.js" defer></script>
  </body>
</html>
