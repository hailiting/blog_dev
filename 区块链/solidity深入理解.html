<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Solidity 深入理解 | hailiting Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog_dev/logo.png">
    <meta name="description" content="hailiting Blog">
    
    <link rel="preload" href="/blog_dev/assets/css/0.styles.e9faf17d.css" as="style"><link rel="preload" href="/blog_dev/assets/js/app.709da227.js" as="script"><link rel="preload" href="/blog_dev/assets/js/2.556b46b5.js" as="script"><link rel="preload" href="/blog_dev/assets/js/230.74de1167.js" as="script"><link rel="prefetch" href="/blog_dev/assets/js/10.d061a1d9.js"><link rel="prefetch" href="/blog_dev/assets/js/100.0c7b74b5.js"><link rel="prefetch" href="/blog_dev/assets/js/101.63725a21.js"><link rel="prefetch" href="/blog_dev/assets/js/102.a0aa8352.js"><link rel="prefetch" href="/blog_dev/assets/js/103.3f4859f8.js"><link rel="prefetch" href="/blog_dev/assets/js/104.c375d9a0.js"><link rel="prefetch" href="/blog_dev/assets/js/105.3ab4f216.js"><link rel="prefetch" href="/blog_dev/assets/js/106.39c53827.js"><link rel="prefetch" href="/blog_dev/assets/js/107.f2a28572.js"><link rel="prefetch" href="/blog_dev/assets/js/108.dba8d9ec.js"><link rel="prefetch" href="/blog_dev/assets/js/109.be1a59c4.js"><link rel="prefetch" href="/blog_dev/assets/js/11.1fac2bc6.js"><link rel="prefetch" href="/blog_dev/assets/js/110.4e9a9fb3.js"><link rel="prefetch" href="/blog_dev/assets/js/111.e70ebf37.js"><link rel="prefetch" href="/blog_dev/assets/js/112.c2acf0c5.js"><link rel="prefetch" href="/blog_dev/assets/js/113.2c4c2f15.js"><link rel="prefetch" href="/blog_dev/assets/js/114.395922dd.js"><link rel="prefetch" href="/blog_dev/assets/js/115.4bca9bf3.js"><link rel="prefetch" href="/blog_dev/assets/js/116.49621d87.js"><link rel="prefetch" href="/blog_dev/assets/js/117.16ada7ad.js"><link rel="prefetch" href="/blog_dev/assets/js/118.2565919e.js"><link rel="prefetch" href="/blog_dev/assets/js/119.c12bdd10.js"><link rel="prefetch" href="/blog_dev/assets/js/12.4576cc3f.js"><link rel="prefetch" href="/blog_dev/assets/js/120.7939ff97.js"><link rel="prefetch" href="/blog_dev/assets/js/121.c26e4264.js"><link rel="prefetch" href="/blog_dev/assets/js/122.50fc8ef5.js"><link rel="prefetch" href="/blog_dev/assets/js/123.ffe9a78f.js"><link rel="prefetch" href="/blog_dev/assets/js/124.5aee6dd1.js"><link rel="prefetch" href="/blog_dev/assets/js/125.11cf3383.js"><link rel="prefetch" href="/blog_dev/assets/js/126.b056850f.js"><link rel="prefetch" href="/blog_dev/assets/js/127.80bc5fff.js"><link rel="prefetch" href="/blog_dev/assets/js/128.afdd2e1e.js"><link rel="prefetch" href="/blog_dev/assets/js/129.bd933eb7.js"><link rel="prefetch" href="/blog_dev/assets/js/13.bc140e8c.js"><link rel="prefetch" href="/blog_dev/assets/js/130.a87b24d0.js"><link rel="prefetch" href="/blog_dev/assets/js/131.9127e428.js"><link rel="prefetch" href="/blog_dev/assets/js/132.5baa85a6.js"><link rel="prefetch" href="/blog_dev/assets/js/133.e6519713.js"><link rel="prefetch" href="/blog_dev/assets/js/134.dbdebdb7.js"><link rel="prefetch" href="/blog_dev/assets/js/135.50b8f3cc.js"><link rel="prefetch" href="/blog_dev/assets/js/136.c9731137.js"><link rel="prefetch" href="/blog_dev/assets/js/137.f57d3761.js"><link rel="prefetch" href="/blog_dev/assets/js/138.6a94bea2.js"><link rel="prefetch" href="/blog_dev/assets/js/139.cdff373d.js"><link rel="prefetch" href="/blog_dev/assets/js/14.d889f0ed.js"><link rel="prefetch" href="/blog_dev/assets/js/140.dd2e3ba1.js"><link rel="prefetch" href="/blog_dev/assets/js/141.7a915726.js"><link rel="prefetch" href="/blog_dev/assets/js/142.58a0db92.js"><link rel="prefetch" href="/blog_dev/assets/js/143.182403fc.js"><link rel="prefetch" href="/blog_dev/assets/js/144.dcd6bf77.js"><link rel="prefetch" href="/blog_dev/assets/js/145.d06933fa.js"><link rel="prefetch" href="/blog_dev/assets/js/146.fd698fa3.js"><link rel="prefetch" href="/blog_dev/assets/js/147.2eaef6d1.js"><link rel="prefetch" href="/blog_dev/assets/js/148.3e1c96ae.js"><link rel="prefetch" href="/blog_dev/assets/js/149.bb7c3714.js"><link rel="prefetch" href="/blog_dev/assets/js/15.4ca3d2e1.js"><link rel="prefetch" href="/blog_dev/assets/js/150.937db40c.js"><link rel="prefetch" href="/blog_dev/assets/js/151.e911967c.js"><link rel="prefetch" href="/blog_dev/assets/js/152.ba1a29a5.js"><link rel="prefetch" href="/blog_dev/assets/js/153.47a6243a.js"><link rel="prefetch" href="/blog_dev/assets/js/154.511b473a.js"><link rel="prefetch" href="/blog_dev/assets/js/155.b8cce54b.js"><link rel="prefetch" href="/blog_dev/assets/js/156.8898b2f9.js"><link rel="prefetch" href="/blog_dev/assets/js/157.5f06ed86.js"><link rel="prefetch" href="/blog_dev/assets/js/158.137235af.js"><link rel="prefetch" href="/blog_dev/assets/js/159.0e9ce62a.js"><link rel="prefetch" href="/blog_dev/assets/js/16.456961f6.js"><link rel="prefetch" href="/blog_dev/assets/js/160.38d855a7.js"><link rel="prefetch" href="/blog_dev/assets/js/161.3590c707.js"><link rel="prefetch" href="/blog_dev/assets/js/162.86630534.js"><link rel="prefetch" href="/blog_dev/assets/js/163.6e13f473.js"><link rel="prefetch" href="/blog_dev/assets/js/164.d1fb6be0.js"><link rel="prefetch" href="/blog_dev/assets/js/165.f60ddeb1.js"><link rel="prefetch" href="/blog_dev/assets/js/166.32edcf10.js"><link rel="prefetch" href="/blog_dev/assets/js/167.c186a3aa.js"><link rel="prefetch" href="/blog_dev/assets/js/168.b4d579ba.js"><link rel="prefetch" href="/blog_dev/assets/js/169.67440797.js"><link rel="prefetch" href="/blog_dev/assets/js/17.529aaf8b.js"><link rel="prefetch" href="/blog_dev/assets/js/170.9764038a.js"><link rel="prefetch" href="/blog_dev/assets/js/171.6f3a2180.js"><link rel="prefetch" href="/blog_dev/assets/js/172.519538bf.js"><link rel="prefetch" href="/blog_dev/assets/js/173.9f7d6b1c.js"><link rel="prefetch" href="/blog_dev/assets/js/174.135c3ff2.js"><link rel="prefetch" href="/blog_dev/assets/js/175.fad4b7cd.js"><link rel="prefetch" href="/blog_dev/assets/js/176.a7e8b342.js"><link rel="prefetch" href="/blog_dev/assets/js/177.bc7d98e9.js"><link rel="prefetch" href="/blog_dev/assets/js/178.013841ad.js"><link rel="prefetch" href="/blog_dev/assets/js/179.ea55a800.js"><link rel="prefetch" href="/blog_dev/assets/js/18.c501dfa3.js"><link rel="prefetch" href="/blog_dev/assets/js/180.3fc7fc18.js"><link rel="prefetch" href="/blog_dev/assets/js/181.00d79ee8.js"><link rel="prefetch" href="/blog_dev/assets/js/182.75ce3c02.js"><link rel="prefetch" href="/blog_dev/assets/js/183.a111b430.js"><link rel="prefetch" href="/blog_dev/assets/js/184.934f6bbd.js"><link rel="prefetch" href="/blog_dev/assets/js/185.fd9febdb.js"><link rel="prefetch" href="/blog_dev/assets/js/186.0a342597.js"><link rel="prefetch" href="/blog_dev/assets/js/187.9e4b1686.js"><link rel="prefetch" href="/blog_dev/assets/js/188.2989272b.js"><link rel="prefetch" href="/blog_dev/assets/js/189.f45e0987.js"><link rel="prefetch" href="/blog_dev/assets/js/19.d413d821.js"><link rel="prefetch" href="/blog_dev/assets/js/190.83d10781.js"><link rel="prefetch" href="/blog_dev/assets/js/191.2b4e0c89.js"><link rel="prefetch" href="/blog_dev/assets/js/192.48865ed5.js"><link rel="prefetch" href="/blog_dev/assets/js/193.c01826d8.js"><link rel="prefetch" href="/blog_dev/assets/js/194.74e50b36.js"><link rel="prefetch" href="/blog_dev/assets/js/195.aa29f582.js"><link rel="prefetch" href="/blog_dev/assets/js/196.aca00a42.js"><link rel="prefetch" href="/blog_dev/assets/js/197.40b2c10e.js"><link rel="prefetch" href="/blog_dev/assets/js/198.33842e64.js"><link rel="prefetch" href="/blog_dev/assets/js/199.29e6325b.js"><link rel="prefetch" href="/blog_dev/assets/js/20.c89e4367.js"><link rel="prefetch" href="/blog_dev/assets/js/200.a7bce9d6.js"><link rel="prefetch" href="/blog_dev/assets/js/201.5025c6d3.js"><link rel="prefetch" href="/blog_dev/assets/js/202.c99897b4.js"><link rel="prefetch" href="/blog_dev/assets/js/203.347f1189.js"><link rel="prefetch" href="/blog_dev/assets/js/204.8de572ee.js"><link rel="prefetch" href="/blog_dev/assets/js/205.45483b34.js"><link rel="prefetch" href="/blog_dev/assets/js/206.c31290f0.js"><link rel="prefetch" href="/blog_dev/assets/js/207.e3f41a9a.js"><link rel="prefetch" href="/blog_dev/assets/js/208.d0dfd243.js"><link rel="prefetch" href="/blog_dev/assets/js/209.995ec2cb.js"><link rel="prefetch" href="/blog_dev/assets/js/21.25b239e1.js"><link rel="prefetch" href="/blog_dev/assets/js/210.e7965c3a.js"><link rel="prefetch" href="/blog_dev/assets/js/211.6b257aba.js"><link rel="prefetch" href="/blog_dev/assets/js/212.4a1cc3ec.js"><link rel="prefetch" href="/blog_dev/assets/js/213.31f8bf45.js"><link rel="prefetch" href="/blog_dev/assets/js/214.313c7b41.js"><link rel="prefetch" href="/blog_dev/assets/js/215.ee241838.js"><link rel="prefetch" href="/blog_dev/assets/js/216.3543cf04.js"><link rel="prefetch" href="/blog_dev/assets/js/217.0d6ea85b.js"><link rel="prefetch" href="/blog_dev/assets/js/218.80640071.js"><link rel="prefetch" href="/blog_dev/assets/js/219.151cb78a.js"><link rel="prefetch" href="/blog_dev/assets/js/22.d89f4d90.js"><link rel="prefetch" href="/blog_dev/assets/js/220.0eae0afd.js"><link rel="prefetch" href="/blog_dev/assets/js/221.8f8817b7.js"><link rel="prefetch" href="/blog_dev/assets/js/222.ae4bc9b6.js"><link rel="prefetch" href="/blog_dev/assets/js/223.a7aed6fa.js"><link rel="prefetch" href="/blog_dev/assets/js/224.025821c5.js"><link rel="prefetch" href="/blog_dev/assets/js/225.97d213b8.js"><link rel="prefetch" href="/blog_dev/assets/js/226.4578e374.js"><link rel="prefetch" href="/blog_dev/assets/js/227.dfd2b951.js"><link rel="prefetch" href="/blog_dev/assets/js/228.f25dfcc5.js"><link rel="prefetch" href="/blog_dev/assets/js/229.49de06f2.js"><link rel="prefetch" href="/blog_dev/assets/js/23.37517448.js"><link rel="prefetch" href="/blog_dev/assets/js/231.109f1608.js"><link rel="prefetch" href="/blog_dev/assets/js/232.b199ca54.js"><link rel="prefetch" href="/blog_dev/assets/js/233.e5505590.js"><link rel="prefetch" href="/blog_dev/assets/js/234.540cc14b.js"><link rel="prefetch" href="/blog_dev/assets/js/235.2c3a6404.js"><link rel="prefetch" href="/blog_dev/assets/js/236.7b387bc5.js"><link rel="prefetch" href="/blog_dev/assets/js/237.739ab0f9.js"><link rel="prefetch" href="/blog_dev/assets/js/238.fac109c9.js"><link rel="prefetch" href="/blog_dev/assets/js/239.1e997e2c.js"><link rel="prefetch" href="/blog_dev/assets/js/24.8c152fef.js"><link rel="prefetch" href="/blog_dev/assets/js/240.0b145d5f.js"><link rel="prefetch" href="/blog_dev/assets/js/241.09c4ce68.js"><link rel="prefetch" href="/blog_dev/assets/js/242.1e13a030.js"><link rel="prefetch" href="/blog_dev/assets/js/243.306372f7.js"><link rel="prefetch" href="/blog_dev/assets/js/244.63184878.js"><link rel="prefetch" href="/blog_dev/assets/js/245.8bcac252.js"><link rel="prefetch" href="/blog_dev/assets/js/246.99622cb5.js"><link rel="prefetch" href="/blog_dev/assets/js/247.34bd3960.js"><link rel="prefetch" href="/blog_dev/assets/js/248.2861f31a.js"><link rel="prefetch" href="/blog_dev/assets/js/249.6f62b76b.js"><link rel="prefetch" href="/blog_dev/assets/js/25.3bd7dbd6.js"><link rel="prefetch" href="/blog_dev/assets/js/250.441d1201.js"><link rel="prefetch" href="/blog_dev/assets/js/251.d1e30efd.js"><link rel="prefetch" href="/blog_dev/assets/js/252.1b993b77.js"><link rel="prefetch" href="/blog_dev/assets/js/253.7dd3cb2d.js"><link rel="prefetch" href="/blog_dev/assets/js/254.08d6a027.js"><link rel="prefetch" href="/blog_dev/assets/js/255.a95d32c3.js"><link rel="prefetch" href="/blog_dev/assets/js/256.4c0097ae.js"><link rel="prefetch" href="/blog_dev/assets/js/257.ccef358b.js"><link rel="prefetch" href="/blog_dev/assets/js/258.fcccb1d9.js"><link rel="prefetch" href="/blog_dev/assets/js/259.8c4e2a5b.js"><link rel="prefetch" href="/blog_dev/assets/js/26.357db678.js"><link rel="prefetch" href="/blog_dev/assets/js/260.45184866.js"><link rel="prefetch" href="/blog_dev/assets/js/261.57d645d4.js"><link rel="prefetch" href="/blog_dev/assets/js/262.cec8a62e.js"><link rel="prefetch" href="/blog_dev/assets/js/263.e8923920.js"><link rel="prefetch" href="/blog_dev/assets/js/264.37b490f7.js"><link rel="prefetch" href="/blog_dev/assets/js/265.ee7b00f6.js"><link rel="prefetch" href="/blog_dev/assets/js/266.0c31de3b.js"><link rel="prefetch" href="/blog_dev/assets/js/267.62925b15.js"><link rel="prefetch" href="/blog_dev/assets/js/268.6069bb2b.js"><link rel="prefetch" href="/blog_dev/assets/js/269.3c64c573.js"><link rel="prefetch" href="/blog_dev/assets/js/27.64c767de.js"><link rel="prefetch" href="/blog_dev/assets/js/270.ff44d5ab.js"><link rel="prefetch" href="/blog_dev/assets/js/271.de3eed75.js"><link rel="prefetch" href="/blog_dev/assets/js/272.9d9b6f12.js"><link rel="prefetch" href="/blog_dev/assets/js/273.b66c0be1.js"><link rel="prefetch" href="/blog_dev/assets/js/274.4d1bfedc.js"><link rel="prefetch" href="/blog_dev/assets/js/275.b7eceff6.js"><link rel="prefetch" href="/blog_dev/assets/js/276.eccd169a.js"><link rel="prefetch" href="/blog_dev/assets/js/277.a3a88438.js"><link rel="prefetch" href="/blog_dev/assets/js/278.22309baf.js"><link rel="prefetch" href="/blog_dev/assets/js/279.4373be14.js"><link rel="prefetch" href="/blog_dev/assets/js/28.0eaddbe2.js"><link rel="prefetch" href="/blog_dev/assets/js/280.bd9fb67f.js"><link rel="prefetch" href="/blog_dev/assets/js/281.2d9a98be.js"><link rel="prefetch" href="/blog_dev/assets/js/282.b90e372b.js"><link rel="prefetch" href="/blog_dev/assets/js/283.ec34c046.js"><link rel="prefetch" href="/blog_dev/assets/js/284.512f07f4.js"><link rel="prefetch" href="/blog_dev/assets/js/285.84d0ed1e.js"><link rel="prefetch" href="/blog_dev/assets/js/286.433c7816.js"><link rel="prefetch" href="/blog_dev/assets/js/287.0d3753f9.js"><link rel="prefetch" href="/blog_dev/assets/js/288.1c8d7744.js"><link rel="prefetch" href="/blog_dev/assets/js/289.476af6b9.js"><link rel="prefetch" href="/blog_dev/assets/js/29.5dd473c0.js"><link rel="prefetch" href="/blog_dev/assets/js/290.cbc40d8f.js"><link rel="prefetch" href="/blog_dev/assets/js/291.8346da5f.js"><link rel="prefetch" href="/blog_dev/assets/js/292.7384b627.js"><link rel="prefetch" href="/blog_dev/assets/js/293.63d74868.js"><link rel="prefetch" href="/blog_dev/assets/js/294.1410f408.js"><link rel="prefetch" href="/blog_dev/assets/js/295.952ce9ba.js"><link rel="prefetch" href="/blog_dev/assets/js/296.991a0da7.js"><link rel="prefetch" href="/blog_dev/assets/js/297.ec2fb727.js"><link rel="prefetch" href="/blog_dev/assets/js/298.c43e6ee0.js"><link rel="prefetch" href="/blog_dev/assets/js/299.02e81e03.js"><link rel="prefetch" href="/blog_dev/assets/js/3.bb975429.js"><link rel="prefetch" href="/blog_dev/assets/js/30.351b19a1.js"><link rel="prefetch" href="/blog_dev/assets/js/300.e4df5ed6.js"><link rel="prefetch" href="/blog_dev/assets/js/301.224fc9b4.js"><link rel="prefetch" href="/blog_dev/assets/js/302.ed9189c5.js"><link rel="prefetch" href="/blog_dev/assets/js/303.f0b78d10.js"><link rel="prefetch" href="/blog_dev/assets/js/304.6ec9ed66.js"><link rel="prefetch" href="/blog_dev/assets/js/305.c579e253.js"><link rel="prefetch" href="/blog_dev/assets/js/306.ac462491.js"><link rel="prefetch" href="/blog_dev/assets/js/307.abcd03c4.js"><link rel="prefetch" href="/blog_dev/assets/js/308.401c1772.js"><link rel="prefetch" href="/blog_dev/assets/js/309.84e52cc8.js"><link rel="prefetch" href="/blog_dev/assets/js/31.92bd6220.js"><link rel="prefetch" href="/blog_dev/assets/js/310.838924a1.js"><link rel="prefetch" href="/blog_dev/assets/js/311.c2d70590.js"><link rel="prefetch" href="/blog_dev/assets/js/312.892f867d.js"><link rel="prefetch" href="/blog_dev/assets/js/313.3f307c3e.js"><link rel="prefetch" href="/blog_dev/assets/js/314.a3ea90d5.js"><link rel="prefetch" href="/blog_dev/assets/js/315.6b095340.js"><link rel="prefetch" href="/blog_dev/assets/js/316.4f5b4c9b.js"><link rel="prefetch" href="/blog_dev/assets/js/317.66641d59.js"><link rel="prefetch" href="/blog_dev/assets/js/318.652dafd2.js"><link rel="prefetch" href="/blog_dev/assets/js/319.8dd6b519.js"><link rel="prefetch" href="/blog_dev/assets/js/32.fde56041.js"><link rel="prefetch" href="/blog_dev/assets/js/320.1fca28a4.js"><link rel="prefetch" href="/blog_dev/assets/js/321.6a52b165.js"><link rel="prefetch" href="/blog_dev/assets/js/322.4e9919d1.js"><link rel="prefetch" href="/blog_dev/assets/js/323.8a96f35f.js"><link rel="prefetch" href="/blog_dev/assets/js/324.590862d1.js"><link rel="prefetch" href="/blog_dev/assets/js/33.43b6d3a3.js"><link rel="prefetch" href="/blog_dev/assets/js/34.7ba26882.js"><link rel="prefetch" href="/blog_dev/assets/js/35.dd4ed088.js"><link rel="prefetch" href="/blog_dev/assets/js/36.114c5ba1.js"><link rel="prefetch" href="/blog_dev/assets/js/37.1952dd28.js"><link rel="prefetch" href="/blog_dev/assets/js/38.da914b09.js"><link rel="prefetch" href="/blog_dev/assets/js/39.7e26b7b2.js"><link rel="prefetch" href="/blog_dev/assets/js/4.47949fe2.js"><link rel="prefetch" href="/blog_dev/assets/js/40.b53ac1b8.js"><link rel="prefetch" href="/blog_dev/assets/js/41.ae8b1f98.js"><link rel="prefetch" href="/blog_dev/assets/js/42.479e9251.js"><link rel="prefetch" href="/blog_dev/assets/js/43.91d2fa5d.js"><link rel="prefetch" href="/blog_dev/assets/js/44.45a27817.js"><link rel="prefetch" href="/blog_dev/assets/js/45.9ba1f8c4.js"><link rel="prefetch" href="/blog_dev/assets/js/46.2eae6d1e.js"><link rel="prefetch" href="/blog_dev/assets/js/47.95b6f8e1.js"><link rel="prefetch" href="/blog_dev/assets/js/48.f0161ea5.js"><link rel="prefetch" href="/blog_dev/assets/js/49.5d642580.js"><link rel="prefetch" href="/blog_dev/assets/js/5.0ac632f7.js"><link rel="prefetch" href="/blog_dev/assets/js/50.8bd7a35f.js"><link rel="prefetch" href="/blog_dev/assets/js/51.56ae0cc4.js"><link rel="prefetch" href="/blog_dev/assets/js/52.ca920ca8.js"><link rel="prefetch" href="/blog_dev/assets/js/53.173c70ac.js"><link rel="prefetch" href="/blog_dev/assets/js/54.523b339d.js"><link rel="prefetch" href="/blog_dev/assets/js/55.ac75c90f.js"><link rel="prefetch" href="/blog_dev/assets/js/56.2e111d42.js"><link rel="prefetch" href="/blog_dev/assets/js/57.f51b48a0.js"><link rel="prefetch" href="/blog_dev/assets/js/58.1d77fc82.js"><link rel="prefetch" href="/blog_dev/assets/js/59.996c6ec0.js"><link rel="prefetch" href="/blog_dev/assets/js/6.7d92400c.js"><link rel="prefetch" href="/blog_dev/assets/js/60.9b1925f8.js"><link rel="prefetch" href="/blog_dev/assets/js/61.2622607d.js"><link rel="prefetch" href="/blog_dev/assets/js/62.9960ec8b.js"><link rel="prefetch" href="/blog_dev/assets/js/63.cc80d5d8.js"><link rel="prefetch" href="/blog_dev/assets/js/64.cd9d858a.js"><link rel="prefetch" href="/blog_dev/assets/js/65.2e5ca607.js"><link rel="prefetch" href="/blog_dev/assets/js/66.8be3c4c0.js"><link rel="prefetch" href="/blog_dev/assets/js/67.1eefd7d5.js"><link rel="prefetch" href="/blog_dev/assets/js/68.adf762ce.js"><link rel="prefetch" href="/blog_dev/assets/js/69.27c95c35.js"><link rel="prefetch" href="/blog_dev/assets/js/7.01b296e3.js"><link rel="prefetch" href="/blog_dev/assets/js/70.5097ac5d.js"><link rel="prefetch" href="/blog_dev/assets/js/71.e261fe0c.js"><link rel="prefetch" href="/blog_dev/assets/js/72.d5582ca6.js"><link rel="prefetch" href="/blog_dev/assets/js/73.8c99b9a5.js"><link rel="prefetch" href="/blog_dev/assets/js/74.360f75b2.js"><link rel="prefetch" href="/blog_dev/assets/js/75.31152e1a.js"><link rel="prefetch" href="/blog_dev/assets/js/76.1e48dadb.js"><link rel="prefetch" href="/blog_dev/assets/js/77.0d614aa8.js"><link rel="prefetch" href="/blog_dev/assets/js/78.d6dc4f4b.js"><link rel="prefetch" href="/blog_dev/assets/js/79.50283d30.js"><link rel="prefetch" href="/blog_dev/assets/js/8.7983d5a6.js"><link rel="prefetch" href="/blog_dev/assets/js/80.a52496b7.js"><link rel="prefetch" href="/blog_dev/assets/js/81.ea8065b9.js"><link rel="prefetch" href="/blog_dev/assets/js/82.8bc4a3cc.js"><link rel="prefetch" href="/blog_dev/assets/js/83.7fe873c1.js"><link rel="prefetch" href="/blog_dev/assets/js/84.d65a2741.js"><link rel="prefetch" href="/blog_dev/assets/js/85.27a9c21c.js"><link rel="prefetch" href="/blog_dev/assets/js/86.6d7e13c8.js"><link rel="prefetch" href="/blog_dev/assets/js/87.858dd9e0.js"><link rel="prefetch" href="/blog_dev/assets/js/88.c0d83d71.js"><link rel="prefetch" href="/blog_dev/assets/js/89.c6b08127.js"><link rel="prefetch" href="/blog_dev/assets/js/9.f2a5f044.js"><link rel="prefetch" href="/blog_dev/assets/js/90.4338e0cf.js"><link rel="prefetch" href="/blog_dev/assets/js/91.399fb4ca.js"><link rel="prefetch" href="/blog_dev/assets/js/92.ff317d0d.js"><link rel="prefetch" href="/blog_dev/assets/js/93.208e1694.js"><link rel="prefetch" href="/blog_dev/assets/js/94.13d481a5.js"><link rel="prefetch" href="/blog_dev/assets/js/95.984e2214.js"><link rel="prefetch" href="/blog_dev/assets/js/96.c1a273fa.js"><link rel="prefetch" href="/blog_dev/assets/js/97.bcbd1649.js"><link rel="prefetch" href="/blog_dev/assets/js/98.3fa49da9.js"><link rel="prefetch" href="/blog_dev/assets/js/99.fc09a5b7.js">
    <link rel="stylesheet" href="/blog_dev/assets/css/0.styles.e9faf17d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog_dev/" class="home-link router-link-active"><!----> <span class="site-name">hailiting Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Angular</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Demo笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog_dev/HTTP协议和反向代理.html" class="sidebar-link">浏览器行为与HTTP协议</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NodeJS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PHP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ReactNative</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Wechat</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mongodb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mysql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>npm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>区块链</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog_dev/区块链/DeFi.html" class="sidebar-link">DeFi 现实世界金融秩序的去中心化重构</a></li><li><a href="/blog_dev/区块链/EVM简介.html" class="sidebar-link">EVM 简介</a></li><li><a href="/blog_dev/区块链/Ethereum.html" class="sidebar-link">以太坊 Ethereum</a></li><li><a href="/blog_dev/区块链/Geth源码解析.html" class="sidebar-link">Geth 源码解析</a></li><li><a href="/blog_dev/区块链/Kotlin学习.html" class="sidebar-link">Kotlin 学习</a></li><li><a href="/blog_dev/区块链/MPT.html" class="sidebar-link">MPT Merkel-Patricia Tree</a></li><li><a href="/blog_dev/区块链/MetaMask报错集.html" class="sidebar-link">MetaMask 报错集</a></li><li><a href="/blog_dev/区块链/MetaMask网络地址.html" class="sidebar-link">MetaMask 网络地址</a></li><li><a href="/blog_dev/%E5%8C%BA%E5%9D%97%E9%93%BE/" aria-current="page" class="sidebar-link">区块链</a></li><li><a href="/blog_dev/区块链/Sha256加密字符串.html" class="sidebar-link">Sha256 加密字符串</a></li><li><a href="/blog_dev/区块链/Solidity简介.html" class="sidebar-link">Solidity 简介</a></li><li><a href="/blog_dev/区块链/SubQuery_HelloWorld.html" class="sidebar-link">SubQuery HelloWorld</a></li><li><a href="/blog_dev/区块链/Substrate入门.html" class="sidebar-link">Substrate 入门</a></li><li><a href="/blog_dev/区块链/solidity深入理解.html" class="active sidebar-link">Solidity 深入理解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-源文件布局" class="sidebar-link">Solidity 源文件布局</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#pragma版本杂注" class="sidebar-link">pragma版本杂注</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#import-导入其他源文件" class="sidebar-link">import(导入其他源文件)</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-值类型" class="sidebar-link">Solidity 值类型</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-引用类型" class="sidebar-link">Solidity 引用类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#数组-array" class="sidebar-link">数组 - Array</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#结构-struct" class="sidebar-link">结构 - Struct</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#映射-mapping-字典" class="sidebar-link">映射 - Mapping 字典</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-地址类型" class="sidebar-link">Solidity 地址类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#address" class="sidebar-link">address</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#address-payable-v0-5-0-引入" class="sidebar-link">address payable (v0.5.0 引入)</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#两者区别和转换" class="sidebar-link">两者区别和转换</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#地址类型成员变量" class="sidebar-link">地址类型成员变量</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#地址成员变量用法" class="sidebar-link">地址成员变量用法</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#字符数组-byte-arrays" class="sidebar-link">字符数组（Byte Arrays）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#定长字符数组" class="sidebar-link">定长字符数组</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#枚举-enum" class="sidebar-link">枚举（Enum）</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#数组-array-2" class="sidebar-link">数组(Array)</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#结构-struct-2" class="sidebar-link">结构(Struct)</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#映射-mapping" class="sidebar-link">映射(Mapping)</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-数据位置" class="sidebar-link">Solidity 数据位置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#数据位置总结" class="sidebar-link">数据位置总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-函数声明和类型" class="sidebar-link">Solidity 函数声明和类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidityy-函数可见性" class="sidebar-link">Solidityy 函数可见性</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-函数状态可变性" class="sidebar-link">Solidity 函数状态可变性</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#函数修饰器-modifier" class="sidebar-link">函数修饰器（modifier）</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#回退函数" class="sidebar-link">回退函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#事件-event" class="sidebar-link">事件（event）</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-异常处理" class="sidebar-link">Solidity 异常处理</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#solidity-中的单位" class="sidebar-link">Solidity 中的单位</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#以太币-ether" class="sidebar-link">以太币（ether）</a></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#时间" class="sidebar-link">时间</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#使用汇编-assembly-代码" class="sidebar-link">使用汇编 Assembly 代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_dev/区块链/solidity深入理解.html#内联汇编" class="sidebar-link">内联汇编</a></li></ul></li></ul></li><li><a href="/blog_dev/区块链/web3js简介.html" class="sidebar-link">web3js</a></li><li><a href="/blog_dev/区块链/一个水龙头合约.html" class="sidebar-link">一个水龙头合约</a></li><li><a href="/blog_dev/区块链/代币合约ERC20.html" class="sidebar-link">ERC20 代币合约</a></li><li><a href="/blog_dev/区块链/代币合约ERC20学习.html" class="sidebar-link">/区块链/代币合约ERC20学习.html</a></li><li><a href="/blog_dev/区块链/代币合约简单.html" class="sidebar-link">简单代币合约</a></li><li><a href="/blog_dev/区块链/以太坊交易.html" class="sidebar-link">以太坊交易</a></li><li><a href="/blog_dev/区块链/以太坊客户端.html" class="sidebar-link">以太坊客户端</a></li><li><a href="/blog_dev/区块链/以太坊白皮书.html" class="sidebar-link">以太坊白皮书</a></li><li><a href="/blog_dev/区块链/以太坊账户.html" class="sidebar-link">以太坊账户 EthereumAccounts</a></li><li><a href="/blog_dev/区块链/以太坊难度调整.html" class="sidebar-link">以太坊难度调整</a></li><li><a href="/blog_dev/区块链/区块链理论基础.html" class="sidebar-link">区块链理论基础</a></li><li><a href="/blog_dev/区块链/基于Polkadot的跨链.html" class="sidebar-link">基于 Polkadot 的跨链</a></li><li><a href="/blog_dev/区块链/基于token的投票.html" class="sidebar-link">基于 token 的投票 - 用 truffle 构建简单投票 DApp</a></li><li><a href="/blog_dev/区块链/如何获取DOT测试币.html" class="sidebar-link">如何获取 DOT 测试币</a></li><li><a href="/blog_dev/区块链/用Geth搭建以太坊私链.html" class="sidebar-link">用 Geth 搭建以太坊私链</a></li><li><a href="/blog_dev/区块链/用web3js写以太坊脚本.html" class="sidebar-link">用 web3js 写以太坊脚本</a></li><li><a href="/blog_dev/区块链/简单投票DApp.html" class="sidebar-link">简单投票 DApp</a></li><li><a href="/blog_dev/区块链/简单投票DApp_测试.html" class="sidebar-link">简单投票 DApp 测试</a></li><li><a href="/blog_dev/区块链/简单的投票合约.html" class="sidebar-link">简单的投票合约</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微信公众号</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>每日一道前端面试题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法与数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机服务基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>课程笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/blog_dev/课程表.html" class="sidebar-link">/课程表.html</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试之道</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="solidity-深入理解"><a href="#solidity-深入理解" class="header-anchor">#</a> Solidity 深入理解</h1> <h2 id="solidity-源文件布局"><a href="#solidity-源文件布局" class="header-anchor">#</a> Solidity 源文件布局</h2> <h3 id="pragma版本杂注"><a href="#pragma版本杂注" class="header-anchor">#</a> <code>pragma</code>版本杂注</h3> <ul><li>源文件可以被版本杂注 pragma 所注解，表明要求的编译器版本</li> <li>例如: <code>pragma solidity ^0.4.0;</code></li> <li>源文件将即不允许低于<code>0.4.0</code>版本的编译器编译，也不允许高于（包含）0.5.0 版本的编译器编译（第二个条件因为使用了<code>^</code>被添加）</li></ul> <h3 id="import-导入其他源文件"><a href="#import-导入其他源文件" class="header-anchor">#</a> <code>import</code>(导入其他源文件)</h3> <ul><li>Solidity 所支持的导入语句<code>import</code>，语法同<code>javascript</code>（ES6）非常类似</li></ul> <h4 id="具体用法解析"><a href="#具体用法解析" class="header-anchor">#</a> 具体用法解析</h4> <ul><li><code>import &quot;filename&quot;</code> <ul><li>从“filename”中导入所有的全局符号到当前全局作用域中</li></ul></li> <li><code>import * as symbolName from &quot;filename&quot;;</code> <ul><li>创建一个新的全局符号 symbolName，其 成员均来自“filename”中全局符号</li></ul></li> <li><code>import &quot;filename&quot; as symbolName;</code> <ul><li>这条语句等同于<code>import * as symmbolName from &quot;filename&quot;;</code></li></ul></li></ul> <h2 id="solidity-值类型"><a href="#solidity-值类型" class="header-anchor">#</a> Solidity 值类型</h2> <ul><li>布尔(bool): 可能的取值为字符常量值<code>true</code>或<code>false</code></li> <li>整形(int/uint): 分别表示有符号和无符号的不同位数的整形变量；支持关键字 uint8 到 uint256(无符号，从 8 位到 256 位)以及 int8 发哦 int256，以 8 位为步长递增</li> <li>定长浮点型(fixed/ufixed): 表示各种大小的有符号和无符号的定长浮点型；在关键字<code>ufixedMxN</code>和<code>fixedMxN</code>中，M 表示该类型占用的位数，N 表示可用的小数位数</li> <li>地址(address): 存储一个 20 字节的值（以太坊地址大小）</li> <li>定长字节数组：关键字有<code>bytes1</code>,<code>bytes2</code>....<code>bytes32</code></li> <li>枚举(enum): 一种用户可以定义类型的方法，与 C 语言类似，默认从 0 开始递增，一般用来模拟合同的状态</li> <li>函数(function): 一种表示函数的类型</li></ul> <h2 id="solidity-引用类型"><a href="#solidity-引用类型" class="header-anchor">#</a> Solidity 引用类型</h2> <h3 id="数组-array"><a href="#数组-array" class="header-anchor">#</a> 数组 - Array</h3> <ul><li>数组可以在声明时指定长度（定长数组），也可以动态调整大小（变长数组、动态数组）</li> <li>对于存储型（storage）的数组来说，元素类型可以是任意的（即元素也可以是 数组类型，映射类型或者结构体）</li> <li>对于内存型(memory)的数组来说，元素类型不能是映射(mapping)类型</li></ul> <h3 id="结构-struct"><a href="#结构-struct" class="header-anchor">#</a> 结构 - Struct</h3> <ul><li>Solidity 支持通过构造结构体的形式定义新的类型</li></ul> <h3 id="映射-mapping-字典"><a href="#映射-mapping-字典" class="header-anchor">#</a> 映射 - Mapping 字典</h3> <ul><li>映射可以视作<code>哈希表</code>，在实际的初始化过程中创建每个可能的 key，并将其映射到字节形式其实零的值（类型默认值）</li></ul> <h2 id="solidity-地址类型"><a href="#solidity-地址类型" class="header-anchor">#</a> Solidity 地址类型</h2> <h3 id="address"><a href="#address" class="header-anchor">#</a> address</h3> <ul><li>地址类型存储一个 20 字节的值（以太坊地址大小）；地址类型也有成员变量，并作为所有合约的基础</li></ul> <h3 id="address-payable-v0-5-0-引入"><a href="#address-payable-v0-5-0-引入" class="header-anchor">#</a> address payable (v0.5.0 引入)</h3> <ul><li>与地址类型基本相同，不过多出<code>transfer</code>和<code>send</code>两个成员变量</li></ul> <h3 id="两者区别和转换"><a href="#两者区别和转换" class="header-anchor">#</a> 两者区别和转换</h3> <ul><li>Payable 地址是可以发送 ether 的地址，而普通<code>address</code>不能</li> <li>允许从 <code>payable address</code>到<code>address</code>的隐式转换,而反过来的直接转换是不可能的（唯一的方法是通过<code>uint160</code>来 进行中间的转换）</li> <li>从 0.5.0 版本开始，合约不再是从地址型派生而来，但如果它有<code>payable</code>的回退函数，那同样可以显示转换为<code>address</code>或<code>address payable</code>类型</li> <li>0.5.0 以下 合约是继承地址类型</li></ul> <h3 id="地址类型成员变量"><a href="#地址类型成员变量" class="header-anchor">#</a> 地址类型成员变量</h3> <p>大的一个对象和结构</p> <h4 id="address-balance-uint256"><a href="#address-balance-uint256" class="header-anchor">#</a> <code>&lt;address&gt;.balance(uint256)</code></h4> <ul><li>该地址的 ether 余额，以 wei 为单位</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED;</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract Car <span class="token punctuation">{</span>
  string  brand<span class="token punctuation">;</span>
  uint  price<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">string memory initBrand<span class="token punctuation">,</span> uint  initPrice</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
    brand <span class="token operator">=</span> initBrand<span class="token punctuation">;</span>
    price <span class="token operator">=</span> initPrice<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">setBrand</span><span class="token punctuation">(</span><span class="token parameter">string  memory newBrand</span><span class="token punctuation">)</span>  <span class="token keyword">public</span>  <span class="token punctuation">{</span>
    brand  <span class="token operator">=</span> newBrand<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span>  <span class="token punctuation">(</span> <span class="token parameter">string memory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> brand<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token parameter">uint newPrice</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    price <span class="token operator">=</span> newPrice<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  fixed128x20 a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
contract CarPayable <span class="token punctuation">{</span>
  string a<span class="token punctuation">;</span>
  Car car <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token string">&quot;BMW&quot;</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">aa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> view <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token function">address</span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">.</span>balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">aaaaa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> view <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> car<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="address-payable-transfer-uint256-amount"><a href="#address-payable-transfer-uint256-amount" class="header-anchor">#</a> <code>&lt;address payable&gt;.transfer(uint256 amount)</code></h4> <ul><li>向指定地址发送数量为<code>amount</code>的<code>ether</code>(以 wei 为单位)，失败时抛出异常（等价于 <code>requi(send())</code>），发送 2300gas 的矿工费，不可调节</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract Faucet <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  payable <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">deposit</span><span class="token punctuation">(</span><span class="token parameter">address payable recipient<span class="token punctuation">,</span> uint256 amount</span><span class="token punctuation">)</span>  payable <span class="token keyword">public</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bool success</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> recipient<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">deposit02</span><span class="token punctuation">(</span><span class="token parameter">address payable recipient<span class="token punctuation">,</span> uint256 amount</span><span class="token punctuation">)</span> payable <span class="token keyword">public</span> <span class="token punctuation">{</span>
      <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>balance <span class="token operator">&gt;=</span> amount<span class="token punctuation">,</span> <span class="token string">&quot;balance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      recipient<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">sendValue</span><span class="token punctuation">(</span><span class="token parameter">address payable recipient<span class="token punctuation">,</span> uint256 amount</span><span class="token punctuation">)</span>  payable <span class="token keyword">public</span>  <span class="token punctuation">{</span>
      <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>balance <span class="token operator">&gt;=</span> amount<span class="token punctuation">,</span> <span class="token string">&quot;Address: insufficient balance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// solhint-disable-next-line avoid-low-level-calls, avoid-call-value</span>
      <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> <span class="token punctuation">)</span> <span class="token operator">=</span> recipient<span class="token punctuation">.</span>call<span class="token punctuation">{</span> value<span class="token operator">:</span> amount <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> <span class="token string">&quot;Address: unable to send value, recipient may have reverted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">balance</span><span class="token punctuation">(</span><span class="token parameter">address payable recipient</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256 amount</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> recipient<span class="token punctuation">.</span>balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">fallback</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> payable external <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">receive</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> payable external <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="address-payable-send-uint256-amount-returns-bool"><a href="#address-payable-send-uint256-amount-returns-bool" class="header-anchor">#</a> <code>&lt;address payable&gt;.send(uint256 amount) returns (bool)</code></h4> <ul><li>send 和 transfer 类似，send 不会发生异常，而是抛出 flase</li> <li>向指定地址发送数量为<code>amount</code>的<code>ether</code>(以 wei 为单位)，失败是返回 false，发送 2300 gas 的矿工费用，不可调节</li></ul> <h4 id="address-call-bytes-memory-returns-bool-bytes-memory"><a href="#address-call-bytes-memory-returns-bool-bytes-memory" class="header-anchor">#</a> <code>&lt;address&gt;.call(bytes memory) returns (bool, bytes memory)</code></h4> <ul><li>发出底层函数 call，失败时返回 false，发送所有可用 gas,可调节</li></ul> <h4 id="address-delegatecall-bytes-memory-returns-bool-bytes-memory"><a href="#address-delegatecall-bytes-memory-returns-bool-bytes-memory" class="header-anchor">#</a> <code>&lt;address&gt;.delegatecall(bytes memory) returns (bool, bytes memory)</code></h4> <ul><li>发出底层函数 DELEGATECALL，失败时返回 false，发送所有可用 gas，可调节</li></ul> <h4 id="address-staticcall-bytes-memory-returns-bool-bytes-memory"><a href="#address-staticcall-bytes-memory-returns-bool-bytes-memory" class="header-anchor">#</a> <code>&lt;address&gt;.staticcall(bytes memory) returns (bool, bytes memory)</code></h4> <ul><li>发出底层函数 STATICCALL，失败时返回 false，发送所有可用 gas，可调节</li></ul> <h3 id="地址成员变量用法"><a href="#地址成员变量用法" class="header-anchor">#</a> 地址成员变量用法</h3> <p><strong>balance 和 transfer</strong></p> <ul><li>可以使用 balance 属性来查询一个地址的余额，可以使用 transfer 函数向一个 payable 地址发送以太币<code>Ether</code>(以 wei 为单位)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>address payable x <span class="token operator">=</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token number">0x123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
address myAddress <span class="token operator">=</span>  <span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>balance <span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">&amp;&amp;</span>  myAddress<span class="token punctuation">.</span>balance<span class="token operator">&gt;=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  x<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>send</strong></p> <ul><li>send 是 transfer 的低版本，如果执行失败，当前的合约不会因为异常而终止，但 send 会返回 false
<strong>call</strong></li> <li>也可以用 call 来实现转币的操作，通过添加<code>.gas()</code>和<code>.value()</code>修饰符</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sendValue</span><span class="token punctuation">(</span><span class="token parameter">address payable recipient<span class="token punctuation">,</span> uint256 amount</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>balance <span class="token operator">&gt;=</span> amount<span class="token punctuation">,</span> <span class="token string">&quot;Address: insufficient balance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> <span class="token punctuation">)</span> <span class="token operator">=</span> recipient<span class="token punctuation">.</span>call<span class="token punctuation">{</span> value<span class="token operator">:</span> amount <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> <span class="token string">&quot;Address: unable to send value, recipient may have reverted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
nameReg<span class="token punctuation">.</span>call<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span> ether<span class="token punctuation">)</span><span class="token punctuation">(</span>abi<span class="token punctuation">.</span><span class="token function">encodeWithSignature</span><span class="token punctuation">(</span><span class="token string">&quot;register(string)&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MyName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="字符数组-byte-arrays"><a href="#字符数组-byte-arrays" class="header-anchor">#</a> 字符数组（Byte Arrays）</h2> <h3 id="定长字符数组"><a href="#定长字符数组" class="header-anchor">#</a> 定长字符数组</h3> <ul><li>属于值类型，<code>bytes1,bytes2,....bytes32</code>分别代表了长度为 1 到 32 的字节序列</li> <li>有一个<code>.length</code>属性，返回数组长度（只读）</li> <li>属于引用类型，包括<code>bytes</code>和<code>string</code>，不同的是<code>bytes</code>是 Hex 字符串，而<code>string</code>是 <code>UTF-8</code>编码的字符串</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract Test<span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> pure <span class="token keyword">public</span> <span class="token function">returns</span>  <span class="token punctuation">(</span><span class="token parameter">uint256 num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    bytes17 a<span class="token punctuation">;</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 0:uint256: num 17</span>
</code></pre></div><h2 id="枚举-enum"><a href="#枚举-enum" class="header-anchor">#</a> 枚举（Enum）</h2> <ul><li>枚举类型用来用户自定义一组常量值</li> <li>与 C 语言的枚举类型非常相似，对应整形值</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>pragma solidity <span class="token operator">&gt;=</span> <span class="token number">0.4</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract Purchase <span class="token punctuation">{</span>
  <span class="token comment">//  0 1 2</span>
  <span class="token keyword">enum</span> State  <span class="token punctuation">{</span>Created<span class="token punctuation">,</span>  Locked<span class="token punctuation">,</span> Inactive<span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    State a <span class="token operator">=</span> State<span class="token punctuation">.</span>Created<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">uint</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
    <span class="token comment">// State a = State.Locked;</span>
    <span class="token comment">// return uint(a); // 1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="数组-array-2"><a href="#数组-array-2" class="header-anchor">#</a> 数组(Array)</h2> <ul><li>固定大小<code>k</code>和元素类型<code>T</code>的数组被写为<code>T[k]</code>,动态大小的数组为<code>T[]</code>。例如，一个由 5 个 uint 动态数组组成的数组是<code>uint[][5]</code></li> <li>要访问第三个动态数组中的第二个<code>uint</code>，可以使用<code>x[2][1]</code></li> <li>越界访问数组，会导致调用失败回退</li> <li>如果要添加新元素，则必须使用<code>.push()</code>或将<code>.length</code>增大</li> <li>变长的<code>storage</code>数组和<code>bytes</code>（不包括 string）有一个<code>push()</code>方法。可以将一个新元素附加到数组末端，返回值为当前长度</li> <li>memory 是给定长度的</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity<span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.16</span><span class="token punctuation">;</span>
contract <span class="token constant">C</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">uint len</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure<span class="token punctuation">{</span>
    uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory  a <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">uint</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bytes memory b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">bytes</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 分配路由</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>length <span class="token operator">==</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    a<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token parameter">uint len</span><span class="token punctuation">)</span> <span class="token keyword">public</span>  pure  <span class="token function">returns</span>  <span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory a<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">uint</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">fun01</span><span class="token punctuation">(</span><span class="token parameter">uint len</span><span class="token punctuation">)</span> <span class="token keyword">public</span>  pure  <span class="token function">returns</span>  <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    bytes memory b <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">bytes</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="结构-struct-2"><a href="#结构-struct-2" class="header-anchor">#</a> 结构(Struct)</h2> <ul><li>结构类型可以在映射和数组中使用，它们本身可以包含映射和数组</li> <li>结构不能包含自己类型的成员，但可以作为自己数组成员的类型，也可以作为自己映射成员的值类型</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;=</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract Ballot  <span class="token punctuation">{</span>
  <span class="token comment">// struct Ballot // err 不能引用循环</span>
  struct Voter<span class="token punctuation">{</span>
    uint weight<span class="token punctuation">;</span>
    bool voted<span class="token punctuation">;</span>
    uint vote<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="映射-mapping"><a href="#映射-mapping" class="header-anchor">#</a> 映射(Mapping)</h2> <ul><li>声明一个映射：<code>mapping(_KeyType=&gt;_ValueType)</code></li> <li><code>_KeyType</code>可以是任何基本类型。这意味着他可以是任何内置值类型 加上字节和字符串。不允许使用用户定义的或复杂的类型，如枚举，映射，结构 以及除<code>bytes</code>和<code>string</code>之外的任何数组类型</li> <li><code>_ValueType</code>可以是任何类型，包括映射</li></ul> <p><strong>谁调起了方法，谁就是<code>msg.sender</code></strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;=</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract <span class="token constant">C</span><span class="token punctuation">{</span>
  <span class="token function">mapping</span><span class="token punctuation">(</span><span class="token parameter">address</span><span class="token operator">=&gt;</span>uint<span class="token punctuation">)</span> <span class="token keyword">public</span> balances<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    balances<span class="token punctuation">[</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 自己改自己的余额</span>
  <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">uint newBalance</span><span class="token punctuation">)</span><span class="token keyword">public</span><span class="token punctuation">{</span>
    balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">=</span> newBalance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">updateAddr</span><span class="token punctuation">(</span><span class="token parameter">address addr<span class="token punctuation">,</span> uint newBalance</span><span class="token punctuation">)</span><span class="token keyword">public</span><span class="token punctuation">{</span>
    balances<span class="token punctuation">[</span>addr<span class="token punctuation">]</span> <span class="token operator">=</span> newBalance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
contract <span class="token constant">D</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> memory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// C 合约本身也是一个类型</span>
    <span class="token comment">// new C() 调用了C 的 constructor</span>
    <span class="token constant">C</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 一个合约的外面去调用合约方法</span>
    c<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这里更新的是D的余额，因为D调用了c</span>
    c<span class="token punctuation">.</span><span class="token function">updateAddr</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// m.balances   访问的是内置的方法</span>
    <span class="token comment">// 定义public   相当于定义了balances function 变量</span>
    <span class="token comment">// 在输出台输出</span>
    <span class="token comment">// decoded output	{ &quot;0&quot;: &quot;uint256[2]: 100,1000&quot; }</span>
    <span class="token comment">// decoded 已解码</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>c<span class="token punctuation">.</span><span class="token function">balances</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span><span class="token function">balances</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// msg.sender指部署合约的地址   所以是0</span>
    <span class="token comment">// return c.balances(address(msg.sender));</span>

    <span class="token comment">// decoded output	{ &quot;0&quot;: &quot;uint256: success 300&quot; }</span>
    <span class="token comment">// return c.balances(address(c));</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 主地址 部署了 D，成为了msg.sender</span>
<span class="token comment">// c是D调用的</span>
<span class="token comment">// C的合约c来调用</span>
<span class="token comment">// update是D来调用</span>
<span class="token comment">// 只要msg.sender没有加代理，一定就是D</span>
</code></pre></div><h2 id="solidity-数据位置"><a href="#solidity-数据位置" class="header-anchor">#</a> Solidity 数据位置</h2> <ul><li>所有的复杂类型，即<code>数组</code>、<code>结构</code>和<code>映射</code>，都有一个额外属性，“数据位置”。用来说明数据是保存在内存<code>memory</code>中还是存储在<code>storage</code>中</li> <li>根据上下文不同，大多数时候数据有默认的位置，但也可以通过在类型名后添加关键字<code>storage</code>或<code>memory</code>进行修改</li> <li>函数参数(包括返回的参数)的数据位置默认是 memory，局部变量的数据位置默认是<code>storage</code>，状态变量的数据位置强制<code>storage</code></li> <li>另外还存在第三种数据位置，calldata，这是一块只读的，且不会永久存储的位置，用来存储函数参数。外部函数的参数（非返回参数）的数据位置被强制指定为<code>calldata</code>，效果跟<code>memory</code>差不多</li> <li><code>memory</code> 访问快，占用少</li> <li><code>storage</code> 存储空间大，持久化存储</li></ul> <h3 id="数据位置总结"><a href="#数据位置总结" class="header-anchor">#</a> 数据位置总结</h3> <p><strong>强制指定数据位置</strong></p> <ul><li>外部函数的参数（不包括返回参数）：calldata</li> <li>状态变量：storage
<strong>默认数据位置</strong></li> <li>函数参数（包括返回参数）： memory;</li> <li>引用类型的局部变量：storage</li> <li>值类型的局部变量：栈（stack）
<strong>特别要求</strong></li> <li>公开可见（public visible）的函数参数一定是 memory 类型，如果要求是<code>storage</code>类型则必须是<code>private</code>或者<code>internal</code>函数，这是为了防止随意的公开调用占用资源</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract <span class="token constant">C</span><span class="token punctuation">{</span>
  uint<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">public</span> data1<span class="token punctuation">;</span>
  uint<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">public</span> data2<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">appendOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">append</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    data1<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">233</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> data1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">appendTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token function">append</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// d 是 data1 的引用</span>
  <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> storage d</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
    d<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract  <span class="token constant">C</span><span class="token punctuation">{</span>
  uint <span class="token keyword">public</span> a<span class="token punctuation">;</span>
  uint <span class="token keyword">public</span> b<span class="token punctuation">;</span>
  uint<span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span> <span class="token comment">// 存的是data的长度</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
    <span class="token comment">// TypeError: Data location must be &quot;storage&quot;, &quot;memory&quot; or &quot;calldata&quot; for variable, but none was given.</span>
    <span class="token comment">// 没有分配存储空间的一个属性</span>
    <span class="token comment">// 元素的索引值和 x 的length</span>
    uint<span class="token punctuation">[</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
    x<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x指向全局 长度变为1  x的长度改变为1会指向C的第一位  所以a变为1</span>
    data <span class="token operator">=</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract  <span class="token constant">C</span><span class="token punctuation">{</span>
  uint someVariable<span class="token punctuation">;</span>
  uint<span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
    uint<span class="token punctuation">[</span><span class="token punctuation">]</span> storage x <span class="token operator">=</span> data<span class="token punctuation">;</span><span class="token comment">// err</span>
    x<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data <span class="token operator">=</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract  <span class="token constant">C</span><span class="token punctuation">{</span>
  uint <span class="token keyword">public</span> a<span class="token punctuation">;</span>
  uint <span class="token keyword">public</span> b<span class="token punctuation">;</span>
  uint<span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
    <span class="token function">arrLen</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>  <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">arrLen</span><span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> storage arr<span class="token punctuation">,</span> uint  num</span><span class="token punctuation">)</span> internal <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>
contract <span class="token constant">C</span> <span class="token punctuation">{</span>
  uint<span class="token punctuation">[</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory memoryArray</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token comment">// memory和storage数据类型一样的话，可以互相传值</span>
    <span class="token comment">// memory赋值给storage变量，是完整的拷贝</span>
    <span class="token comment">// 局部转状态的时候是拷贝</span>
    x <span class="token operator">=</span> memoryArray<span class="token punctuation">;</span>
    uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory y <span class="token operator">=</span> x<span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// y.length = 2; // read only</span>
    <span class="token keyword">delete</span> x<span class="token punctuation">;</span>
    y <span class="token operator">=</span> memoryArray<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> y<span class="token punctuation">;</span>
    <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">h</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> storage storageArray</span><span class="token punctuation">)</span> internal<span class="token punctuation">{</span>
       storageArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory memoryArray</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> memoryArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.22</span><span class="token punctuation">;</span>
contract Honeypot <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> payable <span class="token punctuation">{</span><span class="token punctuation">}</span>
  uint luckyNum <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">;</span>
  uint <span class="token keyword">public</span> last<span class="token punctuation">;</span>
  struct Guess<span class="token punctuation">{</span>
    address player<span class="token punctuation">;</span>
    uint number<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  Guess<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">public</span> guessHistory<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">guesss</span><span class="token punctuation">(</span><span class="token parameter">uint _num</span><span class="token punctuation">)</span> <span class="token keyword">public</span> payable <span class="token punctuation">{</span>
    Guess memory newGuess<span class="token punctuation">;</span>
    newGuess<span class="token punctuation">.</span>player <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    newGuess<span class="token punctuation">.</span>number <span class="token operator">=</span> _num<span class="token punctuation">;</span>
    guessHistory<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newGuess<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>_num <span class="token operator">==</span> luckyNum<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 合约要给这个sender2倍币</span>
      <span class="token function">payable</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>value <span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    last <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">fallback</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> payable external <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">receive</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> payable external <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="solidity-函数声明和类型"><a href="#solidity-函数声明和类型" class="header-anchor">#</a> Solidity 函数声明和类型</h2> <p>函数的值类型有两类： - 内部（internal）函数和外部（external）函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// getBrand     函数名</span>
<span class="token comment">// public view returns   函数类型</span>
<span class="token comment">// returns (string)  返回类型</span>
<span class="token keyword">function</span> <span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> brand<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>内部函数只能在当前合约内被调用（更具体来说，在<code>当前代码块</code>内，包括<code>内部库函数</code>和<code>继承的函数</code>中调用），因为他们不能在当前合约上下文的外部被执行。</li> <li>调用一个内部函数是通过跳转到它的入口标签来实现的，就像在当前合约的内部调用一个函数</li> <li>外部函数由一个地址和一个函数签名组成，可以通过外部函数调用传递或返回</li> <li>调用内部函数：直接 使用名字 f</li> <li>调用外部函数：<code>this.f</code>(当前合约)，<code>a.f</code>(外部合约)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.22</span><span class="token punctuation">;</span>
contract <span class="token constant">C</span><span class="token punctuation">{</span>
  uint a<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 私有方法不能被外部调用</span>
  <span class="token keyword">function</span> <span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
contract <span class="token constant">D</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token constant">C</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    c<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 外部调用</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
contract <span class="token constant">E</span> is <span class="token constant">C</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 继承函数</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="solidityy-函数可见性"><a href="#solidityy-函数可见性" class="header-anchor">#</a> Solidityy 函数可见性</h3> <p>函数的可见性可以指定为<code>external</code>, <code>public</code>, <code>internal</code>或<code>private</code>;
对于状态变量，不能设置为<code>external</code>，默认是<code>internal</code></p> <ul><li><code>external</code>: 外部函数作为合约接口的一部分，意味着我们可以从其他合约和交易中调用。一个外部函数<code>f</code>不能从内部调用（即 f 不起作用，但<code>this.f()</code>可以）。当收到大量数据的时候，外部函数有时候会更有效率</li> <li><code>public</code>: <code>public</code>函数是合约接口的一部分，可以在内部或通过消息调用。对于 <code>public</code> 状态变量，会自动生成一个 <code>getter</code> 函数</li> <li><code>internal</code>: 这些函数和状态变量只能是内部访问（即从当前合约内部或从它派生的合约访问），不使用<code>this</code>调用</li> <li><code>private</code>: <code>private</code>函数和状态变量仅在当前定义它们的合约中使用，并且不能被派生合约使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.22</span><span class="token punctuation">;</span>
contract <span class="token constant">C</span> <span class="token punctuation">{</span>
  uint <span class="token keyword">private</span> data<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">uint  a</span><span class="token punctuation">)</span> <span class="token keyword">private</span> pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">setData</span><span class="token punctuation">(</span><span class="token parameter">uint a</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    data <span class="token operator">=</span> a<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token parameter">uint a<span class="token punctuation">,</span> uint b</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
contract <span class="token constant">D</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token constant">C</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    uint local<span class="token punctuation">;</span>
    <span class="token comment">// private 仅在当前合约内部访问</span>
    <span class="token comment">// uint local = c.f(7);</span>

    c<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    local <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// compute internal 当前合约内部 或 派生合约 访问</span>
    <span class="token comment">// local =c.compute(3, 5);</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
contract <span class="token constant">E</span> is <span class="token constant">C</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uint val <span class="token operator">=</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> val<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.22</span><span class="token punctuation">;</span>
contract <span class="token constant">C</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">uint a</span><span class="token punctuation">)</span> <span class="token keyword">private</span> pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">setData</span><span class="token punctuation">(</span><span class="token parameter">uint a</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
    data <span class="token operator">=</span> a<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  uint <span class="token keyword">public</span> data<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
    data <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// 内部访问</span>
    uint val  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 外部访问</span>
    uint val2 <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="solidity-函数状态可变性"><a href="#solidity-函数状态可变性" class="header-anchor">#</a> Solidity 函数状态可变性</h3> <ul><li>pure: 纯函数，不允许修改或访问状态</li> <li>view: 不允许修改状态</li> <li>payable: 允许从消息调用中接收以太币 Ether</li> <li>constant: 与 view 相同，一般只修饰状态变量，不允许赋值（除初始化以外）</li></ul> <h4 id="以下情况被认为是修改状态"><a href="#以下情况被认为是修改状态" class="header-anchor">#</a> 以下情况被认为是修改状态</h4> <ul><li>修改状态变量</li> <li>产生事件 <code>emit</code> <code>event</code></li> <li>创建其他合约</li> <li>使用 selfdestruct</li> <li>通过调用发送以太币</li> <li><strong>调用任何没有标记 view 或 pure 的函数</strong></li> <li>使用低级调用 call xxxcall</li> <li>使用包含特定操作码的内联汇编</li></ul> <h4 id="以下被认为是从状态中进行读取"><a href="#以下被认为是从状态中进行读取" class="header-anchor">#</a> 以下被认为是从状态中进行读取</h4> <ul><li>读取状态变量</li> <li>访问<code>this.balance</code>或<code>&lt;address&gt;.balance</code></li> <li>访问<code>block</code>,<code>tx</code>,<code>msg</code>中任意成员（除<code>msg.sig</code>和<code>msg.data</code>之外）</li> <li>调用任何未标记为 pure 的函数</li> <li>使用包含某些操作码的内联汇编</li></ul> <h3 id="函数修饰器-modifier"><a href="#函数修饰器-modifier" class="header-anchor">#</a> 函数修饰器（modifier）</h3> <ul><li>使用修饰器<code>modifier</code>可以轻松改变函数的行为。例如，他们可以在执行函数之前自动检查某个条件。修饰器<code>modifier</code>是合约的可继承属性，并可能被派生合约覆盖</li> <li>如果同一个函数有多个修饰器<code>modifier</code>，他们之间以空格隔开，修饰器<code>modifier</code>会依次检查执行</li> <li>把一个固定的操作添加到某一个函数上</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.22</span><span class="token punctuation">;</span>
contract Purchase <span class="token punctuation">{</span>
  address <span class="token keyword">public</span> seller<span class="token punctuation">;</span>
  uint256 <span class="token keyword">public</span> a<span class="token punctuation">;</span><span class="token comment">// a 为300</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      seller <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  modifier <span class="token function">onlySeller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    _<span class="token punctuation">;</span> <span class="token comment">// 自己原有的代码在这执行</span>
    a <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
    <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> seller<span class="token punctuation">,</span> <span class="token string">&quot;only seller can call&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> onlySeller <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// modifier user</span>
    <span class="token comment">// ...</span>
    a <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1111</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="回退函数"><a href="#回退函数" class="header-anchor">#</a> 回退函数</h3> <ul><li>回退函数（fallback function）是合约中特殊的函数；没有名字，不能有参数也不能有返回值</li> <li>如果在一个到合约的调用中，没有其他函数与给定的函数标识符匹配（或没有提供调用数据），那么这个函数（fallback 函数）会被执行</li> <li>每当合约收到以太币（没有任何数据，纯转账），回退函数就会被执行。此外，为了接收以太币，fallback 函数必须标记为 payable。如果不存在这样的函数，则 合约不能通过常规交易接收以太币</li> <li>在上下文中通常只有很少的 gas 可以用来完成回退函数的调用，所以使 fallback 函数的调用尽量廉价很重要</li> <li>自己的合约调用别人的合约，没有判定地址是什么地址类型，重复的回退调用（thedog）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: UNLICENSED</span>
pragma solidity <span class="token operator">&gt;</span><span class="token number">0.4</span><span class="token number">.22</span><span class="token punctuation">;</span>
contract Sink<span class="token punctuation">{</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external  payable<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
contract Test <span class="token punctuation">{</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external <span class="token punctuation">{</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  uint x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
contract Caller <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">callTest</span><span class="token punctuation">(</span><span class="token parameter">Test test</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bool</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">address</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>abi<span class="token punctuation">.</span><span class="token function">encodeWithSignature</span><span class="token punctuation">(</span><span class="token string">&quot;nonExistingFunction&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>
    address payable testPayable <span class="token operator">=</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token function">uint160</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> testPayable<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token number">2</span> ether<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="事件-event"><a href="#事件-event" class="header-anchor">#</a> 事件（event）</h2> <ul><li>事件是以太坊 EVM 提供的一种日志基础设施。事件可以用来做操作记录，存储为日志。也可以用来实现一些交互功能 ，比如通知 UI，返回函数调用结果等</li> <li>当定义的事件触发时，我们可以将事件存储到 EVM 的交易日志中，日志是区块链中的一种特殊数据结构；日志与合约关联，与合约的存储合并存入区块链中；只要某个区块可以访问，其相关的日志就可以访问；但在合约中，我们不能直接访问日志和事件数据</li> <li>可以通过日志实现简单支付验证 SPV(Simplified Payment Verification), 如果一个外部实体提供了一个带有这种证明的合约，它可以检查日志是否真实存在于区块链中</li></ul> <h2 id="solidity-异常处理"><a href="#solidity-异常处理" class="header-anchor">#</a> Solidity 异常处理</h2> <ul><li>Solidity 使用“状态恢复异常”来处理异常。这样的异常将撤销对当前调用（及其所有子调用）中的状态所做的所有更改，并向调用者返回错误</li> <li>函数 assert 和 require 可用于判断条件，并在不满足条件时抛出异常</li> <li>assert() 一般只应用于测试内部错误，并检查常量</li> <li>require() 应用于确保满足条件（如收入或合约状态变量），或验证调用外部合约的返回值</li> <li>revert 用于标记错误并回滚当前的调用</li> <li>throw 关键字也可以用作 <code>revert()</code> 的替代方法</li></ul> <h2 id="solidity-中的单位"><a href="#solidity-中的单位" class="header-anchor">#</a> Solidity 中的单位</h2> <h3 id="以太币-ether"><a href="#以太币-ether" class="header-anchor">#</a> 以太币（ether）</h3> <ul><li>以太币 Ether 单位之间的换算就是在数字后加 wei， finny, szabo 或 ether 来实现，如果后面没有单位，默认为 wei，例如 <code>2 ether == 2000 finney</code>的逻辑判定值为<code>true</code></li></ul> <table><thead><tr><th>Unit</th> <th>Wei Value</th> <th>Wei</th></tr></thead> <tbody><tr><td>wei</td> <td>1</td> <td>1 wei</td></tr> <tr><td>Kwei(babbage)</td> <td>1e3 wei</td> <td>1,000</td></tr> <tr><td>Mwei(lovelace)</td> <td>1e6 wei</td> <td>1,000,000</td></tr> <tr><td>Gwei(shannon)</td> <td>1e9 wei</td> <td>1,000,000,000</td></tr> <tr><td>microether(szabo)</td> <td>1e12 wei</td> <td>1,000,000,000,000</td></tr> <tr><td>milliether(finney)</td> <td>1e15 wei</td> <td>1,000,000,000,000,000</td></tr> <tr><td>ether</td> <td>1e18 wei</td> <td>1,000,000,000,000,000,000</td></tr></tbody></table> <h3 id="时间"><a href="#时间" class="header-anchor">#</a> 时间</h3> <ul><li>秒为缺省时间单位，在时间单位之间，数字后面带有<code>seconds</code>,<code>minutes</code>,<code>hours</code>,<code>day</code>,<code>weeks</code>和<code>years</code>的可以进行换算，基本换算关系如下</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">==</span> <span class="token number">1</span> seconds
<span class="token number">1</span> minutes <span class="token operator">==</span> <span class="token number">60</span> seconds
<span class="token number">1</span> hours <span class="token operator">==</span> <span class="token number">60</span> minutes
<span class="token number">1</span> days <span class="token operator">==</span> <span class="token number">24</span> hours
<span class="token number">1</span> weeks <span class="token operator">==</span>  <span class="token number">7</span> days
<span class="token number">1</span> years <span class="token operator">==</span> <span class="token number">365</span> days
</code></pre></div><ul><li>这些后缀不能直接用在变量后面，如果想用时间单位（如 days）来将输入变量换算为时间，我们可以用如下方式来完成</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">uint start<span class="token punctuation">,</span>uint daysAfter</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>now<span class="token operator">&gt;=</span> start  <span class="token operator">+</span> daysAfter<span class="token operator">*</span> <span class="token number">1</span> days<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="使用汇编-assembly-代码"><a href="#使用汇编-assembly-代码" class="header-anchor">#</a> 使用汇编 Assembly 代码</h2> <p>与 c/c++类似，solability 程序中，可以使用 EVM 汇编语言</p> <h3 id="内联汇编"><a href="#内联汇编" class="header-anchor">#</a> 内联汇编</h3> <p>使用内联汇编，可以在 Solidity 源程序中嵌入汇编代码，对 EVM 要更细粒度的控制，在编写库函数时很有用</p> <div class="language-js extra-class"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.8</span><span class="token number">.0</span><span class="token punctuation">;</span>
library Sum <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">sumUsingInlineAssembly</span><span class="token punctuation">(</span><span class="token parameter">uint<span class="token punctuation">[</span><span class="token punctuation">]</span> memory _data</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint o_sum</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>_data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>
      assembly <span class="token punctuation">{</span>
        o_sum <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>o_sum<span class="token punctuation">,</span> <span class="token function">mload</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span>_data<span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mul</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
contract Test <span class="token punctuation">{</span>
  uint<span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external view <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> Sum<span class="token punctuation">.</span><span class="token function">sumUsingInlineAssembly</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog_dev/区块链/Substrate入门.html" class="prev">
        Substrate 入门
      </a></span> <span class="next"><a href="/blog_dev/区块链/web3js简介.html">
        web3js
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog_dev/assets/js/app.709da227.js" defer></script><script src="/blog_dev/assets/js/2.556b46b5.js" defer></script><script src="/blog_dev/assets/js/230.74de1167.js" defer></script>
  </body>
</html>
