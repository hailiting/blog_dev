# 公钥加密与数字签名

## 群

### 素数群

群定义：一个集合 G，满足以下 6 个条件，则称为群，即**具有封闭运算的集合称为群**

- 1. 非空集：集合中至少有一个元素
- 2. 二元运算：集合中的元素能够进行一种运算，例如加法运算，或乘法运算
- 3. 封闭性：集合中的元素进行运算后，得到的结果仍然是集合中的元素
- 4. 结合律：任意 a,b,c 属于 G，这`(a+b)+c=a+(b+c)`
- 5. 单位元 e：加法情况下`a+e=e+a=a`，乘法情况下：`a*e=e*a=a`
- 6. 每个元素 a 都有逆元，记为$a^{-1}$:

  - (1)加法情况下：$a+a^{-1}=a^{-1}+a=e$
  - (2)乘法情况下：$a*a^{-1}=a^{-1}*a=e$

- 如果一个群元素 g 能够通过有限次本身运算，表达群内其他所有元素，则称为群的生成元
- 群内元素个数称为群的阶

例子 1：
集合 `{0,1,2,3,4,5,6}`模系数为 7，就是一个加法素数群 $Z_7$，任何一个非 0 元素都是生成元

1. 非空集：有 7 个元素
2. 二元运算：加法
3. 封闭性：群内任意两个元素相加后模 7 后仍然是群中的元素, `(5+6)mod7=4`
4. 结合律：`((3+4)+5)mod7=(3+(4+5))mod7=5`
5. 单位元 e=0: `3+0=0+3=3`
6. 每个元素都有逆元

- `0+0=e=0`
- `(1+6)mod7=e=0` 1 的逆元是 6
- `(2+5)mod7=e=0` 2 的逆元是 5
  ...

已知 `sk=5` 和生成元`g=3`，则能快速计算$PK=3^5$，计算方法：$PK=g^{sk}$

- 离散对数困难问题 DL
  - 已知生产元 g 和公钥 PK，不能在多项式时间内求私钥 sk
- 计算性`Diffle-Hallman`困难问题 CDH: 离散对数困难问题的变形
  - 已知$g,g^a,g^b\inG$，求$g^{ab}$
- 判决性 Diffie-Hallman 困难问题 DDH

  - 已知$g,g^a,g^b,Z\inG$，判断$Z^?=g^{ab}$是困难的

- DL CDH DDH 是标准困难问题，是最安全的困难问题
- 其他困难问题是非标准困难问题，是相对安全的困难问题

### 椭圆曲线群

椭圆曲线群与素数群，几乎相同，仅仅是底层表达细节不一样，导致计算速度不一样，在相同的安全性等级，需要的私钥长度更小

## 公钥加密

数字信封：公钥加密一个对称密钥 x， 使用对称密钥 x 进行 AES 对称加密

### ElGamal 加密系列

#### 基于素数群的 ElGamal 加密

#### 基于素数群的 Hashed ElGamal 加密

#### 基于椭圆曲线群的 ElGamal 加密

#### 基于椭圆曲线群的 Hashed ElGamal 加密

#### 基于素数群的 Twin Hashed ElGamal 加密

### ElGamal 加密安全升级 Gramer-Shoup

#### 基于素数群 Gramer-Shoup 加密

#### 基于椭圆曲线群 Cramer-Shoup 加密

## 数字签名

### 双线性映射

### BLS 签名

### BLS 聚合签名

### BLS 批量签名

### BBRO 签名

### ZSS 签名

### BB 短签名

### Schnorr 签名

### EdDSA 签名算法

### ECDSA

#### 素数群上的 ECDSA

#### 椭圆曲线群上的 ECDSA

### 门逻币环
