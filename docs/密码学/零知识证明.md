# 零知识证明

- 给定$g^w$，证明知道$w$
  - 选取随机数 r, 选取随机数 e
  - $g^w·a^e=g^w·(g^r)^e=g^{w+re}=g^z$
- `根节点r=Hash(Hash(cm1, cm2), h2)`

## 交易包含信息

- 1. 销毁号 sn
- 2. 根节点 hash
- 3. 零知识证明
- 4. 明文收币地址

## Rollup 交易

- 执行前根 hash
- 执行后根 hash
- 零知识证明

## Rollup 合约

- 检查执行前根哈希一致
- 验证证明
- 更新根 hash

## Zkrollup 的几个问题

- 只有获取全部账本状态的人才能提交证明
  - 方案：将每笔交易细节记录到链上，并用零知识证明其正确性
- 账本状态只能同步更新
  - 方案：中心化/半中心化更新
- Rollup 交易频率的 Tradeoff
  - 频率太高，摊薄交易费效果有限
  - 频率太低，获得 Layer1 的安全性有限
  - 以路印为例，过去 10 笔 Rollup 交易平均用时 40 分钟
  - 由于路印是中心化更新，所以有一个类似于快速赎回的功能

## 零知识证明的性能指标

- 证明时间
- 验证时间：决定链上执行的 gas 消耗
- 证明大小：决定交易大小和链上消耗
- 安全假设

### Zk-Snark:

开发工具相对成熟，核心算法代码相对成熟，以太坊/Conflux 主网有内置合约支持，证明长度小。

需要 trusted setup, 非量子安全

### Zk-Stark:

开发工具相对原始，核心算法代码质量有待提高，证明长度长。
不需要 trusted setup，量子安全

### 通用电路与专用电路

- 专用电路(ASIC 思路)
- 通用电路(CPU 思路)

## 开发者需要做什么

- 初始化算法: 证明公钥+验证公钥<-要证明的问题
- 证明算法
- 验证算法

- 要证明的问题
- 证明公开数据
- 证明私有数据

- 其他
