# 雅虎军规 35 条

- 来自 Google 数据表明，一个 10 条数据 0.4s 加载完页面，变为 30 条数据 0.9s 加载完，用户的流量会下降 90%
- GoogleMap 首页文件大小从 100kb 减小到 70-80kb 后，流量在第一周涨了 10%，接下来的三周涨了 25%
- 亚马逊的数据表明：加载时间增加 100 毫秒，销量就下降 1%

## 前端性能优化

### 页面内容

- 减少 HTTP 请求数
- 减少 DNS 查询
- 避免重定向
- 缓存 Ajax 请求
- 延迟加载
- 预加载
- 减少 DOM 元素数量
- 划分内容到不同域名
- 尽量减少 iframe 使用
- 避免 404 错误

#### 减少 HTTP 请求数

80%的终端用户响应时间都花在了前端上，其中大部分时间都在下载页面上的各种组件：图片，样式表，脚本....所以减少 http 请求是让页面变快的关键

- 合并 js/css 文件。服务器端（CDN）自动合并，基于 Node.js 的文件合并工具，通过把所有脚本放在一个文件中的方式来减少请求数。
- 使用 css sprite 将背景图合并为一个文件，通过`background-image`和`background-position`控制显示
- 图片映射，把多张图片合并为一张【image map 不容易，所以不推荐】
- 行内图片（base64 编码）:使用`data:url`将图片嵌入到 HTML 或 css 中。【会有兼容问题】

### 服务器

- 使用 CDN
- 添加 Expires 或 Cache-Control 响应头
- 启用 Gzip
- 配置 Etag
- 尽早输出缓冲
- Ajax 请求使用 Get 方法
- 避免图片 src 为空

### Cookie

- 减少 Cookie 大小
- 静态资源使用无 cookie 域名

### 移动端

- 保持单个文件小于 25kb
- 打包内容为分段 multipart 文档

### 图片

- 优化图片
- 优化 css Sprite
- 不要在 HTML 中缩放图片
- 使用体积小、可缓存的 favicon.ico

### JavaScript

- 把脚本放到页面底部
- 使用外部 JavaScript 和 css
- 压缩 JavaScript 和 css
- 移除重复脚本
- 减少 DOM 操作
- 使用高效的事件处理

### CSS

- 把样式表在<head>中
- 不要使用 css 表达式
- 使用<link>代替 @import
- 不要使用 filter
