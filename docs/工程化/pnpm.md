# pnpm

pnpm 是 Node.js 的替代包管理器。是 npm 的直接替代品，速度更快，效率更高。
**为什么效率高**
当安装一个包时，pnpm 将它保存在机器上的一个全局存储中，然后从它创建一个硬链接而不是复制。对于模块的每个版本，磁盘上只保存一个副本。

- 节约磁盘空间，缓存技术加持
- 速度快
- 支持 monorepo
- 安全性高

## pnpm 与 Yarn 相对于 npm 的所有附加功能

- 安全
  - 与 Yarn 一样，pnpm 有一个特殊文件，其中包含所有已安装包的校验和，以在执行每个已安装包的代码之前校验其完整性
- 离线模式
  - pnpm 将所有下载的包 tarball 保存在本地注册表镜像中。当包在本地可用时，它从不发出请求。使用该`--offline`参数，可以完全禁止 http 请求
- 速度
  - pnpm 不仅比 npm 快，也比 yarn 快。无论冷缓存还是热缓存，它都比 yarn 快。yarn 从缓存中复制文件，而 pnpm 只是从全局存储中链接他们

## 虚拟目录 + 平铺结构 + 包隔离 + 软链接

- 三方包的依赖在`.pnpm`里
- `.pnpm/` 以平铺的形式存储着所有的包
- 这个平铺结构避免了 npm v2 创建的嵌套`node_modules`引起的长路径问题，与 yarn v1 不同的是，它保留了包之间的相互隔离。
- 例如 express，所有的依赖都软连接到`node_modules/.pnpm/`中的对应目录。把 express 的依赖放置在同一级别避免了循环的软链
