# 区块链理论基础

- 货币及货币发展
- 分布式账本
- 中心化和去中心化
- hash 函数解决问题
- 通货膨胀和比特币
- 区块链的数据结构与安全性
- 共识机制与激励机制
- 交易流程与经济模型

> 比特币不是一种货币，他是一个分布式的总账系统，电子总账在每个参与者电脑上备份，实时的同步和对账
> 总账记录这一定数量的比特币从一个参与者到另一个参与者的过程，每次记录都会广播到网络
> 比特币本身没有价值，比特币的价值在于，第一个通过去中心化的分布式信任系统实现了价值转移

## 货币与价值交换

- 物物交换：效率低，缺少统一计价单位
- 记账货币：以账本与信用体系驱动流通
- 法币：国家信用背书，货币供给可调节
- 加密资产：以算法与共识作为信任基础

## 分布式账本

- 多方共同维护同一本账
- 任何人可验证账本历史
- 通过共识协议决定“哪个版本的账是正确的”

## 中心化和去中心化

- 中心化：高效率，单点风险
- 去中心化：抗审查、抗单点故障，但效率较低
- 区块链：在效率与安全之间做权衡
- 去中心化是一种系统架构特征，区块链是实现去中心化信任的一类技术，不是同一概念

## hash 函数

Hash 函数可以提取数据的特征
Hash 函数可以正向操作，不能逆向
Hash 函数具有确定性、抗碰撞性、雪崩效应

- SHA1 => 生成长度 40
- SHA224 => 生成长度 56
- SHA256 => 生成长度 64 16 进制 0011 Math.pow(2,4)
- SHA384 => 生成长度 96
- SHA512 => 生成长度 128 2^512 可能
- MD5 => 生成长度 32 【安全性低】

**[线上 Hash 加密地址](https://tool.oschina.net/encrypt?type=2)**
**[线上 md5 解密地址](https://www.cmd5.com/)**

- 枚举 尝试某一个可能的哈希（暴力破解）
- 彩虹表：用空间换时间的预计算

## 区块链的数据结构

### 区块结构

- 区块头：前一区块哈希、时间戳、难度、Nonce、Merkle Root
- 区块体：交易列表
- 区块链：通过前一区块哈希把区块串联成链

### Merkle Tree

- 用哈希树汇总大量交易
- 轻节点可以只验证交易是否包含（SPV）
- Merkle Root 写入区块头，保障交易不可篡改

## 非对称加密与数字签名

- 私钥：控制资金的根凭证，必须离线保存
- 公钥：由私钥推导
- 地址：公钥经过哈希与编码后的短标识
- 签名：证明“我拥有私钥”，并防止交易被篡改

## 钱包创建

- 无需网络
- 无需服务商
- 无需电脑（算盘）
- 钱包不等于账户，钱包只

## 分布式系统和一致性

### 拜占庭

拜占庭将军问题：如何保持数据的一致性
工作量证明：通过计算成本约束作恶
一个链表（最长链规则）

- 信息篡改
- 比特币通过 PoW 与最长链规则实现弱一致性，允许短暂分叉

- 比特币通过 p2p 技术实现账本的同步拷贝
- 比特币通过增加发送信息的成本（PoW）降低恶意传播
- 比特币通过最长链规则来判断数据的可信度
- 交易通常等 6 个确认认为较安全（约 1 小时）
- PoW 通过 SHA256 哈希来完成
- 工作证明获取需要很长时间，但验证只需要很短时间
- 矿池算力集中会带来潜在中心化风险
- 记账权竞争消耗能源，这是安全性成本

### 比特币的价值

- 价值转移：无需可信中介的跨地域转账
- 稀缺性：总量上限 2100 万
- 抗审查与不可篡改：交易一旦确认难以回滚
- 可编程性：脚本支持简单逻辑

## IPO 和 ICO 和 DAICO

### IPO 和 ICO

#### IPO(Initial Public Offerings)英文翻译是首次公开发行

- 什么叫发行：增发股票就是发行
- 换句话说就是让新的，更多的投资者把钱投资到公司里来
- 同时给这些投资者一些公司股份
- 允许他们以后参加企业的分红

#### ICO(Initial Coin Offerings)英文翻译就是首次货币发行

- ICO-> 企业先发布一个白皮书，白皮书就是说明：我们打算干一件什么事，现在没钱，大家来买代金券

##### ethereum 就是 ICO 成功的例子

## EIP 协议

- EIP（Ethereum Improvement Proposal）：以太坊改进提案，是以太坊社区的标准化升级流程
- 目的：描述新特性、协议变更、标准接口、生态规范等，并进行讨论与达成共识
- 流程：提出草案 -> 社区讨论 -> 评审 -> 接受/拒绝/延后（最终进入主网升级或成为标准）
- 常见类型：Core（协议层）、Networking、Interface、ERC（应用层标准）
- 常见提案/标准：
  - EIP-1559：基础费 + 小费机制，改善手续费市场
  - EIP-155：链 ID 防重放
  - EIP-712：结构化数据签名
  - EIP-2612：ERC-20 免授权转账（permit）
  - ERC-20：同质化代币标准
  - ERC-721：NFT 标准
  - ERC-1155：多代币标准（批量、半同质化）
  - ERC-4626：收益型代币金库标准
  - ERC-777：改进版代币接口（可钩子）
- 钱包/助记词相关（非 EIP）：
  - BIP-39：助记词 + seed 生成规则（常见 12/24 个单词）
  - BIP-32：HD 钱包分层派生（主密钥 -> 子密钥）
  - BIP-44：多币种路径规范（m / purpose' / coin_type' / account' / change / address_index）
  - SLIP-10：跨曲线的 HD 派生规范（常见于多链钱包）
  - BIP-38：私钥加密与口令保护
  - secp256k1：比特币/以太坊常用椭圆曲线（私钥/公钥与签名）

## 分布式系统核心问题

区块链就是一个大的分布式系统
BTC 侧链 散变网络

- 一致性问题
  - 人民代表大会制度
  - 提案 proposal
- 共识协议
  - FLP 不可能原理：在异步通信场景中，没有任何算法能保证到达一致性
  - 科学上不可能的事 在工程学可以变成现实
  - 所有的优化，不就是在优化时间，就是在优化空间
- 常见共识协议原理
  - CAP 原理
    - 一致性 Consistency
    - 可用性 availability
    - 分区容忍性 partition
  - ACID 原则
    - 原子性 Atomicity
    - 一致性 Consistency
    - 独立性 Isolation
    - 持久性 Durability
- 分布式系统的可靠性
  - 常见的共识算法
    - Paxos
    - Raft 基于 Paxos 的简易实践
    - 阿里云承诺可以性 9 个 9

## 共识机制概览

- PoW：以算力换安全，能耗高
- PoS：以质押换安全，能耗低，需防止“富者恒富”
- DPoS：少数代表出块，吞吐高，去中心化程度较弱
- PBFT：适合联盟链，节点数受限
- PoA：权威节点出块，效率高但去中心化程度低
- PoH：引入可验证时间序列，提升排序与吞吐（常与 PoS 结合）
- 混合共识：PoW+PoS 等组合，用于平衡安全与效率

## 交易模型

- UTXO：交易输入输出组成可追溯链条（比特币）
- Account：账户余额变更模型（以太坊）
- 交易费：抑制垃圾交易并激励矿工/验证者

## 扩展与分层

- 链上扩容：增大区块、优化共识
- 链下扩容：闪电网络、状态通道
- L2：Rollup（Optimistic / ZK）降低主链负载

## 比特币硬分叉

- 硬分叉：协议规则不向后兼容，旧节点无法验证新规则区块
- 成因：扩容方案、治理分歧、路线选择等
- 结果：链分裂为两条，各自继续出块并形成独立资产
- 典型案例：Bitcoin Cash（2017，增大区块）、Bitcoin SV（2018，从 BCH 分叉）
- 是否还叫 BTC：只有获得主流共识与算力支持的主链继续使用 BTC 代码，分叉链一般使用新名称与新代码（如 BCH、BSV）
- 币价变化：分叉后成为独立资产，价格各自波动，通常由算力、生态与交易所支持决定
- 通常所说 BTC：指主流共识的比特币主链（也常被视为原始链的延续）
- 对比软分叉：规则向后兼容（如 SegWit）

## 风险与误区

- 私钥丢失=资产丢失
- 51% 攻击：算力/质押过于集中
- 智能合约漏洞：代码即法律也带来代码风险
- 价格波动：投机与市场周期影响

## 区块链学习技术栈和路线图

区块链技术是一种思想，用任何语言都可以实现
