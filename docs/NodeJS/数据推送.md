# 数据推送

## Comet

环境 xampp

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>datapush</title>
  </head>
  <body>
    <script
      type="text/javascript"
      src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"
    ></script>
    <script type="text/javascript">
      function conn() {
        $.ajax({
          url: "./data.php",
          dataType: "json",
          success: function(data) {
            console.log(data);
            conn();
          },
        });
      }
      conn();
    </script>
    <!-- <script type="text/javascript">
      var getXmlHttpRequest = function () {
        if (window.XMLHttpRequest) {
          return new XMLHttpRequest();
        } else if (window.ActiveXObject) {
          return new ActiveXObject("Microsoft.XMLHTTP");
        }
      };
      var xhr = getXmlHttpRequest();
      xhr.onreadystatechange = function () {
        console.log(xhr.readyState);
        // readState 3 正在结束数据
        if (xhr.readyState === 3 && xhr.status == 200) {
          console.log(xhr.responseText);
        }
      };
      xhr.open("get", "data.php", true);
      xhr.send("");
    </script> -->
  </body>
</html>
```

```php
<?php
  header("Content-type:  application/json;charset=utf-8");
  header("Cache-Control:max-age=0");
  $i=0;
  while(true){
    $res=array("success"=>"ok","text"=>$random);
    echo json_encode($res);
    exit();
  }
  // while($i<90000){
  //   sleep(2);
  //   $i++;
  //   $random = rand(1, 999);
  //   echo($random);
  //   echo("<br/>");
  //   // $res=array("success"=>"ok","text"=>$random);
  //   // echo json_encode($res);
  //   ob_flush();
  //   flush();
  // }
?>
```

## WebSocket

## SSE
