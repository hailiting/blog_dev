# 2020-100 é“é¢è¯•é¢˜

## 6: React é¡¹ç›®ä¸­æœ‰å“ªäº›ç»†èŠ‚å¯ä»¥ä¼˜åŒ–ï¼Œå®é™…å¼€å‘ä¸­éƒ½åšè¿‡å“ªäº›æ€§èƒ½ä¼˜åŒ–

å¯¹äºæ­£å¸¸çš„é¡¹ç›®ä¼˜åŒ–ï¼Œä¸€èˆ¬æ¶‰åŠåˆ°å‡ ä¸ªæ–¹é¢ï¼šå¼€å‘è¿‡ç¨‹ä¸­ã€ä¸Šçº¿ä¹‹åçš„é¦–å±ã€è¿è¡Œè¿‡ç¨‹çš„çŠ¶æ€

- ä¸Šçº¿åçš„é¦–å±åŠè¿è¡ŒçŠ¶æ€

  - é¦–å±çš„ä¼˜åŒ–æ¶‰åŠåˆ°å‡ ä¸ªæŒ‡æ ‡ï¼šFPã€FCPã€FMP;è¦æœ‰ä¸€ä¸ªè‰¯å¥½çš„ä½“éªŒæ˜¯å°½å¯èƒ½çš„æŠŠ FCP æå‰ï¼Œéœ€è¦åšä¸€äº›å·¥ç¨‹åŒ–çš„å¤„ç†ï¼Œå»ä¼˜åŒ–èµ„æºçš„åŠ è½½
  - æ–¹å¼åŠåˆ†åŒ…ç­–ç•¥ï¼Œèµ„æºçš„å‡å°‘æ˜¯æœ€æœ‰æ•ˆçš„åŠ å¿«é¦–å±æ‰“å¼€æ–¹å¼
  - å¯¹äº CSR åº”ç”¨ï¼ŒFCP çš„è¿‡ç¨‹ä¸€èˆ¬æ˜¯é¦–å…ˆåŠ è½½ js ä¸ css èµ„æºï¼Œjs åœ¨æœ¬åœ°æ‰§è¡Œå®Œæˆï¼Œç„¶ååŠ è½½æ•°æ®å›æ¥ï¼Œåšå†…å®¹åˆå§‹åŒ–æ¸²æŸ“ï¼Œè¿™ä¸­é—´å°±æœ‰å‡ æ¬¡ç½‘ç»œåå¤è¯·æ±‚çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ CSR å¯ä»¥è€ƒè™‘ä½¿ç”¨éª¨æ¶å±åŠé¢„æ¸²æŸ“ï¼ˆéƒ¨åˆ†ç»“æ„é¢„æ¸²æŸ“ï¼‰ï¼Œsuspence ä¸ lazy åšæ‡’åŠ è½½åŠ¨æ€ç»„ä»¶çš„æ–¹å¼
  - å½“ç„¶è¿˜æœ‰å¦ä¸€ç§æ–¹å¼å°±æ˜¯ SSR çš„æ–¹å¼ï¼ŒSSR å¯¹äºé¦–å±çš„ä¼˜åŒ–æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†è¿™ç§ç“¶é¢ˆä¸€èˆ¬åœ¨ Node æœåŠ¡ç«¯çš„å¤„ç†ï¼Œå»ºè®®ä½¿ç”¨ stream æµçš„æ–¹å¼æ¥å¤„ç†ï¼Œå¯¹äºä½“éªŒä¸ node ç«¯çš„å†…å­˜ç®¡ç†ç­‰ï¼Œéƒ½æœ‰ä¼˜åŠ¿ã€‚
  - ä¸ç®¡å¯¹äº CSR è¿˜æ˜¯ SSRï¼Œéƒ½å»ºè®®é…åˆä½¿ç”¨ ServiceWorkerï¼Œæ¥æ§åˆ¶èµ„æºçš„è°ƒé…åŠéª¨æ¶å±ç§’å¼€çš„ä½“éªŒ
  - react é¡¹ç›®ä¸Šçº¿åï¼Œé¦–å…ˆéœ€è¦ä¿éšœå¯ç”¨æ€§ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ React.Profiler åˆ†æç»„ä»¶æ¸²æŸ“æ¬¡æ•°åŠè€—æ—¶çš„ä¸€äº›ä»»åŠ¡ï¼Œä½† Profile è®°å½•çš„æ˜¯ commit é˜¶æ®µçš„æ•°æ®ï¼Œæ‰€ä»¥å¯¹äº react çš„è°ƒå’Œé˜¶æ®µéœ€è¦ç»“åˆ performance API ä¸€èµ·åˆ†æã€‚
  - ç”±äº React æ˜¯çˆ¶çº§ props æ”¹å˜ä¹‹åï¼Œæ‰€æœ‰ä¸ props ä¸ç›¸å…³çš„å­ç»„ä»¶åœ¨æ²¡æœ‰æ·»åŠ æ¡ä»¶æ§ä»¶çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šè§¦å‘ render çš„æ¸²æŸ“ï¼Œè¿™æ˜¯æ²¡å¿…è¦çš„ï¼Œå¯ä»¥ç»“åˆ React çš„ PureComponent ä»¥åŠ React.memo ç­‰åšæµ…å¤„ç†ï¼Œè¿™ä¸­é—´æœ‰æ¶‰åŠåˆ°ä¸å¯å˜æ•°æ®çš„å¤„ç†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç»“åˆä½¿ç”¨ ShouldComponentUpdate åšæ·±æ¯”è¾ƒå¤„ç†ã€‚
  - æ‰€æœ‰çš„è¿è¡ŒçŠ¶æ€ä¼˜åŒ–ï¼Œéƒ½æ˜¯å‡å°‘ä¸å¿…è¦çš„ renderï¼ŒReact.useMemo ä¸ React.useCallback ä¹Ÿæ˜¯å¯ä»¥åšå¾ˆå¤šä¼˜åŒ–åœ°æ–¹
  - åœ¨å¾ˆå¤šåº”ç”¨ä¸­ï¼Œéƒ½ä¼šæ¶‰åŠåˆ°ä½¿ç”¨ redux ä»¥åŠä½¿ç”¨ contextï¼Œè¿™ä¸¤ä¸ªéƒ½å¯èƒ½é€ æˆè®¸å¤šä¸å¿…è¦çš„ renderï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦è°¨æ…å¤„ç†ä¸€äº›æ•°æ®
  - æœ€åå°±æ˜¯ä¿è¯æ•´ä¸ªåº”ç”¨çš„å¯ç”¨æ€§ï¼Œä¸ºç»„ä»¶åˆ›å»ºé”™è¯¯è¾¹ç•Œï¼Œå¯ä»¥ä½¿ç”¨ componentDidCatch æ¥å¤„ç†

- å®é™…é¡¹ç›®ä¸­å¼€å‘è¿‡ç¨‹ä¸­è¿˜æœ‰å¾ˆå¤šå…¶ä»–ä¼˜åŒ–ç‚¹ï¼š
  - 1. ä¿è¯æ•°æ®çš„ä¸å¯å˜æ€§
  - 2. ä½¿ç”¨å”¯ä¸€çš„é”®å€¼è¿­ä»£
  - 3. ä½¿ç”¨ web worker åšå¯†é›†å‹çš„ä»»åŠ¡å¤„ç†
  - 4. ä¸åœ¨ render ä¸­å¤„ç†æ•°æ®
  - 5. ä¸å¿…è¦çš„æ ‡ç­¾ï¼Œä½¿ç”¨ React.Fragments

```yaml
SSR:ã€æœåŠ¡ç«¯æ¸²æŸ“ã€‘ CSRã€å®¢æˆ·æ–¹æ¸²æŸ“ã€‘
FP(first paint): é¦–æ¬¡ç»˜åˆ¶
FCP(first contentful paint): é¦–æ¬¡å†…å®¹ç»˜åˆ¶
LCP(Largest contentful paint): æœ€å¤§å†…å®¹æ¸²æŸ“
DCL(DomContentloaded)
FMP(First Meaningful Paint): é¦–æ¬¡æœ‰æ•ˆç»˜åˆ¶
L(onload)
TTL(Time to Interactive): å¯äº¤äº’æ—¶é—´
TBT(Total Blocking Time): é¡µé¢é˜»å¡æ€»æ—¶é•¿
FID(First Input Delay): é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ
CLS(Cumulative Layout Shift): ç´¯ç§¯å¸ƒå±€åç§»
SI(Speed Index)
```

## 7. react æœ€æ–°ç‰ˆæœ¬è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼ŒåŠ äº†å“ªäº›ä¸œè¥¿ï¼Œå»äº†å“ªäº›ä¸œè¥¿

- 1. React 16.x å»æ‰äº†`componentWillMount`ã€`componentWillReceiveProps`ã€`componentsWillUpdata`ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œä¸ºå¼¥è¡¥å¤±å»ä¸Šé¢ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸçš„ä¸è¶³ï¼ŒåˆåŠ äº†ä¸¤ä¸ªï¼Œ`static getDerivedStateFromProps`ï¼Œ`getSnapshotBeforeUpdate`,ä¸ºå•¥è¦æ”¹ï¼Œå› ä¸ºæ–°çš„ React ç”¨ Fiber ä¼˜åŒ–äº†ç®—æ³•ï¼Œå½“æœ‰ç´§æ€¥çš„äº‹æƒ…æ—¶ï¼Œä¼šæ‰“æ–­æ¸²æŸ“ï¼Œå¤„ç†å®Œä¼šä»å¤´æ¸²æŸ“ç»„ä»¶ï¼Œä¸èƒ½ä¿è¯åªåœ¨æŒ‚è½½/æ‹¿åˆ° props/çŠ¶æ€å˜åŒ–çš„æ—¶å€™åˆ·æ–°ä¸€æ¬¡ï¼Œæ‰€ä»¥è¢«æ ‡è®°ä¸º Unsafeã€‚
- 2. React 16.x çš„ä¸‰å¤§æ–°ç‰¹æ€§ Time Slicing, Suspense, hooks
  - i. Time Slicing(è§£å†³ CPU é€Ÿåº¦é—®é¢˜)ï¼Œä½¿å¾—åœ¨æ‰§è¡Œä»»åŠ¡çš„æœŸé—´å¯ä»¥éšæ—¶æš‚åœï¼Œè·‘å»å¹²åˆ«çš„äº‹æƒ…ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿å¾— react èƒ½åœ¨æ€§èƒ½æå…¶å·®çš„æœºå™¨è·‘æ—¶ï¼Œä»ç„¶èƒ½ä¿æŒè‰¯å¥½çš„æ€§èƒ½
  - ii. Suspense(è§£å†³ç½‘ç»œ IO é—®é¢˜)å’Œ lazy é…åˆï¼Œå®ç°å¼‚æ­¥åŠ è½½ç»„ä»¶ã€‚èƒ½æš‚åœå½“å‰ç»„ä»¶çš„æ¸²æŸ“ï¼Œå½“å®ŒæˆæŸä»¶äº‹ä»¥ååœ¨ç»§ç»­æ¸²æŸ“ï¼Œè§£å†³ä» react å‡ºç”Ÿåˆ°ç°åœ¨éƒ½å­˜åœ¨çš„ã€å¼‚æ­¥å‰¯ä½œç”¨ã€‘çš„é—®é¢˜ï¼Œå¹¶ä¸”è§£å†³å¾—éå¸¸ä¼˜é›…ï¼Œä½¿ç”¨çš„æ˜¯ã€å¼‚æ­¥ä½†æ˜¯åŒæ­¥çš„å†™æ³•ã€‘ï¼Œä¸ªäººè®¤ä¸ºï¼Œè¿™æ˜¯æœ€å¥½çš„è§£å†³å¼‚æ­¥é—®é¢˜çš„æ–¹å¼
  - iii. æ­¤å¤–ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªå†…ç½®å‡½æ•° componentDidCatchï¼Œå½“æœ‰é”™è¯¯å‘ç”Ÿæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‹å¥½åœ°å±•ç¤º fallback ç»„ä»¶ï¼›å¯ä»¥æ•æ‰åˆ°å®ƒçš„å­å…ƒç´ ï¼ˆåŒ…æ‹¬åµŒå¥—å­å…ƒç´ ï¼‰æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯ä»¥å¤ç”¨é”™è¯¯ç»„ä»¶
- 3. React16.8
  - åŠ äº† hooksï¼Œè®© React å‡½æ•°å¼ç»„ä»¶æ›´åŠ çµæ´»
  - hooks ä¹‹å‰ï¼ŒReact å­˜åœ¨å¾ˆå¤šé—®é¢˜
    - a. åœ¨ç»„ä»¶é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾
    - b. å¤æ‚ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£ï¼Œé«˜é˜¶ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶åµŒå¥—è¿‡æ·±
    - c. class ç»„ä»¶çš„ this æŒ‡å‘é—®é¢˜
    - d. éš¾ä»¥è®°å¿†çš„ç”Ÿå‘½å‘¨æœŸ
  - hooks å¾ˆå¥½çš„è§£å†³äº†ä¸Šè¿°é—®é¢˜ï¼Œhooks æä¾›å¾ˆå¤šæ–¹æ³•
    - a. useState è¿”å›æœ‰çŠ¶æ€å€¼ï¼Œä»¥åŠæ›´æ–°è¿™ä¸ªçŠ¶æ€å€¼çš„å‡½æ•°
    - b. useEffect æ¥å—åŒ…å«å‘½ä»¤çš„æ–¹å¼ï¼Œå¯èƒ½æœ‰å‰¯ä½œç”¨ä»£ç çš„å‡½æ•°
    - c. useContext æ¥å—ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆä» React.createContext è¿”å›å€¼ï¼‰å¹¶è¿”å›å½“å‰ä¸Šä¸‹æ–‡å€¼
    - d. useReducer useState çš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ¥å—ç±»å‹ä¸º(state, action)=> newState çš„ reducerï¼Œå¹¶è¿”å›ä¸ dispatch æ–¹æ³•é…å¯¹çš„å½“å‰çŠ¶æ€ã€‚
    - e. useCallback è¿”å›ä¸€ä¸ªå›å¿†çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ä»…åœ¨å…¶ä¸­ä¸€ä¸ªè¾“å…¥å‘ç”Ÿæ›´æ”¹æ—¶æ‰ä¼šæ›´æ”¹ã€‚çº¯å‡½æ•°çš„è¾“å…¥è¾“å‡ºç¡®å®šæ€§ã€‚
    - f. useMemo çº¯çš„è®°å¿†å‡½æ•°
    - g. useRef è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶.current å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ é€’çš„å‚æ•°ï¼Œè¿”å› ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜
    - h. useImperativeMethods è‡ªå®šä¹‰ä½¿ç”¨ ref æ—¶å…¬å¼€ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼
    - i. useMutationEffect æ›´æ–°å…„å¼Ÿç»„ä»¶ä¹‹å‰ï¼Œå®ƒåœ¨ react æ‰§è¡Œå…¶ DOM æ”¹å˜çš„åŒä¸€é˜¶æ®µåŒæ­¥è§¦å‘
    - j. useLayoutEffect DOM æ”¹å˜ååŒæ­¥è§¦å‘ã€‚ä½¿ç”¨å®ƒæ¥ä» DOM è¯»å–å¸ƒå±€å¹¶åŒæ­¥é‡æ–°æ¸²æŸ“
- 4. React16.9
  - i. é‡å‘½å Unsafe ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæ–°çš„ UNSAFE\_å‰ç¼€å°†æœ‰åŠ©äºåœ¨ä»£ç  review å’Œ debug æœŸé—´ï¼Œä½¿è¿™äº›æœ‰é—®é¢˜çš„å­—æ ·æ›´çªå‡º
  - ii. åºŸå¼ƒ javascript: å½¢å¼çš„ URL,ä»¥ javascript å¼€å¤´çš„ URL éå¸¸å®¹æ˜“é­å—æ”»å‡»ï¼Œé€ æˆå®‰å…¨æ¼æ´ã€‚
  - iii. åºŸå¼ƒ`Factory`ç»„ä»¶ï¼Œå·¥å‚ç»„ä»¶ä¼šå¯¼è‡´ React å˜å¤§ä¸”å˜æ…¢
  - iv. act()ä¹Ÿæ”¯æŒå¼‚æ­¥å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨è°ƒç”¨å®ƒæ—¶ä½¿ç”¨ await
  - v. ä½¿ç”¨`<React.Profiler>`è¿›è¡Œæ€§èƒ½è¯„ä¼°ï¼Œåœ¨è¾ƒå¤§çš„åº”ç”¨ä¸­è¿½è¸ªæ€§èƒ½å›å½’å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿
- 5. React16.13.0
  - i. æ”¯æŒåœ¨æ¸²æŸ“æœŸé—´è°ƒç”¨ setState,ä½†ä»…é€‚ç”¨äºåŒä¸€ç»„ä»¶
  - ii. å¯æ£€æµ‹å†²çªæ ·å¼è§„åˆ™å¹¶è®°å½•è­¦å‘Š
  - iii. åºŸå¼ƒ unstatble_createPortalï¼Œä½¿ç”¨ createPortal
  - iv. å°†ç»„ä»¶å †æ ˆæ·»åŠ åˆ°å…¶å¼€å‘è­¦å‘Šä¸­ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿéš”ç¦» bug å¹¶è°ƒè¯•å…¶ç¨‹åºï¼Œè¿™å¯ä»¥æ¸…æ¥šåœ°è¯´æ˜é—®é¢˜æ‰€åœ¨ï¼Œæ›´å¿«çš„å®šä½å’Œä¿®å¤é”™è¯¯

## 17. React äº‹ä»¶ç»‘å®šåŸç†

React å¹¶ä¸æ˜¯å°† click äº‹ä»¶ç»‘å®šåœ¨è¯¥ div çš„çœŸå® DOM ä¸Šï¼Œè€Œæ˜¯åœ¨ document å¤„ç›‘å¬æ‰€æœ‰æ”¯æŒçš„äº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶å†’æ³¡è‡³ document å¤„æ—¶ï¼Œreact å°†äº‹ä»¶å†…å®¹å°è£…å¹¶äº¤ç”±çœŸæ­£çš„å¤„ç†å‡½æ•°è¿è¡Œã€‚è¿™æ ·çš„æ–¹å¼ä¸ä»…å‡å°‘å†…å­˜æ¶ˆè€—ï¼Œè¿˜èƒ½åœ¨ç»„ä»¶æŒ‚è½½é”€æ¯æ—¶ç»Ÿä¸€è®¢é˜…å’Œç§»é™¤äº‹ä»¶ã€‚
å¦å¤–å†’æ³¡åˆ° document ä¸Šçš„äº‹ä»¶ä¹Ÿä¸æ˜¯åŸç”Ÿæµè§ˆå™¨äº‹ä»¶ï¼Œè€Œæ˜¯ React è‡ªå·±å®ç°åˆæˆäº‹ä»¶(SyntheticEvent).
å› æ­¤æˆ‘ä»¬å¦‚æœä¸æƒ³è¦äº‹ä»¶å†’æ³¡çš„è¯ï¼Œè°ƒç”¨ event.stopPropagation æ˜¯æ— æ•ˆçš„ï¼Œè€Œåº”è¯¥è°ƒç”¨ event.preventDefaultã€‚

- 1. äº‹ä»¶æ³¨å†Œ
  - ç»„ä»¶è£…è½½/æ›´æ–°
  - é€šè¿‡ lastPropsã€nextProps åˆ¤æ–­æ˜¯å¦æ–°å¢ã€åˆ é™¤äº‹ä»¶åˆ†åˆ«è°ƒç”¨äº‹ä»¶æ³¨å†Œã€å¸è½½æ–¹æ³•
  - é€šè¿‡ EventPluginHub çš„ enqueuePutListener è¿›è¡Œäº‹ä»¶å­˜å‚¨
  - è·å– document å¯¹è±¡
  - æ ¹æ®äº‹ä»¶åç§°ï¼ˆå¦‚ onClickã€onCaptureClickï¼‰åˆ¤æ–­æ˜¯è¿›è¡Œå†’æ³¡è¿˜æ˜¯æ•è·
  - åˆ¤æ–­æ˜¯å¦å­˜åœ¨ addEventListener æ–¹æ³•ï¼Œå¦åˆ™ä½¿ç”¨ attachEvent(å…¼å®¹ IE)
  - ç»™ document æ³¨å†ŒåŸç”Ÿäº‹ä»¶å›è°ƒä¸º dispatchEventï¼ˆç»Ÿä¸€çš„äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼‰
- 2. äº‹ä»¶å­˜å‚¨
  - EventPluginHub è´Ÿè´£ç®¡ç† React åˆæˆäº‹ä»¶ callbackï¼Œå®ƒå°† callback å­˜å‚¨åœ¨ listenerBank ä¸­ï¼Œå¦å¤–è¿˜å­˜å‚¨äº†è´Ÿè´£åˆæˆäº‹ä»¶çš„ Plugin
  - EventPluginHub çš„ putListener æ–¹æ³•æ˜¯å‘å­˜å‚¨å®¹å™¨ä¸­å¢åŠ ä¸€ä¸ª listener
  - è·å–ç»‘å®šäº‹ä»¶çš„å…ƒç´ çš„å”¯ä¸€æ ‡è¯† key
  - å°† callback æ ¹æ®äº‹ä»¶ç±»å‹ï¼Œå…ƒç´ çš„å”¯ä¸€æ ‡è¯† key å­˜å‚¨åœ¨ listenerBank ä¸­
  - listenerBank çš„ç»“æ„æ˜¯ï¼š`listenerBank[registrationName][key]`
- 3. äº‹ä»¶è§¦å‘æ‰§è¡Œ
  - è§¦å‘ document æ³¨å†ŒåŸç”Ÿäº‹ä»¶çš„å›è°ƒ dispatchEvent
  - è·å–åˆ°è§¦å‘è¿™ä¸ªäº‹ä»¶æœ€æ·±ä¸€çº§çš„å…ƒç´ 
    - è¿™é‡Œçš„äº‹ä»¶æ‰§è¡Œåˆ©ç”¨äº† React çš„æ‰¹å¤„ç†æœºåˆ¶

```jsx
<div onClick={this.parentClick} ref={(ref) => (this.parent = ref)}>
  <div onClick={this.childClick} ref={(ref) => (this.child = ref)}>
    test
  </div>
</div>
/**
 * é¦–å…ˆä¼šè·å–åˆ°this.child
 * éå†è¿™ä¸ªå…ƒç´ çš„æ‰€æœ‰çˆ¶å…ƒç´ ï¼Œä¾æ¬¡å¯¹æ¯ä¸€çº§å…ƒç´ è¿›è¡Œå¤„ç†
 * æ„é€ åˆæˆäº‹ä»¶
 * å°†æ¯ä¸€çº§çš„åˆæˆäº‹ä»¶å­˜å‚¨åœ¨eventQueueäº‹ä»¶é˜Ÿåˆ—ä¸­
 * éå†eventQueue
 * é€šè¿‡isPropagationStoppedåˆ¤æ–­å½“å‰äº‹ä»¶æ˜¯å¦æ‰§è¡Œäº†é˜»æ­¢å†’æ³¡æ–¹æ³•
 * å¦‚æœé˜»æ­¢äº†å†’æ³¡ï¼Œåœæ­¢éå†ï¼Œå¦åˆ™é€šè¿‡executeDispatchæ‰§è¡Œåˆæˆäº‹ä»¶
 * é‡Šæ”¾å¤„ç†å®Œæˆçš„äº‹ä»¶
 */
```

- 4. åˆæˆäº‹ä»¶
  - è°ƒç”¨ EventPluginHub çš„ extractEvents æ–¹æ³•
  - å¾ªç¯æ‰€æœ‰ç±»å‹çš„ EventPlugin(ç”¨æ¥å¤„ç†ä¸åŒäº‹ä»¶çš„å·¥å…·æ–¹æ³•)
  - åœ¨æ¯ä¸ª EventPlugin ä¸­æ ¹æ®ä¸åŒçš„äº‹ä»¶ç±»å‹ï¼Œè¿”å›ä¸åŒçš„äº‹ä»¶æ± 
  - åœ¨äº‹ä»¶æ± ä¸­å–å‡ºåˆæˆäº‹ä»¶ï¼Œå¦‚æœäº‹ä»¶æ± ä¸ºç©ºï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„
  - æ ¹æ®å…ƒç´  nodeid(å”¯ä¸€æ ‡è¯† key)å’Œäº‹ä»¶ç±»å‹ä» listenerBink ä¸­å–å‡ºå›è°ƒå‡½æ•°
  - è¿”å›å¸¦æœ‰åˆæˆäº‹ä»¶å‚æ•°çš„å›è°ƒå‡½æ•°

## 25. React ç»„ä»¶é€šä¿¡æ–¹å¼

react ç»„ä»¶é—´é€šä¿¡é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µ

- i. çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡
- ii. å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡
- iii. è·¨çº§ç»„ä»¶é€šä¿¡
- iv. éåµŒå¥—å…³ç³»çš„ç»„ä»¶é€šä¿¡
  - a. å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶é€šä¿¡ï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼‰
  - b. å¯ä»¥é€šè¿‡ redux ç­‰è¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†
  - c. å¦‚æœæ˜¯å…„å¼Ÿç»„ä»¶é€šä¿¡ï¼Œå¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªå…„å¼Ÿçš„å…±åŒçˆ¶èŠ‚ç‚¹ï¼Œç»“åˆçˆ¶å­é—´é€šä¿¡æ–¹å¼è¿›è¡Œé€šä¿¡

```jsx
// i. çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡
const Child = (props) => {
  return <p>{props.name}</p>;
};
const Parent = () => {
  return <Child name="baba" />;
};
// ii. å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡: props+å›è°ƒæ–¹å¼
const Child = (props) => {
  const cb = (msg) => {
    return () => {
      props.callback(msg);
    };
  };
  return <button onClick={cb("baba")}>click me</button>;
};
const Paret = ()=>{
  callback(msg){
    console.log(msg);
  }
  render(){
    return <Child callback = {this.callback.bind(this)}/>
  }
}
// iii. è·¨çº§ç»„ä»¶é€šä¿¡ å³: çˆ¶ç»„ä»¶å‘ç»„ä»¶é€šä¿¡ï¼Œå‘æ›´æ·±å±‚å­ç»„ä»¶é€šä¿¡
// 3.1 ä½¿ç”¨propsåˆ©ç”¨ä¸­é—´ç»„ä»¶ä¼ é€’ï¼Œæœç„¶è¿‡æ·±ä¼šå¢åŠ å¤æ‚åº¦ï¼Œå¹¶ä¸”è¿™äº›propså¹¶ä¸æ˜¯ä¸­é—´ç»„ä»¶è‡ªå·±æƒ³è¦çš„
// 3.2 ä½¿ç”¨context,contextç›¸å½“äºä¸€ä¸ªå¤§å®¹å™¨ï¼Œå¯ä»¥æŠŠè¦é€šä¿¡çš„å†…å®¹æ”¾åˆ°å®¹å™¨é‡Œï¼ŒcontexğŸ“±ç›®çš„å°±æ˜¯ä¸ºäº†å…±äº«å¯¹äºä¸€ä¸ªç»„ä»¶æ ‘è€Œè¨€æ˜¯å…¨å±€çš„æ•°æ®
const BatteryContext = createConext();
// å­ç»„ä»¶çš„å­ç»„ä»¶
class GrandChild extends Component{
  render(){
    return (
      <BatteryContext.Consumer>
        {
          color=> <h1 style={{color: color}}>æˆ‘çš„é¢œè‰²ï¼š {color}</h1>
        }
      </BatterConntext.Consumer>
    )
  }
}
// å­ç»„ä»¶
class Child = ()=>{
  return (
    <GrandChild />
  )
}
// çˆ¶ç»„ä»¶
class Parant extends Component{
  state = {
    color: "red"
  }
  render(){
    const {color} = this.state;
    return (
      <ButteryContext.Provider value={color}>
        <Child />
      </ButteryContext.Provider>
    )
  }
}
```

## 26. `redux-saga`å’Œ`mobx`çš„æ¯”è¾ƒ

saga æ˜¯ redux å¤„ç†å¼‚æ­¥çš„ä¸€ç§æ–¹å¼ã€‚saga éœ€è¦ä¸€ä¸ªå…¨å±€ç›‘å¬å™¨ï¼ˆwatcher sagaï¼‰,ç”¨äºç›‘å¬ç»„ä»¶å‘å‡º actionï¼Œå°†ç›‘å¬çš„ action è½¬å‘ç»™å¯¹åº”çš„æ¥æ”¶å™¨ï¼ˆworkersagaï¼‰ï¼Œå†ç”±æ¥æ”¶å™¨æ‰§è¡Œå…·ä½“ä»»åŠ¡ï¼Œä»»åŠ¡å®Œäº†åœ¨å‘å‡ºå¦ä¸€ä¸ª action äº¤ç”± reducer ä¿®æ”¹ state.
mobx ä¸ redux çš„åŠŸèƒ½ç›¸ä¼¼ï¼Œmobx å®ç°æ€æƒ³å’Œ Vue å‡ ä¹ä¸€æ ·ï¼Œæ‰€ä»¥å…¶ä¼˜ç‚¹è·Ÿ Vue ä¹Ÿå·®ä¸å¤šï¼šé€šè¿‡ç›‘å¬æ•°æ®ï¼ˆå¯¹è±¡ï¼Œæ•°ç»„ï¼‰çš„å±æ€§å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡ç›´æ¥åœ¨æ•°æ®ä¸Šæ›´æ”¹å°±èƒ½è§¦å‘ UI æ¸²æŸ“ï¼Œä»è€Œåšåˆ°`MVVM`ã€å“åº”å¼ã€ä¸Šæ‰‹æˆæœ¬ä½ã€å¼€å‘æ•ˆç‡é«˜ã€‚

- redux å°†æ•°æ®ä¿å­˜åœ¨å•ä¸€çš„ store ä¸­ï¼Œmobx å°†æ•°æ®ä¿å­˜åœ¨åˆ†æ•£çš„å¤šä¸ª store ä¸­
- redux ä½¿ç”¨`plain object`ä¿å­˜æ•°æ®ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†å˜åŒ–åçš„æ“ä½œï¼Œmobx ä½¿ç”¨ observeble ä¿å­˜æ•°æ®ï¼Œæ•°æ®å˜åŒ–åè‡ªåŠ¨å¤„ç†å“åº”æ“ä½œã€‚
- redux ä½¿ç”¨ä¸å¯å˜çŠ¶æ€ï¼Œè¿™æ„å‘³ç€çŠ¶æ€æ˜¯åªè¯»çš„ï¼Œä¸èƒ½ç›´æ¥å»ä¿®æ”¹ä»–ï¼Œè€Œæ˜¯åº”è¯¥è¿”å›ä¸€ä¸ªæ–°çš„çŠ¶æ€ï¼ŒåŒæ—¶ä½¿ç”¨çº¯å‡½æ•°ï¼›mobx ä¸­çŠ¶æ€æ˜¯å¯å˜çš„ï¼Œå¯ç›´æ¥å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚
- mobx ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œåœ¨å…¶ä¸­æœ‰å¾ˆå¤šæŠ½è±¡ï¼Œmobx æ›´å¤šçš„ä½¿ç”¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€ç»´ï¼›redux ä¼šæ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºå…¶ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³æŒæ¡èµ·æ¥ä¸å¤ªå®¹æ˜“ï¼ŒåŒæ—¶éœ€è¦å€ŸåŠ©ä¸€ç³»åˆ—çš„ä¸­é—´ä»¶æ¥å¤„ç†å¼‚å¸¸å’Œå‰¯ä½œç”¨
- mobx ä¸­æœ‰æ›´å¤šçš„æŠ½è±¡å’Œå°è£…ï¼Œè°ƒè¯•ä¼šæ¯”è¾ƒå›°éš¾ï¼ŒåŒæ—¶ç»“æœéš¾ä»¥é¢„æµ‹ï¼Œè€Œ redux æä¾›èƒ½å¤Ÿè¿›è¡Œæ—¶é—´å›æº¯çš„å¼€å‘å·¥å…·ï¼ŒåŒæ—¶å…¶çº¯å‡½æ•°ä»¥åŠæ›´å°‘çš„æŠ½è±¡ï¼Œè®©è°ƒè¯•å˜çš„æ›´åŠ å®¹æ˜“ã€‚

* 1. çŠ¶æ€ç®¡ç†
  - `redux-sage`æ˜¯`redux`çš„ä¸€ä¸ªå¼‚æ­¥å¤„ç†ä¸­é—´ä»¶
  - `mobx`æ˜¯æ•°æ®ç®¡ç†åº“ï¼Œå’Œ redux ä¸€æ ·
* 2. è®¾è®¡æ€æƒ³
  - `redux-sage`å±äº flux ä½“ç³»ï¼Œå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³
  - `mobx`ä¸å±äº flux ä½“ç³»ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹
* 3. ä¸»è¦ç‰¹ç‚¹
  - `redux-sage`å› ä¸ºæ˜¯ä¸­é—´ä»¶ï¼Œæ›´å…³æ³¨å¼‚æ­¥å¤„ç†çš„ï¼Œé€šè¿‡ Genetator å‡½æ•°æ¥å°†å¼‚æ­¥å˜ä¸ºåŒæ­¥ï¼Œä½¿ä»£ç å¯è¯»æ€§é«˜ï¼Œç»“æ„æ¸…æ™°ã€‚action ä¹Ÿä¸æ˜¯`action creator`è€Œæ˜¯`pure action`
  - åœ¨`Generator`å‡½æ•°ä¸­é€šè¿‡`call`æˆ–`put`æ–¹æ³•ç›´æ¥å£°æ˜å¼è°ƒç”¨ï¼Œå¹¶è‡ªå¸¦ä¸€äº›æ–¹æ³•ï¼Œå¦‚`takeEvery`ã€`takeLast`ã€`race`ç­‰ï¼Œæ§åˆ¶å¤šå¼‚æ­¥æ“ä½œï¼Œè®©å¤šä¸ªå¼‚æ­¥æ›´ç®€å•
  - `mobx`æ˜¯æ›´ç®€å•æ–¹ä¾¿çµæ´»çš„å¤„ç†æ•°æ®ï¼Œstore æ˜¯åŒ…å«äº† state å’Œ actionã€‚state åŒ…è£…æˆä¸€ä¸ªå¯è¢«è§†å¯Ÿçš„å¯¹è±¡ï¼Œaction å¯ä»¥ç›´æ¥ä¿®æ”¹ stateï¼Œä¹‹åé€šè¿‡`Computed values`å°†ä¾èµ– state çš„è®¡ç®—å±æ€§æ›´æ–°ï¼Œä¹‹åè§¦å‘ Reactions å“åº”ä¾èµ– state çš„å˜æ›´ï¼Œè¾“å‡ºç›¸åº”çš„å‰¯ä½œç”¨ï¼Œä½†ä¸ç”Ÿæˆæ–°çš„ state.
* 4. æ•°æ®å¯å˜æ€§
  - `redux-sage`å¼ºè°ƒ state ä¸å¯å˜ï¼Œä¸èƒ½ç›´æ¥æ“ä½œ stateï¼Œé€šè¿‡ action å’Œ reducer åœ¨åŸæ¥çš„ state åŸºç¡€ä¸Šè¿”å›ä¸€ä¸ªæ–°çš„ state è¾¾åˆ°æ”¹å˜ state çš„ç›®çš„
  - `mobx`ç›´æ¥åœ¨æ–¹æ³•ä¸­æ›´æ”¹ state, åŒæ—¶æ‰€æœ‰ä½¿ç”¨ state éƒ½å‘ç”Ÿå˜åŒ–ï¼Œä¸ç”Ÿæˆæ–°çš„ state
* 5. å†™æ³•éš¾æ˜“åº¦
  - `redux-saga`æ¯”`redux`åœ¨`actionn`å’Œ`reducer`ä¸Šè¦ç®€å•ä¸€äº›ï¼Œéœ€è¦ç”¨ dispatch è§¦å‘ state çš„æ”¹å˜ï¼Œéœ€è¦ mapStateToProps è®¢é˜… state
  - mobx åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ä¸ç”¨ action å’Œ reducerï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹éœ€è¦ action ä¸­ä¿®æ”¹ state, å¹¶è‡ªåŠ¨è§¦å‘ç›¸å…³çš„ä¾èµ–æ›´æ–°
* 6. ä½¿ç”¨åœºæ™¯
  - `redux-sage`å¾ˆå¥½çš„è§£å†³äº† redux å…³äºå¼‚æ­¥å¤„ç†æ—¶çš„å¤æ‚åº¦å’Œä»£ç å†—ä½™çš„é—®é¢˜ï¼Œæ•°æ®æµå‘å¥½è¿½è¸ªã€‚ä½† redux çš„å­¦ä¹ æˆæœ¬æ¯”è¾ƒé«˜ï¼Œä»£ç æ¯”è¾ƒå†—ä½™ï¼Œä¸æ˜¯ç‰¹åˆ«éœ€è¦çŠ¶æ€ç®¡ç†ï¼Œå¯ä»¥ç”¨åˆ«çš„æ›¿æ¢
  - `mobx`å­¦ä¹ æˆæœ¬ä½ï¼Œèƒ½å¿«é€Ÿä¸Šæ‰‹ï¼Œä»£ç æ¯”è¾ƒç®€æ´ï¼Œä½†å¯èƒ½å› ä¸ºä»£ç ç¼–å†™çš„åŸå› å’Œæ•°æ®æ›´æ–°æ—¶ç›¸å¯¹é»‘ç›’ï¼Œå¯¼è‡´æ•°æ®æµå‘ä¸åˆ©äºè¿½è¸ªã€‚

## 27. è¯´ä¸€ä¸‹ react-fiber

- èƒŒæ™¯
  - react åœ¨è¿›è¡Œç»„ä»¶æ¸²æŸ“æ—¶ï¼Œä» setState å¼€å§‹åˆ°æ¸²æŸ“å®Œæˆæ•´ä¸ªè¿‡ç¨‹æ˜¯åŒæ­¥çš„ï¼ˆä¸€æ°”å‘µæˆï¼‰ã€‚å¦‚æœéœ€è¦æ¸²æŸ“çš„ç»„ä»¶æ¯”è¾ƒåºå¤§ï¼Œjs æ‰§è¡Œä¼šå æ®ä¸»çº¿ç¨‹äº‹ä»¶è¾ƒé•¿ï¼Œä¼šå¯¼è‡´é¡µé¢å“åº”åº¦å˜å·®ï¼Œä½¿å¾— react åœ¨åŠ¨ç”»ã€æ‰‹åŠ¿ç­‰åº”ç”¨ä¸­æ•ˆæœæ¯”è¾ƒå·®ã€‚
  - é¡µé¢å¡é¡¿ï¼šStackreconciler çš„å·¥ä½œæµç¨‹å¾ˆåƒå‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼Œçˆ¶ç»„ä»¶é‡Œè°ƒç”¨å­ç»„ä»¶ï¼Œå¯ä»¥ç±»æ¯”ä¸ºå‡½æ•°é€’å½’ï¼Œå¯¹äºç‰¹åˆ«åºå¤§çš„ vDOM æ ‘æ¥è¯´ï¼Œreconciliatio è¿‡ç¨‹ä¼šå¾ˆé•¿(x00ms)ï¼Œè¶…è¿‡ 16msï¼Œåœ¨è¿™æœŸé—´ï¼Œä¸»çº¿ç¨‹è¢« js å ç”¨ï¼Œå› æ­¤ä»»ä½•äº¤äº’ã€å¸ƒå±€ã€æ¸²æŸ“éƒ½ä¼šåœæ­¢ï¼Œç»™ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯é¡µé¢è¢«å¡ä½ã€‚
- å®ç°åŸç†
  - æ—§ç‰ˆ React é€šè¿‡é€’å½’çš„æ–¹å¼è¿›è¡Œæ¸²æŸ“ï¼Œä½¿ç”¨çš„æ˜¯ JS å¼•æ“è‡ªèº«çš„å‡½æ•°è°ƒç”¨æ ˆï¼Œå®ƒä¼šä¸€ç›´æ‰§è¡Œåˆ°æ ˆç©ºä¸ºæ­¢ã€‚è€Œ Fiber å®ç°äº†è‡ªå·±çš„ç»„ä»¶è°ƒç”¨æ ˆï¼Œå®ƒä»¥é“¾è¡¨çš„ä¿®é¥°éå†ç»„ä»¶æ ‘ï¼Œå¯ä»¥çµæ´»çš„æš‚åœã€ç»§ç»­å’Œä¸¢å¼ƒæ‰§è¡Œçš„ä»»åŠ¡ã€‚å®ç°æ–¹å¼æ˜¯ä½¿ç”¨äº†æµè§ˆå™¨çš„ requesIdleCallback è¿™ä¸ª api
  - Fiber å…¶å®æŒ‡çš„æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥ç”¨ä¸€ä¸ªçº¯çš„ js å¯¹è±¡æ¥è¡¨ç¤ºï¼š
  ```js
  const fiber = {
    stateNode, // èŠ‚ç‚¹å®ä¾‹
    child, // å­èŠ‚ç‚¹
    sibling, // å…„å¼ŸèŠ‚ç‚¹
    return, // çˆ¶èŠ‚ç‚¹
  };
  ```
- react å†…éƒ¨è¿è½¬åˆ†ä¸ºä¸‰å±‚ï¼š
  - Virtual DOM å±‚ï¼Œæè¿°é¡µé¢é•¿ä»€ä¹ˆæ ·å­
  - Reconciler å±‚ï¼Œè´Ÿè´£è°ƒç”¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè¿›è¡Œ Diff è¿ç®—ç­‰
  - Renderer å±‚ï¼Œæ ¹æ®ä¸åŒå¹³å°ï¼Œæ¸²æŸ“å‡ºç›¸åº”çš„é¡µé¢ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯ ReactDOM å’Œ ReactNative
- ä¸ºå®ç°ä¸å¡é¡¿ï¼Œå°±éœ€è¦æœ‰ä¸€ä¸ªè°ƒåº¦å™¨(Scheduler)æ¥è¿›è¡Œä»»åŠ¡åˆ†é…ã€‚ä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡ï¼ˆå¦‚ï¼šé”®ç›˜è¾“å…¥ï¼‰å¯ä»¥æ‰“æ–­ä¼˜å…ˆçº§ä½çš„ä»»åŠ¡ï¼ˆå¦‚ï¼šDiffï¼‰çš„æ‰§è¡Œï¼Œä»è€Œæ›´å¿«çš„ç”Ÿæ•ˆã€‚ä»»åŠ¡çš„ä¼˜å…ˆçº§æœ‰å…­ç§
  - synchronous ä¸ä¹‹å‰çš„ StackReconciler æ“ä½œä¸€æ ·ï¼ŒåŒæ­¥æ‰§è¡Œ
  - taskï¼šåœ¨ next tick ä¹‹å‰æ‰§è¡Œ
  - animationï¼šä¸‹ä¸€å¸§ä¹‹å‰æ‰§è¡Œ
  - highï¼šåœ¨ä¸ä¹…çš„å°†æ¥æ‰§è¡Œ
  - lowï¼šç¨å¾®å»¶è¿Ÿæ‰§è¡Œä¹Ÿæ²¡å…³ç³»
  - offscreen ä¸‹ä¸€æ¬¡ render æˆ– scroll æ—¶æ‰§è¡Œ
- Fiber Reconciler(react)æ‰§è¡Œé˜¶æ®µ
  - é˜¶æ®µä¸€ï¼šç”Ÿæˆ Fiber æ ‘ï¼Œå¾—å‡ºéœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œè¿™ä¸€æ­¥æ˜¯ä¸€ä¸ªæ¸è¿›çš„è¿‡ç¨‹ï¼Œå¯ä»¥è¢«æ‰“æ–­
  - é˜¶æ®µäºŒï¼šå°†éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ä¸€æ¬¡è¿‡æ‰¹é‡æ›´æ–°ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸èƒ½è¢«æ‰“æ–­
- Fiber æ ‘ï¼šFiber Reconciler åœ¨é˜¶æ®µä¸€è¿›è¡Œ Diff è®¡ç®—çš„æ—¶å€™ï¼Œä¼šåŸºäº VirtualDOM æ ‘ç”Ÿæˆä¸€è¯¾ Fiber æ ‘ï¼Œå®ƒçš„æœ¬è´¨æ˜¯é“¾è¡¨
- ä» Stack Reconciler åˆ° FiberReconcilerï¼Œæºç å±‚é¢å…¶å®å°±æ˜¯å¹²äº†ä¸€ä»¶é€’å½’æ”¹å¾ªç¯çš„äº‹æƒ…ã€‚

## 42. è¯´ä¸€ä¸‹ React Hooks åœ¨å¹³æ—¶å¼€å‘ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜åŠåŸå› 

- 1. ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookï¼Œå¿…é¡»å§‹ç»ˆåœ¨ React å‡½æ•°çš„é¡¶å±‚ä½¿ç”¨ hook
  - è¿™æ˜¯å› ä¸º React éœ€è¦åˆ©ç”¨è°ƒç”¨é¡ºåºæ¥æ­£ç¡®æ›´æ–°ç›¸åº”çš„çŠ¶æ€ï¼Œä»¥åŠè°ƒç”¨ç›¸åº”çš„é’©å­å‡½æ•°ï¼Œä¸€æ—¦åœ¨å¾ªç¯æˆ–æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨ Hook,å°±å®¹æ˜“å¯¼è‡´è°ƒç”¨é¡ºåºä¸ä¸€è‡´æ€§ï¼Œä»è€Œäº§ç”Ÿéš¾ä»¥é¢„æ–™çš„åæœã€‚
- 2. ä½¿ç”¨`useState`æ—¶å€™ï¼Œä½¿ç”¨ pushï¼Œpopï¼Œsplice ç­‰ç›´æ¥æ›´æ”¹æ•°ç»„å¯¹è±¡çš„å‘
  - ä½¿ç”¨ push ç›´æ¥æ›´æ”¹æ•°ç»„æ— æ³•è·å–åˆ°æœ€æ–°çš„å€¼ï¼Œåº”è¯¥é‡‡ç”¨ææ„æ–¹å¼ï¼Œä½†åœ¨ class é‡Œä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜
  ```jsx
  function Indicatorfilter() {
    let [num, setNums] = useState([0, 1, 2, 3]);
    const test = () => {
      // è¿™é‡Œçš„å‘æ˜¯ç›´æ¥é‡‡ç”¨pushå»æ›´æ–°numï¼ŒsetNums(num)æ˜¯æ— æ³•æ›´æ–°numçš„
      // å¿…é¡»ä½¿ç”¨ num = [...num, 1] setNums(num);
      num.push(1);
      setNums(num);
    };
    return (
      <div className="filter">
        <button onClick={test}>click test</button>
        <p>{num.join()}</p>
      </div>
    );
  }
  ```
- `useState`è®¾ç½®çŠ¶æ€çš„æ—¶å€™ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ç”Ÿæ•ˆï¼ŒåæœŸéœ€è¦æ›´æ–°çŠ¶æ€ï¼Œå¿…é¡»é€šè¿‡`useEffect`

```js
// error
const TableDetail = ({ columns }, TableData) => {
  const [tabColumn, setTabColumn] = useState(columns);
};

// success
const TableDetail = ({ columns }: TableData) => {
  const [tabColumn, setTabColumn] = useState(columns);
  useEffect(() => {
    setTabColumn(columns);
  }, [columns]);
};
```

- 4. å–„ç”¨`useCallback`
  - å½“`useCallback`çˆ¶ç»„ä»¶ä¼ é€’å­ç»„ä»¶äº‹ä»¶å¥æŸ„æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•å‚æ•°å˜åŠ¨çš„ç»„ä»¶å³ä½¿ç”¨ useMenoï¼Œä¹Ÿä¼šè·Ÿç€æ¸²æŸ“ä¸€æ¬¡
- 5. ä¸è¦æ»¥ç”¨`useContext`ï¼Œå¯ä»¥ä½¿ç”¨åŸºäº`useContext`å°è£…çš„çŠ¶æ€ç®¡ç†å·¥å…·
